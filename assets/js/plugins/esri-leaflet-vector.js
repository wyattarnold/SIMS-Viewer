/* esri-leaflet-vector - v1.0.7 - Wed Apr 19 2017 15:48:31 GMT-0700 (PDT)
 * Copyright (c) 2017 Environmental Systems Research Institute, Inc.
 * Apache-2.0 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leaflet"),require("esri-leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet","esri-leaflet"],e):e((t.L=t.L||{},t.L.esri=t.L.esri||{},t.L.esri.Vector=t.L.esri.Vector||{}),t.L,t.L.esri)}(this,function(t,e,i){"use strict";function n(t,n){i.request(t,{},function(o,a){if(o)throw new Error("Unable to fetch vector tile style metadata");i.request(a.sources.esri.url,{},function(i,o){i||(r(a,o,t),n._mapboxGL=e.mapboxGL({accessToken:"ezree",style:a}),n._ready=!0,n.fire("ready",{},!0))},n)},n)}function r(t,e,i){t.sources.esri.url&&-1===t.sources.esri.url.indexOf("http")&&(t.sources.esri.url=i.replace("/resources/styles/root.json","")),e.tiles&&"/"!==e.tiles[0].charAt(0)&&(e.tiles[0]="/"+e.tiles[0]),e.tileMap&&"/"!==e.tileMap.charAt(0)&&(e.tileMap="/"+e.tileMap),t.sources.esri={type:"vector",scheme:"xyz",tilejson:e.tilejson||"2.0.0",format:e.tileInfo&&e.tileInfo.format||"pbf",index:e.tileMap?t.sources.esri.url+e.tileMap:null,tiles:[t.sources.esri.url+e.tiles[0]],description:e.description,name:e.name},-1===t.glyphs.indexOf("http")&&(t.glyphs=i.replace("styles/root.json",t.glyphs.replace("../","")),t.sprite=i.replace("styles/root.json",t.sprite.replace("../","")))}function o(t){return new s(t)}function a(t){return new u(t)}e="default"in e?e.default:e;!function(e){if("object"==typeof t&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.mapboxgl=e()}}(function(){var t;return function t(e,i,n){function r(a,s){if(!i[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){var i=e[a][1][t];return r(i||t)},h,h.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e,i){function n(t){t?(this.array=t.array,this.pos=t.pos):(this.array=new ArrayBuffer(this.defaultLength),this.length=this.defaultLength,this.setupViews())}e.exports=n,n.prototype={pos:0,itemSize:4,defaultLength:8192,arrayType:"ARRAY_BUFFER",get index(){return this.pos/this.itemSize},setupViews:function(){this.ubytes=new Uint8Array(this.array),this.bytes=new Int8Array(this.array),this.ushorts=new Uint16Array(this.array),this.shorts=new Int16Array(this.array)},bind:function(t){var e=t[this.arrayType];this.buffer?t.bindBuffer(e,this.buffer):(this.buffer=t.createBuffer(),t.bindBuffer(e,this.buffer),t.bufferData(e,this.array.slice(0,this.pos),t.STATIC_DRAW),this.array=null)},destroy:function(t){this.buffer&&t.deleteBuffer(this.buffer)},resize:function(){if(this.length<this.pos+this.itemSize){for(;this.length<this.pos+this.itemSize;)this.length=2*Math.round(1.5*this.length/2);this.array=new ArrayBuffer(this.length);new Uint8Array(this.array).set(this.ubytes),this.setupViews()}}}},{}],2:[function(t,e,i){var n=t("./line_vertex_buffer"),r=t("./line_element_buffer"),o=t("./fill_vertex_buffer"),a=t("./triangle_element_buffer"),s=t("./outline_element_buffer"),u=t("./glyph_vertex_buffer"),l=t("./triangle_element_buffer"),h=t("./icon_vertex_buffer"),c=t("./triangle_element_buffer"),f=t("./collision_box_vertex_buffer"),d=t("./circle_vertex_buffer"),p=t("./triangle_element_buffer");e.exports=function(t){return t=t||{},{glyphVertex:new u(t.glyphVertex),glyphElement:new l(t.glyphElement),iconVertex:new h(t.iconVertex),iconElement:new c(t.iconElement),circleVertex:new d(t.circleVertex),circleElement:new p(t.circleElement),fillVertex:new o(t.fillVertex),fillElement:new a(t.fillElement),outlineElement:new s(t.outlineElement),lineVertex:new n(t.lineVertex),lineElement:new r(t.lineElement),collisionBoxVertex:new f(t.collisionBoxVertex)}}},{"./circle_vertex_buffer":3,"./collision_box_vertex_buffer":4,"./fill_vertex_buffer":5,"./glyph_vertex_buffer":6,"./icon_vertex_buffer":7,"./line_element_buffer":8,"./line_vertex_buffer":9,"./outline_element_buffer":10,"./triangle_element_buffer":11}],3:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{defaultLength:32768,itemSize:4,add:function(t,e,i,n){var r=this.pos,o=r/2;this.resize(),this.shorts[o+0]=2*t+(i+1)/2,this.shorts[o+1]=2*e+(n+1)/2,this.pos+=this.itemSize},bind:function(t,e,i){o.prototype.bind.call(this,t),t.vertexAttribPointer(e.a_pos,2,t.SHORT,!1,this.itemSize,i+0)}})},{"../../util/util":106,"./buffer":1}],4:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:12,defaultLength:32768,add:function(t,e,i,n){var r=this.pos,o=r/2,a=this.index;return this.resize(),this.shorts[o+0]=t.x,this.shorts[o+1]=t.y,this.shorts[o+2]=Math.round(e.x),this.shorts[o+3]=Math.round(e.y),this.ubytes[r+8]=Math.floor(10*i),this.ubytes[r+9]=Math.floor(10*n),this.pos+=this.itemSize,a}})},{"../../util/util":106,"./buffer":1}],5:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:4,add:function(t,e){var i=this.pos/2;this.resize(),this.shorts[i+0]=t,this.shorts[i+1]=e,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],6:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{defaultLength:32768,itemSize:16,add:function(t,e,i,n,r,o,a,s,u){var l=this.pos,h=l/2;this.resize(),this.shorts[h+0]=t,this.shorts[h+1]=e,this.shorts[h+2]=Math.round(64*i),this.shorts[h+3]=Math.round(64*n),this.ubytes[l+8]=Math.floor(r/4),this.ubytes[l+9]=Math.floor(o/4),this.ubytes[l+10]=Math.floor(10*u),this.ubytes[l+12]=Math.floor(10*a),this.ubytes[l+13]=Math.floor(10*Math.min(s,25)),this.pos+=this.itemSize},bind:function(t,e,i){o.prototype.bind.call(this,t);var n=this.itemSize;t.vertexAttribPointer(e.a_pos,2,t.SHORT,!1,n,i+0),t.vertexAttribPointer(e.a_offset,2,t.SHORT,!1,n,i+4),t.vertexAttribPointer(e.a_data1,4,t.UNSIGNED_BYTE,!1,n,i+8),t.vertexAttribPointer(e.a_data2,2,t.UNSIGNED_BYTE,!1,n,i+12)}})},{"../../util/util":106,"./buffer":1}],7:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{defaultLength:32768,itemSize:16,add:function(t,e,i,n,r,o,a,s,u){var l=this.pos,h=l/2;this.resize(),this.shorts[h+0]=t,this.shorts[h+1]=e,this.shorts[h+2]=Math.round(64*i),this.shorts[h+3]=Math.round(64*n),this.ubytes[l+8]=r/4,this.ubytes[l+9]=o/4,this.ubytes[l+10]=Math.floor(10*(u||0)),this.ubytes[l+12]=Math.floor(10*(a||0)),this.ubytes[l+13]=Math.floor(10*Math.min(s||25,25)),this.pos+=this.itemSize},bind:function(t,e,i){o.prototype.bind.call(this,t);var n=this.itemSize;t.vertexAttribPointer(e.a_pos,2,t.SHORT,!1,n,i+0),t.vertexAttribPointer(e.a_offset,2,t.SHORT,!1,n,i+4),t.vertexAttribPointer(e.a_data1,4,t.UNSIGNED_BYTE,!1,n,i+8),t.vertexAttribPointer(e.a_data2,2,t.UNSIGNED_BYTE,!1,n,i+12)}})},{"../../util/util":106,"./buffer":1}],8:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:6,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(t,e,i){var n=this.pos/2;this.resize(),this.ushorts[n+0]=t,this.ushorts[n+1]=e,this.ushorts[n+2]=i,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],9:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.extrudeScale=63,n.prototype=r.inherit(o,{itemSize:8,defaultLength:32768,add:function(t,e,i,r,o){var a=this.pos,s=a/2,u=this.index,l=n.extrudeScale;return this.resize(),this.shorts[s+0]=2*Math.floor(t.x)|i,this.shorts[s+1]=2*Math.floor(t.y)|r,this.bytes[a+4]=Math.round(l*e.x),this.bytes[a+5]=Math.round(l*e.y),this.bytes[a+6]=(o||0)/128,this.bytes[a+7]=(o||0)%128,this.pos+=this.itemSize,u}})},{"../../util/util":106,"./buffer":1}],10:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:4,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(t,e){var i=this.pos/2;this.resize(),this.ushorts[i+0]=t,this.ushorts[i+1]=e,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],11:[function(t,e,i){function n(t){o.call(this,t)}var r=t("../../util/util"),o=t("./buffer");e.exports=n,n.prototype=r.inherit(o,{itemSize:6,arrayType:"ELEMENT_ARRAY_BUFFER",add:function(t,e,i){var n=this.pos/2;this.resize(),this.ushorts[n+0]=t,this.ushorts[n+1]=e,this.ushorts[n+2]=i,this.pos+=this.itemSize}})},{"../../util/util":106,"./buffer":1}],12:[function(t,e,i){function n(t){this.buffers=t,this.elementGroups=new r(t.circleVertex,t.circleElement)}var r=t("./element_groups");e.exports=n,n.prototype.addFeatures=function(){for(var t=0;t<this.features.length;t++)for(var e=this.features[t].loadGeometry()[0],i=0;i<e.length;i++){this.elementGroups.makeRoomFor(6);var n=e[i].x,r=e[i].y;if(!(0>n||n>=4096||0>r||r>=4096)){var o=this.buffers.circleVertex.index-this.elementGroups.current.vertexStartIndex;this.buffers.circleVertex.add(n,r,-1,-1),this.buffers.circleVertex.add(n,r,1,-1),this.buffers.circleVertex.add(n,r,1,1),this.buffers.circleVertex.add(n,r,-1,1),this.elementGroups.elementBuffer.add(o,o+1,o+2),this.elementGroups.elementBuffer.add(o,o+3,o+2),this.elementGroups.current.vertexLength+=4,this.elementGroups.current.elementLength+=2}}}},{"./element_groups":14}],13:[function(t,e,i){function n(t,e,i,n,c){var f=new h("layout",t.type,t.layout,{}).values(),d={lastIntegerZoom:1/0,lastIntegerZoomTime:0,lastZoom:0},p={};for(var m in f)p[m]=f[m].calculate(i,d);"symbol"===t.type&&(f["text-size"]&&(p["text-max-size"]=f["text-size"].calculate(18,d),p["text-size"]=f["text-size"].calculate(i+1,d)),f["icon-size"]&&(p["icon-max-size"]=f["icon-size"].calculate(18,d),p["icon-size"]=f["icon-size"].calculate(i+1,d)));var y="line"===t.type?r:"fill"===t.type?o:"symbol"===t.type?a:"circle"===t.type?s:null,v=new y(e,new u[t.type](p),n,i,c);return v.id=t.id,v.type=t.type,v["source-layer"]=t["source-layer"],v.interactive=t.interactive,v.minZoom=t.minzoom,v.maxZoom=t.maxzoom,v.filter=l(t.filter),v.features=[],v}e.exports=n;var r=t("./line_bucket"),o=t("./fill_bucket"),a=t("./symbol_bucket"),s=t("./circle_bucket"),u=t("../style/layout_properties"),l=t("feature-filter"),h=t("../style/style_declaration_set")},{"../style/layout_properties":53,"../style/style_declaration_set":59,"./circle_bucket":12,"./fill_bucket":16,"./line_bucket":17,"./symbol_bucket":18,"feature-filter":108}],14:[function(t,e,i){function n(t,e,i){this.vertexBuffer=t,this.elementBuffer=e,this.secondElementBuffer=i,this.groups=[]}function r(t,e,i){this.vertexStartIndex=t,this.elementStartIndex=e,this.secondElementStartIndex=i,this.elementLength=0,this.vertexLength=0,this.secondElementLength=0}e.exports=n,n.prototype.makeRoomFor=function(t){(!this.current||this.current.vertexLength+t>65535)&&(this.current=new r(this.vertexBuffer.index,this.elementBuffer&&this.elementBuffer.index,this.secondElementBuffer&&this.secondElementBuffer.index),this.groups.push(this.current))}},{}],15:[function(t,e,i){function n(t,e){this.x=t.x,this.y=t.y,this.z=t.z-Math.log(e)/Math.LN2,this.rtree=p(9),this.toBeInserted=[]}function r(t,e,i){return"Point"===e?u(t,i):"LineString"===e?a(t,i):"Polygon"===e&&(o(t,i)||a(t,i))}function o(t,e){return!!(f(t,new m(e[0],e[1]))||f(t,new m(e[0],e[3]))||f(t,new m(e[2],e[1]))||f(t,new m(e[2],e[3])))||a(t,e)}function a(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],r=0,o=n.length-1;r<n.length;o=r++){var a=n[r],l=n[o],h=new m(a.y,a.x),c=new m(l.y,l.x);if(s(a,l,e[0],e[2],e[1])||s(a,l,e[0],e[2],e[3])||s(h,c,e[1],e[3],e[0])||s(h,c,e[1],e[3],e[2]))return!0}return u(t,e)}function s(t,e,i,n,r){if(e.y===t.y)return e.y===r&&Math.min(t.x,e.x)<=n&&Math.max(t.x,e.x)>=i;var o=(r-t.y)/(e.y-t.y),a=t.x+o*(e.x-t.x);return a>=i&&n>=a&&1>=o&&o>=0}function u(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],r=0;r<n.length;r++)if(n[r].x>=e[0]&&n[r].y>=e[1]&&n[r].x<=e[2]&&n[r].y<=e[3])return!0;return!1}function l(t,e,i,n){return"Point"===e?d(t,i,n):"LineString"===e?c(t,i,n):"Polygon"===e&&(f(t,i)||c(t,i,n))}function h(t,e,i){var n=e.distSqr(i);if(0===n)return t.distSqr(e);var r=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;return 0>r?t.distSqr(e):r>1?t.distSqr(i):t.distSqr(i.sub(e)._mult(r)._add(e))}function c(t,e,i){for(var n=i*i,r=0;r<t.length;r++)for(var o=t[r],a=1;a<o.length;a++){var s=o[a-1],u=o[a];if(h(e,s,u)<n)return!0}return!1}function f(t,e){for(var i,n,r,o=!1,a=0;a<t.length;a++){i=t[a];for(var s=0,u=i.length-1;s<i.length;u=s++)n=i[s],r=i[u],n.y>e.y!=r.y>e.y&&e.x<(r.x-n.x)*(e.y-n.y)/(r.y-n.y)+n.x&&(o=!o)}return o}function d(t,e,i){for(var n=i*i,r=0;r<t.length;r++)for(var o=t[r],a=0;a<o.length;a++)if(o[a].distSqr(e)<=n)return!0;return!1}var p=t("rbush"),m=t("point-geometry"),y=t("vector-tile"),v=t("../util/util");e.exports=n,n.prototype.insert=function(t,e,i){t.layers=e,t.feature=i,this.toBeInserted.push(t)},n.prototype._load=function(){this.rtree.load(this.toBeInserted),this.toBeInserted=[]},n.prototype.query=function(t,e){this.toBeInserted.length&&this._load();var i,n,o=t.params||{},a=t.x,s=t.y,u=[];void 0!==a&&void 0!==s?(i=(o.radius||0)*(t.tileExtent||4096)/t.scale,n=[a-i,s-i,a+i,s+i]):n=[t.minX,t.minY,t.maxX,t.maxY];for(var h=this.rtree.search(n),c=0;c<h.length;c++){var f=h[c].feature,d=h[c].layers,p=y.VectorTileFeature.types[f.type];if((!o.$type||p===o.$type)&&(!i||l(f.loadGeometry(),p,new m(a,s),i))&&r(f.loadGeometry(),p,n)){var _=f.toGeoJSON(this.x,this.y,this.z);o.includeGeometry||(_.geometry=null);for(var g=0;g<d.length;g++){var x=d[g];o.layerIds&&o.layerIds.indexOf(x)<0||u.push(v.extend({layer:x},_))}}}e(null,u)}},{"../util/util":106,"point-geometry":137,rbush:139,"vector-tile":144}],16:[function(t,e,i){function n(t){this.buffers=t,this.elementGroups=new r(t.fillVertex,t.fillElement,t.outlineElement)}var r=t("./element_groups");e.exports=n,n.prototype.addFeatures=function(){for(var t=this.features,e=0;e<t.length;e++){var i=t[e],n=i.loadGeometry();n&&this.addFeature(n)}},n.prototype.addFeature=function(t){for(var e=0;e<t.length;e++)this.addFill(t[e])},n.prototype.addFill=function(t){if(!(t.length<3)){var e=t.length;this.elementGroups.makeRoomFor(e+1);for(var i,n,r,o=this.elementGroups.current,a=this.buffers.fillVertex,s=this.buffers.fillElement,u=this.buffers.outlineElement,l=a.index-o.vertexStartIndex,h=0;h<t.length;h++)n=a.index-o.vertexStartIndex,r=t[h],a.add(r.x,r.y),o.vertexLength++,h>=2&&(r.x!==t[0].x||r.y!==t[0].y)&&(s.add(l,i,n),o.elementLength++),h>=1&&(u.add(i,n),o.secondElementLength++),i=n}}},{"./element_groups":14}],17:[function(t,e,i){function n(t,e){this.buffers=t,this.elementGroups=new r(t.lineVertex,t.lineElement),this.layoutProperties=e}var r=t("./element_groups");e.exports=n,n.prototype.addFeatures=function(){for(var t=this.features,e=0;e<t.length;e++){var i=t[e],n=i.loadGeometry();n&&this.addFeature(n)}},n.prototype.addFeature=function(t){for(var e=this.layoutProperties,i=0;i<t.length;i++)this.addLine(t[i],e["line-join"],e["line-cap"],e["line-miter-limit"],e["line-round-limit"])},n.prototype.addLine=function(t,e,i,n,r){for(var o=t.length;o>2&&t[o-1].equals(t[o-2]);)o--;if(!(t.length<2)){"bevel"===e&&(n=1.05);var a=t[0],s=t[o-1],u=a.equals(s);if(this.elementGroups.makeRoomFor(10*o),2!==o||!u){var l,h,c,f,d,p,m,y=i,v=u?"butt":i,_=1,g=0,x=!0;this.e1=this.e2=this.e3=-1,u&&(l=t[o-2],d=a.sub(l)._unit()._perp());for(var b=0;o>b;b++)if(!(c=u&&b===o-1?t[1]:t[b+1])||!t[b].equals(c)){d&&(f=d),l&&(h=l),l=t[b],h&&(g+=l.dist(h)),d=c?c.sub(l)._unit()._perp():f,f=f||d;var w=f.add(d)._unit(),M=w.x*d.x+w.y*d.y,E=1/M,S=h&&c,T=S?e:c?y:v;if(S&&"round"===T&&(r>E?T="miter":2>=E&&(T="fakeround")),"miter"===T&&E>n&&(T="bevel"),"bevel"===T&&(E>2&&(T="flipbevel"),n>E&&(T="miter")),"miter"===T)w._mult(E),this.addCurrentVertex(l,_,g,w,0,0,!1);else if("flipbevel"===T){if(E>100)w=d.clone();else{var z=f.x*d.y-f.y*d.x>0?-1:1,L=E*f.add(d).mag()/f.sub(d).mag();w._perp()._mult(L*z)}this.addCurrentVertex(l,_,g,w,0,0,!1),_=-_}else if("bevel"===T||"fakeround"===T){var P=_*(f.x*d.y-f.y*d.x)>0,R=-Math.sqrt(E*E-1);if(P?(m=0,p=R):(p=0,m=R),x||this.addCurrentVertex(l,_,g,f,p,m,!1),"fakeround"===T){for(var A,I=Math.floor(8*(.5-(M-.5))),D=0;I>D;D++)A=d.mult((D+1)/(I+1))._add(f)._unit(),this.addPieSliceVertex(l,_,g,A,P);this.addPieSliceVertex(l,_,g,w,P);for(var k=I-1;k>=0;k--)A=f.mult((k+1)/(I+1))._add(d)._unit(),this.addPieSliceVertex(l,_,g,A,P)}c&&this.addCurrentVertex(l,_,g,d,-p,-m,!1)}else"butt"===T?(x||this.addCurrentVertex(l,_,g,f,0,0,!1),c&&this.addCurrentVertex(l,_,g,d,0,0,!1)):"square"===T?(x||(this.addCurrentVertex(l,_,g,f,1,1,!1),this.e1=this.e2=-1,_=1),c&&this.addCurrentVertex(l,_,g,d,-1,-1,!1)):"round"===T&&(x||(this.addCurrentVertex(l,_,g,f,0,0,!1),this.addCurrentVertex(l,_,g,f,1,1,!0),this.e1=this.e2=-1,_=1),c&&(this.addCurrentVertex(l,_,g,d,-1,-1,!0),this.addCurrentVertex(l,_,g,d,0,0,!1)));x=!1}}}},n.prototype.addCurrentVertex=function(t,e,i,n,r,o,a){var s,u=a?1:0,l=this.buffers.lineVertex,h=this.buffers.lineElement,c=this.elementGroups.current,f=this.elementGroups.current.vertexStartIndex;s=n.mult(e),r&&s._sub(n.perp()._mult(r)),this.e3=l.add(t,s,u,0,i)-f,this.e1>=0&&this.e2>=0&&(h.add(this.e1,this.e2,this.e3),c.elementLength++),this.e1=this.e2,this.e2=this.e3,s=n.mult(-e),o&&s._sub(n.perp()._mult(o)),this.e3=l.add(t,s,u,1,i)-f,this.e1>=0&&this.e2>=0&&(h.add(this.e1,this.e2,this.e3),c.elementLength++),this.e1=this.e2,this.e2=this.e3,c.vertexLength+=2},n.prototype.addPieSliceVertex=function(t,e,i,n,r){var o=this.buffers.lineVertex,a=this.buffers.lineElement,s=this.elementGroups.current,u=this.elementGroups.current.vertexStartIndex,l=r;n=n.mult(e*(r?-1:1)),this.e3=o.add(t,n,0,l,i)-u,s.vertexLength+=1,this.e1>=0&&this.e2>=0&&(a.add(this.e1,this.e2,this.e3),s.elementLength++),r?this.e2=this.e3:this.e1=this.e3}},{"./element_groups":14}],18:[function(t,e,i){function n(t,e,i,n,r){this.buffers=t,this.layoutProperties=e,this.overscaling=i,this.zoom=n,this.collisionDebug=r;var o=512*i;this.tilePixelRatio=4096/o,this.compareText={},this.symbolInstances=[]}function r(t,e,i,n,r,o,a,s,u,l,h,c){this.x=t.x,this.y=t.y,this.hasText=!!i,this.hasIcon=!!n,this.hasText&&(this.glyphQuads=o?y(t,i,a,e,r,u):[],this.textCollisionFeature=new x(e,t,i,a,s,u)),this.hasIcon&&(this.iconQuads=o?v(t,n,l,e,r,c):[],this.iconCollisionFeature=new x(e,t,n,l,h,c))}var o=t("./element_groups"),a=t("../symbol/anchor"),s=t("../symbol/get_anchors"),u=t("../util/token"),l=t("../symbol/quads"),h=t("../symbol/shaping"),c=t("../symbol/resolve_text"),f=t("../symbol/resolve_icons"),d=t("../symbol/mergelines"),p=h.shapeText,m=h.shapeIcon,y=l.getGlyphQuads,v=l.getIconQuads,_=t("../symbol/clip_line"),g=t("point-geometry"),x=t("../symbol/collision_feature");e.exports=n,n.prototype.needsPlacement=!0,n.prototype.addFeatures=function(t){var e=this.layoutProperties,i=this.features,n=this.textFeatures,r=.5,o=.5;switch(e["text-anchor"]){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(e["text-anchor"]){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}for(var a="right"===e["text-justify"]?1:"left"===e["text-justify"]?0:.5,s=24*e["text-line-height"],l="line"!==e["symbol-placement"]?24*e["text-max-width"]:0,h=24*e["text-letter-spacing"],c=[24*e["text-offset"][0],24*e["text-offset"][1]],f=e["text-font"].join(","),y=[],v=0;v<i.length;v++)y.push(i[v].loadGeometry());if("line"===e["symbol-placement"]){var _=d(i,n,y);y=_.geometries,i=_.features,n=_.textFeatures}for(var g,x,b=0;b<i.length;b++)if(y[b]){if(g=n[b]?p(n[b],this.stacks[f],l,s,r,o,a,h,c):null,e["icon-image"]){var w=u(i[b].properties,e["icon-image"]),M=this.icons[w];x=m(M,e),M&&(void 0===this.sdfIcons?this.sdfIcons=M.sdf:this.sdfIcons!==M.sdf&&console.warn("Style sheet warning: Cannot mix SDF and non-SDF icons in one bucket"))}else x=null;(g||x)&&this.addFeature(y[b],g,x)}this.placeFeatures(t,this.buffers,this.collisionDebug)},n.prototype.addFeature=function(t,e,i){var n=this.layoutProperties,o=n["text-size"]/24,u=this.tilePixelRatio*o,l=this.tilePixelRatio*n["text-max-size"]/24,h=this.tilePixelRatio*n["icon-size"],c=this.tilePixelRatio*n["symbol-spacing"],f=n["symbol-avoid-edges"],d=n["text-padding"]*this.tilePixelRatio,p=n["icon-padding"]*this.tilePixelRatio,m=n["text-max-angle"]/180*Math.PI,y="map"===n["text-rotation-alignment"]&&"line"===n["symbol-placement"],v="map"===n["icon-rotation-alignment"]&&"line"===n["symbol-placement"],g=n["text-allow-overlap"]||n["icon-allow-overlap"]||n["text-ignore-placement"]||n["icon-ignore-placement"],x="line"===n["symbol-placement"],b=c/2;x&&(t=_(t,0,0,4096,4096));for(var w=0;w<t.length;w++)for(var M=t[w],E=x?s(M,c,m,e,i,24,l,this.overscaling):[new a(M[0].x,M[0].y,0)],S=0,T=E.length;T>S;S++){var z=E[S];if(!(e&&x&&this.anchorIsTooClose(e.text,b,z))){var L=!(z.x<0||z.x>4096||z.y<0||z.y>4096);if(!f||L){var P=L||g;this.symbolInstances.push(new r(z,M,e,i,n,P,u,d,y,h,p,v))}}}},n.prototype.anchorIsTooClose=function(t,e,i){var n=this.compareText;if(t in n){for(var r=n[t],o=r.length-1;o>=0;o--)if(i.dist(r[o])<e)return!0}else n[t]=[];return n[t].push(i),!1},n.prototype.placeFeatures=function(t,e,i){this.buffers=e;var n=this.elementGroups={text:new o(e.glyphVertex,e.glyphElement),icon:new o(e.iconVertex,e.iconElement),sdfIcons:this.sdfIcons},r=this.layoutProperties,a=t.maxScale;n.text["text-size"]=r["text-size"],n.icon["icon-size"]=r["icon-size"];var s="map"===r["text-rotation-alignment"]&&"line"===r["symbol-placement"],u="map"===r["icon-rotation-alignment"]&&"line"===r["symbol-placement"];if(r["text-allow-overlap"]||r["icon-allow-overlap"]||r["text-ignore-placement"]||r["icon-ignore-placement"]){var l=t.angle,h=Math.sin(l),c=Math.cos(l);this.symbolInstances.sort(function(t,e){var i=h*t.x+c*t.y;return h*e.x+c*e.y-i})}for(var f=0;f<this.symbolInstances.length;f++){var d=this.symbolInstances[f],p=d.hasText,m=d.hasIcon,y=r["text-optional"]||!p,v=r["icon-optional"]||!m,_=p&&!r["text-allow-overlap"]?t.placeCollisionFeature(d.textCollisionFeature):t.minScale,g=m&&!r["icon-allow-overlap"]?t.placeCollisionFeature(d.iconCollisionFeature):t.minScale;y||v?!v&&_?_=Math.max(g,_):!y&&g&&(g=Math.max(g,_)):g=_=Math.max(g,_),p&&(r["text-ignore-placement"]||t.insertCollisionFeature(d.textCollisionFeature,_),a>=_&&this.addSymbols(e.glyphVertex,e.glyphElement,n.text,d.glyphQuads,_,r["text-keep-upright"],s,t.angle)),m&&(r["icon-ignore-placement"]||t.insertCollisionFeature(d.iconCollisionFeature,g),a>=g&&this.addSymbols(e.iconVertex,e.iconElement,n.icon,d.iconQuads,g,r["icon-keep-upright"],u,t.angle))}i&&this.addToDebugBuffers(t)},n.prototype.addSymbols=function(t,e,i,n,r,o,a,s){i.makeRoomFor(4*n.length);for(var u=i.current,l=this.zoom,h=Math.max(Math.log(r)/Math.LN2+l,0),c=0;c<n.length;c++){var f=n[c],d=f.angle,p=(d+s+Math.PI)%(2*Math.PI);if(!(o&&a&&(p<=Math.PI/2||p>3*Math.PI/2))){var m=f.tl,y=f.tr,v=f.bl,_=f.br,g=f.tex,x=f.anchorPoint,b=Math.max(l+Math.log(f.minScale)/Math.LN2,h),w=Math.min(l+Math.log(f.maxScale)/Math.LN2,25);if(!(b>=w)){b===h&&(b=0);var M=t.index-u.vertexStartIndex;t.add(x.x,x.y,m.x,m.y,g.x,g.y,b,w,h),t.add(x.x,x.y,y.x,y.y,g.x+g.w,g.y,b,w,h),t.add(x.x,x.y,v.x,v.y,g.x,g.y+g.h,b,w,h),t.add(x.x,x.y,_.x,_.y,g.x+g.w,g.y+g.h,b,w,h),u.vertexLength+=4,e.add(M,M+1,M+2),e.add(M+1,M+2,M+3),u.elementLength+=2}}}},n.prototype.getDependencies=function(t,e,i){function n(t){return t||r?i(t):void(r=!0)}var r=!1;this.getTextDependencies(t,e,n),this.getIconDependencies(t,e,n)},n.prototype.getIconDependencies=function(t,e,i){function n(t,e){return t?i(t):(this.icons=e,void i())}if(this.layoutProperties["icon-image"]){var r=this.features,o=f(r,this.layoutProperties);o.length?e.send("get icons",{icons:o},n.bind(this)):i()}else i()},n.prototype.getTextDependencies=function(t,e,i){var n=this.features,r=this.layoutProperties["text-font"],o=this.stacks=t.stacks;void 0===o[r]&&(o[r]={});var a=o[r],s=c(n,this.layoutProperties,a);this.textFeatures=s.textFeatures,e.send("get glyphs",{uid:t.uid,fontstack:r,codepoints:s.codepoints},function(t,e){if(t)return i(t);for(var n in e)a[n]=e[n];i()})},n.prototype.addToDebugBuffers=function(t){this.elementGroups.collisionBox=new o(this.buffers.collisionBoxVertex),this.elementGroups.collisionBox.makeRoomFor(0);for(var e=this.buffers.collisionBoxVertex,i=-t.angle,n=t.yStretch,r=0;r<this.symbolInstances.length;r++)for(var a=0;2>a;a++){var s=this.symbolInstances[r][0===a?"textCollisionFeature":"iconCollisionFeature"];if(s)for(var u=s.boxes,l=0;l<u.length;l++){var h=u[l],c=h.anchorPoint,f=new g(h.x1,h.y1*n)._rotate(i),d=new g(h.x2,h.y1*n)._rotate(i),p=new g(h.x1,h.y2*n)._rotate(i),m=new g(h.x2,h.y2*n)._rotate(i),y=Math.max(0,Math.min(25,this.zoom+Math.log(h.maxScale)/Math.LN2)),v=Math.max(0,Math.min(25,this.zoom+Math.log(h.placementScale)/Math.LN2));e.add(c,f,y,v),e.add(c,d,y,v),e.add(c,d,y,v),e.add(c,m,y,v),e.add(c,m,y,v),e.add(c,p,y,v),e.add(c,p,y,v),e.add(c,f,y,v),this.elementGroups.collisionBox.current.vertexLength+=8}}}},{"../symbol/anchor":62,"../symbol/clip_line":65,"../symbol/collision_feature":67,"../symbol/get_anchors":69,"../symbol/mergelines":72,"../symbol/quads":73,"../symbol/resolve_icons":74,"../symbol/resolve_text":75,"../symbol/shaping":76,"../util/token":105,"./element_groups":14,"point-geometry":137}],19:[function(t,e,i){function n(t,e,i){this.column=t,this.row=e,this.zoom=i}e.exports=n,n.prototype={clone:function(){return new n(this.column,this.row,this.zoom)},zoomTo:function(t){return this.clone()._zoomTo(t)},sub:function(t){return this.clone()._sub(t)},_zoomTo:function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},_sub:function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this}}},{}],20:[function(t,e,i){function n(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}e.exports=n;var r=t("../util/util").wrap;n.prototype.wrap=function(){return new n(r(this.lng,-180,180),this.lat)},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t}},{"../util/util":106}],21:[function(t,e,i){function n(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;r>n;n++)this.extend(i[n])}e.exports=n;var r=t("./lng_lat");n.prototype={extend:function(t){var e,i,o=this._sw,a=this._ne;if(t instanceof r)e=t,i=t;else{if(!(t instanceof n))return t?this.extend(r.convert(t)||n.convert(t)):this;if(e=t._sw,i=t._ne,!e||!i)return this}return o||a?(o.lng=Math.min(e.lng,o.lng),o.lat=Math.min(e.lat,o.lat),a.lng=Math.max(i.lng,a.lng),a.lat=Math.max(i.lat,a.lat)):(this._sw=new r(e.lng,e.lat),this._ne=new r(i.lng,i.lat)),this},getCenter:function(){return new r((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},getNorthWest:function(){return new r(this.getWest(),this.getNorth())},getSouthEast:function(){return new r(this.getEast(),this.getSouth())},getWest:function(){return this._sw.lng},getSouth:function(){return this._sw.lat},getEast:function(){return this._ne.lng},getNorth:function(){return this._ne.lat}},n.convert=function(t){return!t||t instanceof n?t:new n(t)}},{"./lng_lat":20}],22:[function(t,e,i){function n(t,e){this.tileSize=512,this._minZoom=t||0,this._maxZoom=e||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this.zoom=0,this.center=new r(0,0),this.angle=0,this._altitude=1.5,this._pitch=0}var r=t("./lng_lat"),o=t("point-geometry"),a=t("./coordinate"),s=t("../util/util").wrap,u=t("../util/interpolate"),l=t("gl-matrix").vec4,h=t("gl-matrix").mat4;e.exports=n,n.prototype={get minZoom(){return this._minZoom},set minZoom(t){this._minZoom=t,this.zoom=Math.max(this.zoom,t)},get maxZoom(){return this._maxZoom},set maxZoom(t){this._maxZoom=t,this.zoom=Math.min(this.zoom,t)},get worldSize(){return this.tileSize*this.scale},get centerPoint(){return this.size._div(2)},get size(){return new o(this.width,this.height)},get bearing(){return-this.angle/Math.PI*180},set bearing(t){this.angle=-s(t,-180,180)*Math.PI/180},get pitch(){return this._pitch/Math.PI*180},set pitch(t){this._pitch=Math.min(60,t)/180*Math.PI},get altitude(){return this._altitude},set altitude(t){this._altitude=Math.max(.75,t)},get zoom(){return this._zoom},set zoom(t){t=Math.min(Math.max(t,this.minZoom),this.maxZoom),this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._constrain()},get center(){return this._center},set center(t){this._center=t,this._constrain()},zoomScale:function(t){return Math.pow(2,t)},scaleZoom:function(t){return Math.log(t)/Math.LN2},project:function(t,e){return new o(this.lngX(t.lng,e),this.latY(t.lat,e))},unproject:function(t,e){return new r(this.xLng(t.x,e),this.yLat(t.y,e))},get x(){return this.lngX(this.center.lng)},get y(){return this.latY(this.center.lat)},get point(){return new o(this.x,this.y)},lngX:function(t,e){return(180+t)*(e||this.worldSize)/360},latY:function(t,e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*(e||this.worldSize)/360},xLng:function(t,e){return 360*t/(e||this.worldSize)-180},yLat:function(t,e){var i=180-360*t/(e||this.worldSize);return 360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90},panBy:function(t){var e=this.centerPoint._add(t);this.center=this.pointLocation(e)},setLocationAtPoint:function(t,e){var i=this.locationCoordinate(t),n=this.pointCoordinate(e),r=this.pointCoordinate(this.centerPoint),o=n._sub(i);this.center=this.coordinateLocation(r._sub(o))},setZoomAround:function(t,e){var i;e&&(i=this.locationPoint(e)),this.zoom=t,e&&this.setLocationAtPoint(e,i)},setBearingAround:function(t,e){var i;e&&(i=this.locationPoint(e)),this.bearing=t,e&&this.setLocationAtPoint(e,i)},locationPoint:function(t){return this.coordinatePoint(this.locationCoordinate(t))},pointLocation:function(t){return this.coordinateLocation(this.pointCoordinate(t))},locationCoordinate:function(t){var e=this.zoomScale(this.tileZoom)/this.worldSize,i=r.convert(t);return new a(this.lngX(i.lng)*e,this.latY(i.lat)*e,this.tileZoom)},coordinateLocation:function(t){var e=this.zoomScale(t.zoom);return new r(this.xLng(t.column,e),this.yLat(t.row,e))},pointCoordinate:function(t,e){void 0===e&&(e=0);var i=this.coordinatePointMatrix(this.tileZoom),n=h.invert(new Float64Array(16),i);if(!n)throw new Error("failed to invert matrix");var r=l.transformMat4([],[t.x,t.y,0,1],n),o=l.transformMat4([],[t.x,t.y,1,1],n),s=r[3],c=o[3],f=r[0]/s,d=o[0]/c,p=r[1]/s,m=o[1]/c,y=r[2]/s,v=o[2]/c,_=y===v?0:(e-y)/(v-y);return new a(u(f,d,_),u(p,m,_),this.tileZoom)},coordinatePoint:function(t){var e=this.coordinatePointMatrix(t.zoom),i=l.transformMat4([],[t.column,t.row,0,1],e);return new o(i[0]/i[3],i[1]/i[3])},coordinatePointMatrix:function(t){var e=this.getProjMatrix(),i=this.worldSize/this.zoomScale(t);return h.scale(e,e,[i,i,1]),h.multiply(e,this.getPixelMatrix(),e),e},getPixelMatrix:function(){var t=h.create();return h.scale(t,t,[this.width/2,-this.height/2,1]),h.translate(t,t,[1,-1,0]),t},_constrain:function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,e,i,n,r,a,s,u,l=this.size;this.latRange&&(t=this.latY(this.latRange[1]),e=this.latY(this.latRange[0]),r=e-t<l.y?l.y/(e-t):0),this.lngRange&&(i=this.lngX(this.lngRange[0]),n=this.lngX(this.lngRange[1]),a=n-i<l.x?l.x/(n-i):0);var h=Math.max(a||0,r||0);if(h)return this.center=this.unproject(new o(a?(n+i)/2:this.x,r?(e+t)/2:this.y)),this.zoom+=this.scaleZoom(h),void(this._constraining=!1);if(this.latRange){var c=this.y,f=l.y/2;t>c-f&&(u=t+f),c+f>e&&(u=e-f)}if(this.lngRange){var d=this.x,p=l.x/2;i>d-p&&(s=i+p),d+p>n&&(s=n-p)}
(void 0!==s||void 0!==u)&&(this.center=this.unproject(new o(void 0!==s?s:this.x,void 0!==u?u:this.y))),this._constraining=!1}},getProjMatrix:function(){var t=new Float64Array(16),e=Math.atan(.5/this.altitude),i=Math.sin(e)*this.altitude/Math.sin(Math.PI/2-this._pitch-e),n=Math.cos(Math.PI/2-this._pitch)*i+this.altitude;return h.perspective(t,2*Math.atan(this.height/2/this.altitude),this.width/this.height,.1,n),h.translate(t,t,[0,0,-this.altitude]),h.scale(t,t,[1,-1,1/this.height]),h.rotateX(t,t,this._pitch),h.rotateZ(t,t,this.angle),h.translate(t,t,[-this.x,-this.y,0]),t}}},{"../util/interpolate":102,"../util/util":106,"./coordinate":19,"./lng_lat":20,"gl-matrix":116,"point-geometry":137}],23:[function(t,e,i){var n={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};e.exports=function(t,e,i,r){r=r||1;var o,a,s,u,l,h,c,f,d=[];for(o=0,a=t.length;a>o;o++)if(l=n[t[o]]){for(f=null,s=0,u=l[1].length;u>s;s+=2)-1===l[1][s]&&-1===l[1][s+1]?f=null:(h=e+l[1][s]*r,c=i-l[1][s+1]*r,f&&d.push(f.x,f.y,h,c),f={x:h,y:c});e+=l[0]*r}return d}},{}],24:[function(t,e,i){var n=e.exports={};n.Map=t("./ui/map"),n.Control=t("./ui/control/control"),n.Navigation=t("./ui/control/navigation"),n.Attribution=t("./ui/control/attribution"),n.Popup=t("./ui/popup"),n.GeoJSONSource=t("./source/geojson_source"),n.VideoSource=t("./source/video_source"),n.ImageSource=t("./source/image_source"),n.Style=t("./style/style"),n.LngLat=t("./geo/lng_lat"),n.LngLatBounds=t("./geo/lng_lat_bounds"),n.Point=t("point-geometry"),n.Evented=t("./util/evented"),n.util=t("./util/util"),n.supported=t("./util/browser").supported;var r=t("./util/ajax");n.util.getJSON=r.getJSON,n.util.getArrayBuffer=r.getArrayBuffer;var o=t("./util/config");n.config=o,Object.defineProperty(n,"accessToken",{get:function(){return o.ACCESS_TOKEN},set:function(t){o.ACCESS_TOKEN=t}})},{"./geo/lng_lat":20,"./geo/lng_lat_bounds":21,"./source/geojson_source":39,"./source/image_source":41,"./source/video_source":48,"./style/style":56,"./ui/control/attribution":79,"./ui/control/control":80,"./ui/control/navigation":81,"./ui/map":91,"./ui/popup":92,"./util/ajax":94,"./util/browser":95,"./util/config":99,"./util/evented":100,"./util/util":106,"point-geometry":137}],25:[function(t,e,i){function n(t,e,i){var n,o=t.gl,a=e.paint["background-color"],s=e.paint["background-pattern"],u=e.paint["background-opacity"],l=s?t.spriteAtlas.getPosition(s.from,!0):null,h=s?t.spriteAtlas.getPosition(s.to,!0):null;if(l&&h){n=t.patternShader,o.switchShader(n,i),o.uniform1i(n.u_image,0),o.uniform2fv(n.u_pattern_tl_a,l.tl),o.uniform2fv(n.u_pattern_br_a,l.br),o.uniform2fv(n.u_pattern_tl_b,h.tl),o.uniform2fv(n.u_pattern_br_b,h.br),o.uniform1f(n.u_opacity,u);var c=t.transform,f=l.size,d=h.size,p=c.locationCoordinate(c.center),m=1/Math.pow(2,c.zoomFraction);o.uniform1f(n.u_mix,s.t);var y=r.create();r.scale(y,y,[1/(f[0]*s.fromScale),1/(f[1]*s.fromScale)]),r.translate(y,y,[p.column*c.tileSize%(f[0]*s.fromScale),p.row*c.tileSize%(f[1]*s.fromScale)]),r.rotate(y,y,-c.angle),r.scale(y,y,[m*c.width/2,-m*c.height/2]);var v=r.create();r.scale(v,v,[1/(d[0]*s.toScale),1/(d[1]*s.toScale)]),r.translate(v,v,[p.column*c.tileSize%(d[0]*s.toScale),p.row*c.tileSize%(d[1]*s.toScale)]),r.rotate(v,v,-c.angle),r.scale(v,v,[m*c.width/2,-m*c.height/2]),o.uniformMatrix3fv(n.u_patternmatrix_a,!1,y),o.uniformMatrix3fv(n.u_patternmatrix_b,!1,v),t.spriteAtlas.bind(o,!0)}else n=t.fillShader,o.switchShader(n,i),o.uniform4fv(n.u_color,a);o.disable(o.STENCIL_TEST),o.bindBuffer(o.ARRAY_BUFFER,t.backgroundBuffer),o.vertexAttribPointer(n.a_pos,t.backgroundBuffer.itemSize,o.SHORT,!1,0,0),o.drawArrays(o.TRIANGLE_STRIP,0,t.backgroundBuffer.itemCount),o.enable(o.STENCIL_TEST),o.stencilMask(0),o.stencilFunc(o.EQUAL,128,128)}var r=t("gl-matrix").mat3;e.exports=n},{"gl-matrix":116}],26:[function(t,e,i){function n(t,e,i,n){if(n.buffers){i=t.translateMatrix(i,n,e.paint["circle-translate"],e.paint["circle-translate-anchor"]);var o=n.elementGroups[e.ref||e.id];if(o){var a=t.gl;a.disable(a.STENCIL_TEST),a.switchShader(t.circleShader,i,n.exMatrix);var s=n.buffers.circleVertex,u=t.circleShader,l=n.buffers.circleElement,h=1/r.devicePixelRatio/e.paint["circle-radius"];a.uniform4fv(u.u_color,e.paint["circle-color"]),a.uniform1f(u.u_blur,Math.max(e.paint["circle-blur"],h)),a.uniform1f(u.u_size,e.paint["circle-radius"]);for(var c=0;c<o.groups.length;c++){var f=o.groups[c],d=f.vertexStartIndex*s.itemSize;s.bind(a,u,d),l.bind(a,u,d);var p=3*f.elementLength,m=f.elementStartIndex*l.itemSize;a.drawElements(a.TRIANGLES,p,a.UNSIGNED_SHORT,m)}a.enable(a.STENCIL_TEST)}}}var r=t("../util/browser.js");e.exports=n},{"../util/browser.js":95}],27:[function(t,e,i){function n(t,e,i,n){var r=n.elementGroups[e.ref||e.id].collisionBox;if(r){var o=t.gl,a=n.buffers.collisionBoxVertex,s=t.collisionBoxShader;o.enable(o.STENCIL_TEST),o.switchShader(s,i),a.bind(o,s),o.lineWidth(1);o.vertexAttribPointer(s.a_pos,2,o.SHORT,!1,12,0),o.vertexAttribPointer(s.a_extrude,2,o.SHORT,!1,12,4),o.vertexAttribPointer(s.a_data,2,o.UNSIGNED_BYTE,!1,12,8),o.uniform1f(s.u_scale,Math.pow(2,t.transform.zoom-n.coord.z)),o.uniform1f(s.u_zoom,10*t.transform.zoom),o.uniform1f(s.u_maxzoom,10*(n.coord.z+1));var u=r.groups[0].vertexStartIndex,l=r.groups[0].vertexLength;o.drawArrays(o.LINES,u,l),o.disable(o.STENCIL_TEST)}}e.exports=n},{}],28:[function(t,e,i){function n(t,e){var i=t.gl;i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.switchShader(t.debugShader,e.posMatrix),i.bindBuffer(i.ARRAY_BUFFER,t.debugBuffer),i.vertexAttribPointer(t.debugShader.a_pos,t.debugBuffer.itemSize,i.SHORT,!1,0,0),i.uniform4f(t.debugShader.u_color,1,0,0,1),i.lineWidth(4),i.drawArrays(i.LINE_STRIP,0,t.debugBuffer.itemCount);var n=r(e.coord.toString(),50,200,5);i.bindBuffer(i.ARRAY_BUFFER,t.debugTextBuffer),i.bufferData(i.ARRAY_BUFFER,new Int16Array(n),i.STREAM_DRAW),i.vertexAttribPointer(t.debugShader.a_pos,t.debugTextBuffer.itemSize,i.SHORT,!1,0,0),i.lineWidth(8*o.devicePixelRatio),i.uniform4f(t.debugShader.u_color,1,1,1,1),i.drawArrays(i.LINES,0,n.length/t.debugTextBuffer.itemSize),i.lineWidth(2*o.devicePixelRatio),i.uniform4f(t.debugShader.u_color,0,0,0,1),i.drawArrays(i.LINES,0,n.length/t.debugTextBuffer.itemSize),i.blendFunc(i.ONE_MINUS_DST_ALPHA,i.ONE)}var r=t("../lib/debugtext"),o=t("../util/browser");e.exports=n},{"../lib/debugtext":23,"../util/browser":95}],29:[function(t,e,i){function n(t,e,i,n){if(n.buffers){var a=n.elementGroups[e.ref||e.id];if(a){var s,u,l,h,c=t.gl,f=t.translateMatrix(i,n,e.paint["fill-translate"],e.paint["fill-translate-anchor"]),d=e.paint["fill-color"];c.stencilMask(63),c.clear(c.STENCIL_BUFFER_BIT),c.stencilFunc(c.NOTEQUAL,128,128),c.stencilOpSeparate(c.FRONT,c.INCR_WRAP,c.KEEP,c.KEEP),c.stencilOpSeparate(c.BACK,c.DECR_WRAP,c.KEEP,c.KEEP),c.colorMask(!1,!1,!1,!1),c.switchShader(t.fillShader,f),s=n.buffers.fillVertex,s.bind(c),u=n.buffers.fillElement,u.bind(c);for(var p,m,y=0;y<a.groups.length;y++)l=a.groups[y],p=l.vertexStartIndex*s.itemSize,c.vertexAttribPointer(t.fillShader.a_pos,2,c.SHORT,!1,4,p+0),h=3*l.elementLength,m=l.elementStartIndex*u.itemSize,c.drawElements(c.TRIANGLES,h,c.UNSIGNED_SHORT,m);c.colorMask(!0,!0,!0,!0),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),c.stencilMask(0);var v=e.paint["fill-outline-color"];if(!0===e.paint["fill-antialias"]&&(!e.paint["fill-pattern"]||v)){c.switchShader(t.outlineShader,f),c.lineWidth(2*r.devicePixelRatio),v?c.stencilFunc(c.EQUAL,128,128):c.stencilFunc(c.EQUAL,128,191),c.uniform2f(t.outlineShader.u_world,c.drawingBufferWidth,c.drawingBufferHeight),c.uniform4fv(t.outlineShader.u_color,v||d),s=n.buffers.fillVertex,u=n.buffers.outlineElement,u.bind(c);for(var _=0;_<a.groups.length;_++)l=a.groups[_],p=l.vertexStartIndex*s.itemSize,c.vertexAttribPointer(t.outlineShader.a_pos,2,c.SHORT,!1,4,p+0),h=2*l.secondElementLength,m=l.secondElementStartIndex*u.itemSize,c.drawElements(c.LINES,h,c.UNSIGNED_SHORT,m)}var g,x=e.paint["fill-pattern"],b=e.paint["fill-opacity"]||1;if(x){var w=t.spriteAtlas.getPosition(x.from,!0),M=t.spriteAtlas.getPosition(x.to,!0);if(!w||!M)return;g=t.patternShader,c.switchShader(g,i),c.uniform1i(g.u_image,0),c.uniform2fv(g.u_pattern_tl_a,w.tl),c.uniform2fv(g.u_pattern_br_a,w.br),c.uniform2fv(g.u_pattern_tl_b,M.tl),c.uniform2fv(g.u_pattern_br_b,M.br),c.uniform1f(g.u_opacity,b),c.uniform1f(g.u_mix,x.t);var E=n.tileExtent/n.tileSize/Math.pow(2,t.transform.tileZoom-n.coord.z),S=o.create();o.scale(S,S,[1/(w.size[0]*E*x.fromScale),1/(w.size[1]*E*x.fromScale)]);var T=o.create();o.scale(T,T,[1/(M.size[0]*E*x.toScale),1/(M.size[1]*E*x.toScale)]),c.uniformMatrix3fv(g.u_patternmatrix_a,!1,S),c.uniformMatrix3fv(g.u_patternmatrix_b,!1,T),t.spriteAtlas.bind(c,!0)}else g=t.fillShader,c.switchShader(g,i),c.uniform4fv(g.u_color,d);c.stencilFunc(c.NOTEQUAL,0,63),c.bindBuffer(c.ARRAY_BUFFER,t.tileExtentBuffer),c.vertexAttribPointer(g.a_pos,t.tileExtentBuffer.itemSize,c.SHORT,!1,0,0),c.drawArrays(c.TRIANGLE_STRIP,0,t.tileExtentBuffer.itemCount),c.stencilMask(0),c.stencilFunc(c.EQUAL,128,128)}}}var r=t("../util/browser"),o=t("gl-matrix").mat3;e.exports=n},{"../util/browser":95,"gl-matrix":116}],30:[function(t,e,i){var n=t("../util/browser"),r=t("gl-matrix").mat2;e.exports=function(t,e,i,o){if(o.buffers){var a=o.elementGroups[e.ref||e.id];if(a){var s=t.gl;if(!(e.paint["line-width"]<=0)){var u=1/n.devicePixelRatio,l=e.paint["line-blur"]+u,h=e.paint["line-width"]/2,c=-1,f=0;e.paint["line-gap-width"]>0&&(c=e.paint["line-gap-width"]/2+.5*u,h=e.paint["line-width"],f=c-u/2);var d=f+h+u/2+0,p=e.paint["line-color"],m=t.transform.scale/(1<<o.coord.z)/(o.tileExtent/o.tileSize),y=t.translateMatrix(i,o,e.paint["line-translate"],e.paint["line-translate-anchor"]),v=t.transform,_=r.create();r.scale(_,_,[1,Math.cos(v._pitch)]),r.rotate(_,_,t.transform.angle);var g,x=Math.sqrt(v.height*v.height/4*(1+v.altitude*v.altitude)),b=v.height/2*Math.tan(v._pitch),w=(x+b)/x-1,M=o.tileSize/t.transform.tileSize,E=e.paint["line-dasharray"],S=e.paint["line-pattern"];if(E){g=t.linesdfpatternShader,s.switchShader(g,y,o.exMatrix),s.uniform2fv(g.u_linewidth,[d,c]),s.uniform1f(g.u_ratio,m),s.uniform1f(g.u_blur,l),s.uniform4fv(g.u_color,p);var T=t.lineAtlas.getDash(E.from,"round"===e.layout["line-cap"]),z=t.lineAtlas.getDash(E.to,"round"===e.layout["line-cap"]);t.lineAtlas.bind(s);var L=Math.pow(2,Math.floor(Math.log(t.transform.scale)/Math.LN2)-o.coord.z)/8*M,P=[L/T.width/E.fromScale,-T.height/2],R=t.lineAtlas.width/(E.fromScale*T.width*256*n.devicePixelRatio)/2,A=[L/z.width/E.toScale,-z.height/2],I=t.lineAtlas.width/(E.toScale*z.width*256*n.devicePixelRatio)/2;s.uniform2fv(g.u_patternscale_a,P),s.uniform1f(g.u_tex_y_a,T.y),s.uniform2fv(g.u_patternscale_b,A),s.uniform1f(g.u_tex_y_b,z.y),s.uniform1i(g.u_image,0),s.uniform1f(g.u_sdfgamma,Math.max(R,I)),s.uniform1f(g.u_mix,E.t),s.uniform1f(g.u_extra,w),s.uniformMatrix2fv(g.u_antialiasingmatrix,!1,_)}else if(S){var D=t.spriteAtlas.getPosition(S.from,!0),k=t.spriteAtlas.getPosition(S.to,!0);if(!D||!k)return;var C=o.tileExtent/o.tileSize/Math.pow(2,t.transform.tileZoom-o.coord.z)*M;t.spriteAtlas.bind(s,!0),g=t.linepatternShader,s.switchShader(g,y,o.exMatrix),s.uniform2fv(g.u_linewidth,[d,c]),s.uniform1f(g.u_ratio,m),s.uniform1f(g.u_blur,l),s.uniform2fv(g.u_pattern_size_a,[D.size[0]*C*S.fromScale,k.size[1]]),s.uniform2fv(g.u_pattern_size_b,[k.size[0]*C*S.toScale,k.size[1]]),s.uniform2fv(g.u_pattern_tl_a,D.tl),s.uniform2fv(g.u_pattern_br_a,D.br),s.uniform2fv(g.u_pattern_tl_b,k.tl),s.uniform2fv(g.u_pattern_br_b,k.br),s.uniform1f(g.u_fade,S.t),s.uniform1f(g.u_opacity,e.paint["line-opacity"]),s.uniform1f(g.u_extra,w),s.uniformMatrix2fv(g.u_antialiasingmatrix,!1,_)}else g=t.lineShader,s.switchShader(g,y,o.exMatrix),s.uniform2fv(g.u_linewidth,[d,c]),s.uniform1f(g.u_ratio,m),s.uniform1f(g.u_blur,l),s.uniform1f(g.u_extra,w),s.uniformMatrix2fv(g.u_antialiasingmatrix,!1,_),s.uniform4fv(g.u_color,p);var j=o.buffers.lineVertex;j.bind(s);var F=o.buffers.lineElement;F.bind(s);for(var B=0;B<a.groups.length;B++){var N=a.groups[B],O=N.vertexStartIndex*j.itemSize;s.vertexAttribPointer(g.a_pos,2,s.SHORT,!1,8,O+0),s.vertexAttribPointer(g.a_data,4,s.BYTE,!1,8,O+4);var U=3*N.elementLength,q=N.elementStartIndex*F.itemSize;s.drawElements(s.TRIANGLES,U,s.UNSIGNED_SHORT,q)}}}}}},{"../util/browser":95,"gl-matrix":116}],31:[function(t,e,i){function n(t,e,i,n){var u=t.gl;u.disable(u.STENCIL_TEST);var l=t.rasterShader;u.switchShader(l,i),u.uniform1f(l.u_brightness_low,e.paint["raster-brightness-min"]),u.uniform1f(l.u_brightness_high,e.paint["raster-brightness-max"]),u.uniform1f(l.u_saturation_factor,a(e.paint["raster-saturation"])),u.uniform1f(l.u_contrast_factor,o(e.paint["raster-contrast"])),u.uniform3fv(l.u_spin_weights,r(e.paint["raster-hue-rotate"]));var h,c,f=n.source&&n.source._pyramid.findLoadedParent(n.coord,0,{}),d=s(n,f,e,t.transform);u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,n.texture),f?(u.activeTexture(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,f.texture),h=Math.pow(2,f.coord.z-n.coord.z),c=[n.coord.x*h%1,n.coord.y*h%1]):d[1]=0,u.uniform2fv(l.u_tl_parent,c||[0,0]),u.uniform1f(l.u_scale_parent,h||1),u.uniform1f(l.u_buffer_scale,1),u.uniform1f(l.u_opacity0,d[0]),u.uniform1f(l.u_opacity1,d[1]),u.uniform1i(l.u_image0,0),u.uniform1i(l.u_image1,1),u.bindBuffer(u.ARRAY_BUFFER,n.boundsBuffer||t.tileExtentBuffer),u.vertexAttribPointer(l.a_pos,2,u.SHORT,!1,8,0),u.vertexAttribPointer(l.a_texture_pos,2,u.SHORT,!1,8,4),u.drawArrays(u.TRIANGLE_STRIP,0,4),u.enable(u.STENCIL_TEST)}function r(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}function o(t){return t>0?1/(1-t):1+t}function a(t){return t>0?1-1/(1.001-t):-t}function s(t,e,i,n){if(!t.source)return[1,0];var r=(new Date).getTime(),o=i.paint["raster-fade-duration"],a=(r-t.timeAdded)/o,s=e?(r-e.timeAdded)/o:-1,l=t.source._pyramid.coveringZoomLevel(n),h=!!e&&Math.abs(e.coord.z-l)>Math.abs(t.coord.z-l),c=[];!e||h?(c[0]=u.clamp(a,0,1),c[1]=1-c[0]):(c[0]=u.clamp(1-s,0,1),c[1]=1-c[0]);var f=i.paint["raster-opacity"];return c[0]*=f,c[1]*=f,c}var u=t("../util/util");e.exports=n},{"../util/util":106}],32:[function(t,e,i){function n(t,e,i,n){if(n.buffers){var o=n.elementGroups[e.ref||e.id];if(o){var a=!(e.layout["text-allow-overlap"]||e.layout["icon-allow-overlap"]||e.layout["text-ignore-placement"]||e.layout["icon-ignore-placement"]),u=t.gl;a&&u.disable(u.STENCIL_TEST),o.text.groups.length&&r(t,e,i,n,o.text,"text",!0),o.icon.groups.length&&r(t,e,i,n,o.icon,"icon",o.sdfIcons),s(t,e,i,n),a&&u.enable(u.STENCIL_TEST)}}}function r(t,e,i,n,r,s,l){var h=t.gl;i=t.translateMatrix(i,n,e.paint[s+"-translate"],e.paint[s+"-translate-anchor"]);var c,f,d,p=t.transform,m="map"===e.layout[s+"-rotation-alignment"],y=m;y?(c=a.create(),f=n.tileExtent/n.tileSize/Math.pow(2,t.transform.zoom-n.coord.z),d=1/Math.cos(p._pitch)):(c=a.clone(n.exMatrix),f=t.transform.altitude,d=1),a.scale(c,c,[f,f,1]);var v=e.paint[s+"-size"],_=v/u[s];a.scale(c,c,[_,_,1]);var g,x,b,w,M=Math.sqrt(p.height*p.height/4*(1+p.altitude*p.altitude)),E=p.height/2*Math.tan(p._pitch),S=(M+E)/M-1,T="text"===s;if(T||t.style.sprite.loaded()){h.activeTexture(h.TEXTURE0),g=l?t.sdfShader:t.iconShader,T?(t.glyphAtlas.updateTexture(h),x=n.buffers.glyphVertex,b=n.buffers.glyphElement,w=[t.glyphAtlas.width/4,t.glyphAtlas.height/4]):(t.spriteAtlas.bind(h,m||t.options.rotating||t.options.zooming||1!==_||l||t.transform.pitch),x=n.buffers.iconVertex,b=n.buffers.iconElement,w=[t.spriteAtlas.width/4,t.spriteAtlas.height/4]),h.switchShader(g,i,c),h.uniform1i(g.u_texture,0),h.uniform2fv(g.u_texsize,w),h.uniform1i(g.u_skewed,y),h.uniform1f(g.u_extra,S);var z=Math.log(v/r[s+"-size"])/Math.LN2||0;h.uniform1f(g.u_zoom,10*(t.transform.zoom-z));var L=t.frameHistory.getFadeProperties(300);h.uniform1f(g.u_fadedist,10*L.fadedist),h.uniform1f(g.u_minfadezoom,Math.floor(10*L.minfadezoom)),h.uniform1f(g.u_maxfadezoom,Math.floor(10*L.maxfadezoom)),h.uniform1f(g.u_fadezoom,10*(t.transform.zoom+L.bump));var P,R,A,I;if(b.bind(h),l){var D=.105*u[s]/v/o.devicePixelRatio;h.uniform1f(g.u_gamma,D*d),h.uniform4fv(g.u_color,e.paint[s+"-color"]),h.uniform1f(g.u_buffer,.75);for(var k=0;k<r.groups.length;k++)P=r.groups[k],R=P.vertexStartIndex*x.itemSize,x.bind(h,g,R),A=3*P.elementLength,I=P.elementStartIndex*b.itemSize,h.drawElements(h.TRIANGLES,A,h.UNSIGNED_SHORT,I);if(e.paint[s+"-halo-width"]){h.uniform1f(g.u_gamma,(1.19*e.paint[s+"-halo-blur"]/_/8+D)*d),h.uniform4fv(g.u_color,e.paint[s+"-halo-color"]),h.uniform1f(g.u_buffer,(6-e.paint[s+"-halo-width"]/_)/8);for(var C=0;C<r.groups.length;C++)P=r.groups[C],R=P.vertexStartIndex*x.itemSize,x.bind(h,g,R),A=3*P.elementLength,I=P.elementStartIndex*b.itemSize,h.drawElements(h.TRIANGLES,A,h.UNSIGNED_SHORT,I)}}else{h.uniform1f(g.u_opacity,e.paint["icon-opacity"]);for(var j=0;j<r.groups.length;j++)P=r.groups[j],R=P.vertexStartIndex*x.itemSize,x.bind(h,g,R),A=3*P.elementLength,I=P.elementStartIndex*b.itemSize,h.drawElements(h.TRIANGLES,A,h.UNSIGNED_SHORT,I)}}}var o=t("../util/browser"),a=t("gl-matrix").mat4,s=t("./draw_collision_debug");e.exports=n;var u={icon:1,text:24}},{"../util/browser":95,"./draw_collision_debug":27,"gl-matrix":116}],33:[function(t,e,i){function n(t,e,i,n){function a(e,i,n,o){s.switchShader(t.dotShader,n),s.uniform1f(t.dotShader.u_size,4*r.devicePixelRatio),s.uniform1f(t.dotShader.u_blur,.25),s.uniform4fv(t.dotShader.u_color,[.1,0,0,.1]),e.bind(s,t.dotShader,0);for(var a=0;a<i.length;a++){var u=i[a],l=u.vertexStartIndex,h=u.vertexLength;s.vertexAttribPointer(t.dotShader.a_pos,2,s.SHORT,!1,o,0),s.drawArrays(s.POINTS,l,h)}}var s=t.gl;if(n&&n.buffers){var u=n.elementGroups[e.ref||e.id];if(u){if(s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),"fill"===e.type)a(n.buffers.fillVertex,u.groups,i,4);else if("symbol"===e.type)a(n.buffers.iconVertex,u.icon.groups,i,16),a(n.buffers.glyphVertex,u.text.groups,i,16);else if("line"===e.type){var l=o.clone(i);o.scale(l,l,[.5,.5,1]),a(n.buffers.lineVertex,u.groups,l,8)}s.blendFunc(s.ONE_MINUS_DST_ALPHA,s.ONE)}}}var r=t("../util/browser"),o=t("gl-matrix").mat4;e.exports=n},{"../util/browser":95,"gl-matrix":116}],34:[function(t,e,i){function n(){this.frameHistory=[]}e.exports=n,n.prototype.getFadeProperties=function(t){void 0===t&&(t=300);for(var e=(new Date).getTime();this.frameHistory.length>3&&this.frameHistory[1].time+t<e;)this.frameHistory.shift();this.frameHistory[1].time+t<e&&(this.frameHistory[0].z=this.frameHistory[1].z);var i=this.frameHistory.length;3>i&&console.warn("there should never be less than three frames in the history");var n=this.frameHistory[0].z,r=this.frameHistory[i-1],o=r.z,a=Math.min(n,o),s=Math.max(n,o),u=r.z-this.frameHistory[1].z,l=r.time-this.frameHistory[1].time,h=u/(l/t);return isNaN(h)&&console.warn("fadedist should never be NaN"),{fadedist:h,minfadezoom:a,maxfadezoom:s,bump:(e-r.time)/t*h}},n.prototype.record=function(t){var e=(new Date).getTime();this.frameHistory.length||this.frameHistory.push({time:0,z:t},{time:0,z:t}),(2===this.frameHistory.length||this.frameHistory[this.frameHistory.length-1].z!==t)&&this.frameHistory.push({time:e,z:t})}},{}],35:[function(t,e,i){var n=t("./shaders"),r=t("../util/util");i.extend=function(t){var e=t.lineWidth,i=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE);return t.lineWidth=function(n){e.call(t,r.clamp(n,i[0],i[1]))},t.getShader=function(t,e){var i=e===this.FRAGMENT_SHADER?"fragment":"vertex";if(!n[t]||!n[t][i])throw new Error("Could not find shader "+t);var r=this.createShader(e),o=n[t][i];if("undefined"==typeof orientation&&(o=o.replace(/ highp /g," ")),this.shaderSource(r,o),this.compileShader(r),!this.getShaderParameter(r,this.COMPILE_STATUS))throw new Error(this.getShaderInfoLog(r));return r},t.initializeShader=function(t,e,i){var n={program:this.createProgram(),fragment:this.getShader(t,this.FRAGMENT_SHADER),vertex:this.getShader(t,this.VERTEX_SHADER),attributes:[]};if(this.attachShader(n.program,n.vertex),this.attachShader(n.program,n.fragment),this.linkProgram(n.program),this.getProgramParameter(n.program,this.LINK_STATUS)){for(var r=0;r<e.length;r++)n[e[r]]=this.getAttribLocation(n.program,e[r]),n.attributes.push(n[e[r]]);for(var o=0;o<i.length;o++)n[i[o]]=this.getUniformLocation(n.program,i[o])}else console.error(this.getProgramInfoLog(n.program));return n},t.switchShader=function(t,e,i){if(e||console.trace("posMatrix does not have required argument"),this.currentShader!==t){this.useProgram(t.program);for(var n=this.currentShader?this.currentShader.attributes:[],r=t.attributes,o=0;o<n.length;o++)r.indexOf(n[o])<0&&this.disableVertexAttribArray(n[o]);for(var a=0;a<r.length;a++)n.indexOf(r[a])<0&&this.enableVertexAttribArray(r[a]);this.currentShader=t}t.posMatrix!==e&&(this.uniformMatrix4fv(t.u_matrix,!1,e),t.posMatrix=e),i&&t.exMatrix!==i&&t.u_exmatrix&&(this.uniformMatrix4fv(t.u_exmatrix,!1,i),t.exMatrix=i)},t.vertexAttrib2fv=function(e,i){t.vertexAttrib2f(e,i[0],i[1])},t.vertexAttrib3fv=function(e,i){t.vertexAttrib3f(e,i[0],i[1],i[2])},t.vertexAttrib4fv=function(e,i){t.vertexAttrib4f(e,i[0],i[1],i[2],i[3])},t}},{"../util/util":106,"./shaders":38}],36:[function(t,e,i){function n(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}}e.exports=n,n.prototype.setSprite=function(t){this.sprite=t},n.prototype.getDash=function(t,e){var i=t.join(",")+e;return this.positions[i]||(this.positions[i]=this.addDash(t,e)),this.positions[i]},n.prototype.addDash=function(t,e){var i=e?7:0,n=2*i+1;if(this.nextRow+n>this.height)return console.warn("LineAtlas out of space"),null;for(var r=0,o=0;o<t.length;o++)r+=t[o];for(var a=this.width/r,s=a/2,u=t.length%2==1,l=-i;i>=l;l++)for(var h=this.nextRow+i+l,c=this.width*h,f=u?-t[t.length-1]:0,d=t[0],p=1,m=0;m<this.width;m++){for(;m/a>d;)f=d,d+=t[p],u&&p===t.length-1&&(d+=t[0]),p++;var y,v=Math.abs(m-f*a),_=Math.abs(m-d*a),g=Math.min(v,_),x=p%2==1;if(e){var b=i?l/i*(s+1):0;if(x){var w=s-Math.abs(b);y=Math.sqrt(g*g+w*w)}else y=s-Math.sqrt(g*g+b*b)}else y=(x?1:-1)*g;this.data[3+4*(c+m)]=Math.max(0,Math.min(255,y+128))}var M={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:r};return this.nextRow+=n,this.dirty=!0,M},n.prototype.bind=function(t){this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,this.data))},n.prototype.debug=function(){var t=document.createElement("canvas");document.body.appendChild(t),t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.background="#ff0",t.width=this.width,t.height=this.height;for(var e=t.getContext("2d"),i=e.getImageData(0,0,this.width,this.height),n=0;n<this.data.length;n++)if(this.sdf){var r=4*n;i.data[r]=i.data[r+1]=i.data[r+2]=0,i.data[r+3]=this.data[n]}else i.data[n]=this.data[n];e.putImageData(i,0,0)}},{}],37:[function(t,e,i){function n(t,e){this.gl=r.extend(t),this.transform=e,this.reusableTextures={},this.preFbos={},this.frameHistory=new s,this.setup()}var r=t("./gl_util"),o=t("../util/browser"),a=t("gl-matrix").mat4,s=t("./frame_history");e.exports=n,n.prototype.resize=function(t,e){var i=this.gl;this.width=t*o.devicePixelRatio,this.height=e*o.devicePixelRatio,i.viewport(0,0,this.width,this.height)},n.prototype.setup=function(){var t=this.gl;t.verbose=!0,t.enable(t.BLEND),t.blendFunc(t.ONE_MINUS_DST_ALPHA,t.ONE),t.enable(t.STENCIL_TEST),this.debugShader=t.initializeShader("debug",["a_pos"],["u_matrix","u_color"]),this.rasterShader=t.initializeShader("raster",["a_pos","a_texture_pos"],["u_matrix","u_brightness_low","u_brightness_high","u_saturation_factor","u_spin_weights","u_contrast_factor","u_opacity0","u_opacity1","u_image0","u_image1","u_tl_parent","u_scale_parent","u_buffer_scale"]),this.circleShader=t.initializeShader("circle",["a_pos"],["u_matrix","u_exmatrix","u_blur","u_size","u_color"]),this.lineShader=t.initializeShader("line",["a_pos","a_data"],["u_matrix","u_linewidth","u_color","u_ratio","u_blur","u_extra","u_antialiasingmatrix"]),this.linepatternShader=t.initializeShader("linepattern",["a_pos","a_data"],["u_matrix","u_linewidth","u_ratio","u_pattern_size_a","u_pattern_size_b","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_blur","u_fade","u_opacity","u_extra","u_antialiasingmatrix"]),this.linesdfpatternShader=t.initializeShader("linesdfpattern",["a_pos","a_data"],["u_matrix","u_linewidth","u_color","u_ratio","u_blur","u_patternscale_a","u_tex_y_a","u_patternscale_b","u_tex_y_b","u_image","u_sdfgamma","u_mix","u_extra","u_antialiasingmatrix"]),this.dotShader=t.initializeShader("dot",["a_pos"],["u_matrix","u_size","u_color","u_blur"]),
this.sdfShader=t.initializeShader("sdf",["a_pos","a_offset","a_data1","a_data2"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_color","u_gamma","u_buffer","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_skewed","u_extra"]),this.iconShader=t.initializeShader("icon",["a_pos","a_offset","a_data1","a_data2"],["u_matrix","u_exmatrix","u_texture","u_texsize","u_zoom","u_fadedist","u_minfadezoom","u_maxfadezoom","u_fadezoom","u_opacity","u_skewed","u_extra"]),this.outlineShader=t.initializeShader("outline",["a_pos"],["u_matrix","u_color","u_world"]),this.patternShader=t.initializeShader("pattern",["a_pos"],["u_matrix","u_pattern_tl_a","u_pattern_br_a","u_pattern_tl_b","u_pattern_br_b","u_mix","u_patternmatrix_a","u_patternmatrix_b","u_opacity","u_image"]),this.fillShader=t.initializeShader("fill",["a_pos"],["u_matrix","u_color"]),this.collisionBoxShader=t.initializeShader("collisionbox",["a_pos","a_extrude","a_data"],["u_matrix","u_scale","u_zoom","u_maxzoom"]),this.identityMatrix=a.create(),this.backgroundBuffer=t.createBuffer(),this.backgroundBuffer.itemSize=2,this.backgroundBuffer.itemCount=4,t.bindBuffer(t.ARRAY_BUFFER,this.backgroundBuffer),t.bufferData(t.ARRAY_BUFFER,new Int16Array([-1,-1,1,-1,-1,1,1,1]),t.STATIC_DRAW),this.setExtent(4096),this.debugTextBuffer=t.createBuffer(),this.debugTextBuffer.itemSize=2},n.prototype.setExtent=function(t){if(t&&t!==this.tileExtent){this.tileExtent=t;var e=this.gl;this.tileExtentBuffer=e.createBuffer(),this.tileExtentBuffer.itemSize=4,this.tileExtentBuffer.itemCount=4,e.bindBuffer(e.ARRAY_BUFFER,this.tileExtentBuffer),e.bufferData(e.ARRAY_BUFFER,new Int16Array([0,0,0,0,this.tileExtent,0,32767,0,0,this.tileExtent,0,32767,this.tileExtent,this.tileExtent,32767,32767]),e.STATIC_DRAW),this.debugBuffer=e.createBuffer(),this.debugBuffer.itemSize=2,this.debugBuffer.itemCount=5,e.bindBuffer(e.ARRAY_BUFFER,this.debugBuffer),e.bufferData(e.ARRAY_BUFFER,new Int16Array([0,0,this.tileExtent-1,0,this.tileExtent-1,this.tileExtent-1,0,this.tileExtent-1,0,0]),e.STATIC_DRAW)}},n.prototype.clearColor=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},n.prototype.clearStencil=function(){var t=this.gl;t.clearStencil(0),t.stencilMask(255),t.clear(t.STENCIL_BUFFER_BIT)},n.prototype.drawClippingMask=function(t){var e=this.gl;e.switchShader(this.fillShader,t.posMatrix),e.colorMask(!1,!1,!1,!1),e.clearStencil(0),e.stencilMask(191),e.clear(e.STENCIL_BUFFER_BIT),e.stencilFunc(e.EQUAL,192,64),e.stencilMask(192),e.stencilOp(e.REPLACE,e.KEEP,e.KEEP),e.bindBuffer(e.ARRAY_BUFFER,this.tileExtentBuffer),e.vertexAttribPointer(this.fillShader.a_pos,this.tileExtentBuffer.itemSize,e.SHORT,!1,8,0),e.drawArrays(e.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount),e.stencilFunc(e.EQUAL,128,128),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.stencilMask(0),e.colorMask(!0,!0,!0,!0)},n.prototype.prepareBuffers=function(){},n.prototype.bindDefaultFramebuffer=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)};var u={symbol:t("./draw_symbol"),circle:t("./draw_circle"),line:t("./draw_line"),fill:t("./draw_fill"),raster:t("./draw_raster"),background:t("./draw_background"),debug:t("./draw_debug"),vertices:t("./draw_vertices")};n.prototype.render=function(t,e){this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.spriteAtlas=t.spriteAtlas,this.spriteAtlas.setSprite(t.sprite),this.glyphAtlas=t.glyphAtlas,this.glyphAtlas.bind(this.gl),this.frameHistory.record(this.transform.zoom),this.prepareBuffers(),this.clearColor();for(var i=t._groups.length-1;i>=0;i--){var n=t._groups[i],r=t.sources[n.source];r?(this.clearStencil(),r.render(n,this)):void 0===n.source&&this.drawLayers(n,this.identityMatrix)}},n.prototype.drawTile=function(t,e){this.setExtent(t.tileExtent),this.drawClippingMask(t),this.drawLayers(e,t.posMatrix,t),this.options.debug&&u.debug(this,t)},n.prototype.drawLayers=function(t,e,i){for(var n=t.length-1;n>=0;n--){var r=t[n];r.hidden||(u[r.type](this,r,e,i),this.options.vertices&&u.vertices(this,r,e,i))}},n.prototype.drawStencilBuffer=function(){var t=this.gl;t.switchShader(this.fillShader,this.identityMatrix),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.stencilMask(0),t.stencilFunc(t.EQUAL,128,128),t.bindBuffer(t.ARRAY_BUFFER,this.backgroundBuffer),t.vertexAttribPointer(this.fillShader.a_pos,this.backgroundBuffer.itemSize,t.SHORT,!1,0,0),t.uniform4fv(this.fillShader.u_color,[0,0,0,.5]),t.drawArrays(t.TRIANGLE_STRIP,0,this.tileExtentBuffer.itemCount),t.blendFunc(t.ONE_MINUS_DST_ALPHA,t.ONE)},n.prototype.translateMatrix=function(t,e,i,n){if(!i[0]&&!i[1])return t;if("viewport"===n){var r=Math.sin(-this.transform.angle),o=Math.cos(-this.transform.angle);i=[i[0]*o-i[1]*r,i[0]*r+i[1]*o]}var s=this.transform.scale/(1<<e.coord.z)/(e.tileExtent/e.tileSize),u=[i[0]/s,i[1]/s,0],l=new Float32Array(16);return a.translate(l,t,u),l},n.prototype.saveTexture=function(t){var e=this.reusableTextures[t.size];e?e.push(t):this.reusableTextures[t.size]=[t]},n.prototype.getTexture=function(t){var e=this.reusableTextures[t];return e&&e.length>0?e.pop():null}},{"../util/browser":95,"./draw_background":25,"./draw_circle":26,"./draw_debug":28,"./draw_fill":29,"./draw_line":30,"./draw_raster":31,"./draw_symbol":32,"./draw_vertices":33,"./frame_history":34,"./gl_util":35,"gl-matrix":116}],38:[function(t,e,i){e.exports={debug:{vertex:"precision mediump float;attribute vec2 a_pos;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*vec4(a_pos,step(32767.,a_pos.x),1);}",fragment:"precision mediump float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}"},dot:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform float u_size;attribute vec2 a_pos;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);gl_PointSize=u_size;}",fragment:"precision mediump float;uniform vec4 u_color;uniform float u_blur;void main(){float a,b;a=length(gl_PointCoord-.5);b=smoothstep(.5,.5-u_blur,a);gl_FragColor=u_color*b;}"},fill:{vertex:"precision mediump float;attribute vec2 a_pos;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);}",fragment:"precision mediump float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}"},circle:{vertex:"precision mediump float;uniform float u_size;attribute vec2 a_pos;uniform mat4 u_matrix,u_exmatrix;varying vec2 a;void main(){a=vec2(mod(a_pos,2.)*2.-1.);vec4 b=u_exmatrix*vec4(a*u_size,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5),0,1);gl_Position+=b*gl_Position.w;}",fragment:"precision mediump float;uniform vec4 u_color;uniform float u_blur,u_size;varying vec2 a;void main(){float b=smoothstep(1.-u_blur,1.,length(a));gl_FragColor=u_color*(1.-b);}"},line:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_data;uniform highp mat4 u_matrix;uniform float u_ratio,u_extra;uniform vec2 u_linewidth;uniform mat2 u_antialiasingmatrix;varying vec2 a;varying float b,c;void main(){vec2 d,e;d=a_data.xy;e=mod(a_pos,2.);e.y=sign(e.y-.5);a=e;vec4 f=vec4(u_linewidth.s*d*.015873016,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5)+f.xy/u_ratio,0,1);float g,h,i;g=gl_Position.y/gl_Position.w;h=length(d)/length(u_antialiasingmatrix*d);i=1./(1.-min(g*u_extra,.9));c=i*h;}",fragment:"precision mediump float;uniform vec2 u_linewidth;uniform vec4 u_color;uniform float u_blur;varying vec2 a;varying float b,c;void main(){float d,e,f;d=length(a)*u_linewidth.s;e=u_blur*c;f=clamp(min(d-(u_linewidth.t-e),u_linewidth.s-d)/e,0.,1.);gl_FragColor=u_color*f;}"},linepattern:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_data;uniform highp mat4 u_matrix;uniform float u_ratio,u_extra;uniform vec2 u_linewidth;uniform vec4 u_color;uniform mat2 u_antialiasingmatrix;varying vec2 a;varying float b,c;void main(){vec2 d,f,g,h;d=a_data.xy;float e,i,j,k;e=a_data.z*128.+a_data.w;f=mod(a_pos,2.);f.y=sign(f.y-.5);a=f;g=d*.015873016;h=u_linewidth.s*g;gl_Position=u_matrix*vec4(floor(a_pos*.5)+h.xy/u_ratio,0,1);b=e;i=gl_Position.y/gl_Position.w;j=length(d)/length(u_antialiasingmatrix*d);k=1./(1.-min(i*u_extra,.9));c=k*j;}",fragment:"precision mediump float;uniform vec2 u_linewidth,u_pattern_size_a,u_pattern_size_b,u_pattern_tl_a,u_pattern_br_a,u_pattern_tl_b,u_pattern_br_b;uniform float u_point,u_blur,u_fade,u_opacity;uniform sampler2D u_image;varying vec2 a;varying float b,c;void main(){float d,e,f,g,h,i,j;d=length(a)*u_linewidth.s;e=u_blur*c;f=clamp(min(d-(u_linewidth.t-e),u_linewidth.s-d)/e,0.,1.);g=mod(b/u_pattern_size_a.x,1.);h=mod(b/u_pattern_size_b.x,1.);i=.5+a.y*u_linewidth.s/u_pattern_size_a.y;j=.5+a.y*u_linewidth.s/u_pattern_size_b.y;vec2 k,l;k=mix(u_pattern_tl_a,u_pattern_br_a,vec2(g,i));l=mix(u_pattern_tl_b,u_pattern_br_b,vec2(h,j));vec4 m=mix(texture2D(u_image,k),texture2D(u_image,l),u_fade);f*=u_opacity;gl_FragColor=m*f;}"},linesdfpattern:{vertex:"precision mediump float;attribute vec2 a_pos;attribute vec4 a_data;uniform highp mat4 u_matrix;uniform vec2 u_linewidth,u_patternscale_a,u_patternscale_b;uniform float u_ratio,u_tex_y_a,u_tex_y_b,u_extra;uniform mat2 u_antialiasingmatrix;varying vec2 a,b,c;varying float d;void main(){vec2 e,g;e=a_data.xy;float f,i,j,k;f=a_data.z*128.+a_data.w;g=mod(a_pos,2.);g.y=sign(g.y-.5);a=g;vec4 h=vec4(u_linewidth.s*e*.015873016,0,0);gl_Position=u_matrix*vec4(floor(a_pos*.5)+h.xy/u_ratio,0,1);b=vec2(f*u_patternscale_a.x,g.y*u_patternscale_a.y+u_tex_y_a);c=vec2(f*u_patternscale_b.x,g.y*u_patternscale_b.y+u_tex_y_b);i=gl_Position.y/gl_Position.w;j=length(e)/length(u_antialiasingmatrix*e);k=1./(1.-min(i*u_extra,.9));d=k*j;}",fragment:"precision mediump float;uniform vec2 u_linewidth;uniform vec4 u_color;uniform float u_blur,u_sdfgamma,u_mix;uniform sampler2D u_image;varying vec2 a,b,c;varying float d;void main(){float e,f,g,h,i,j;e=length(a)*u_linewidth.s;f=u_blur*d;g=clamp(min(e-(u_linewidth.t-f),u_linewidth.s-e)/f,0.,1.);h=texture2D(u_image,b).a;i=texture2D(u_image,c).a;j=mix(h,i,u_mix);g*=smoothstep(.5-u_sdfgamma,.5+u_sdfgamma,j);gl_FragColor=u_color*g;}"},outline:{vertex:"precision mediump float;attribute vec2 a_pos;uniform highp mat4 u_matrix;uniform vec2 u_world;varying vec2 a;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(gl_Position.xy/gl_Position.w+1.)/2.*u_world;}",fragment:"precision mediump float;uniform vec4 u_color;varying vec2 a;void main(){float b,c;b=length(a-gl_FragCoord.xy);c=smoothstep(1.,0.,b);gl_FragColor=u_color*c;}"},pattern:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform mat3 u_patternmatrix_a,u_patternmatrix_b;attribute vec2 a_pos;varying vec2 a,b;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(u_patternmatrix_a*vec3(a_pos,1)).xy;b=(u_patternmatrix_b*vec3(a_pos,1)).xy;}",fragment:"precision mediump float;uniform float u_opacity,u_mix;uniform vec2 u_pattern_tl_a,u_pattern_br_a,u_pattern_tl_b,u_pattern_br_b;uniform sampler2D u_image;varying vec2 a,b;void main(){vec2 c,d,f,g;c=mod(a,1.);d=mix(u_pattern_tl_a,u_pattern_br_a,c);vec4 e,h;e=texture2D(u_image,d);f=mod(b,1.);g=mix(u_pattern_tl_b,u_pattern_br_b,f);h=texture2D(u_image,g);gl_FragColor=mix(e,h,u_mix)*u_opacity;}"},raster:{vertex:"precision mediump float;uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent,u_buffer_scale;attribute vec2 a_pos,a_texture_pos;varying vec2 a,b;void main(){gl_Position=u_matrix*vec4(a_pos,0,1);a=(a_texture_pos/32767.-.5)/u_buffer_scale+.5;b=a*u_scale_parent+u_tl_parent;}",fragment:"precision mediump float;uniform float u_opacity0,u_opacity1,u_brightness_low,u_brightness_high,u_saturation_factor,u_contrast_factor;uniform sampler2D u_image0,u_image1;varying vec2 a,b;uniform vec3 u_spin_weights;void main(){vec4 c,d,e;c=texture2D(u_image0,a);d=texture2D(u_image1,b);e=c*u_opacity0+d*u_opacity1;vec3 f,h,i;f=e.rgb;f=vec3(dot(f,u_spin_weights.xyz),dot(f,u_spin_weights.zxy),dot(f,u_spin_weights.yzx));float g=(e.r+e.g+e.b)/3.;f+=(g-f)*u_saturation_factor;f=(f-.5)*u_contrast_factor+.5;h=vec3(u_brightness_low);i=vec3(u_brightness_high);gl_FragColor=vec4(mix(h,i,f),e.a);}"},icon:{vertex:"precision mediump float;attribute vec2 a_pos,a_offset;attribute vec4 a_data1,a_data2;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_zoom,u_fadedist,u_minfadezoom,u_maxfadezoom,u_fadezoom,u_opacity,u_extra;uniform bool u_skewed;uniform vec2 u_texsize;varying vec2 a;varying float b;void main(){vec2 c,e;c=a_data1.xy;float d,f,g,h,i,j;d=a_data1[2];e=a_data2.st;f=e[0];g=e[1];h=10.;i=2.-step(f,u_zoom)-(1.-step(g,u_zoom));j=clamp((u_fadezoom-d)/u_fadedist,0.,1.);if(u_fadedist>=0.)b=j;else b=1.-j;if(u_maxfadezoom<d)b=0.;if(u_minfadezoom>=d)b=1.;i+=step(b,0.);if(u_skewed){vec4 k=u_exmatrix*vec4(a_offset/64.,0,0);gl_Position=u_matrix*vec4(a_pos+k.xy,0,1);gl_Position.z+=i*gl_Position.w;}else{vec4 k=u_exmatrix*vec4(a_offset/64.,i,0);gl_Position=u_matrix*vec4(a_pos,0,1)+k;}a=c/u_texsize;b*=u_opacity;}",fragment:"precision mediump float;uniform sampler2D u_texture;varying vec2 a;varying float b;void main(){gl_FragColor=texture2D(u_texture,a)*b;}"},sdf:{vertex:"precision mediump float;attribute vec2 a_pos,a_offset;attribute vec4 a_data1,a_data2;uniform highp mat4 u_matrix;uniform mat4 u_exmatrix;uniform float u_zoom,u_fadedist,u_minfadezoom,u_maxfadezoom,u_fadezoom,u_extra;uniform bool u_skewed;uniform vec2 u_texsize;varying vec2 a;varying float b,c;void main(){vec2 d,f;d=a_data1.xy;float e,g,h,i,j,k,l;e=a_data1[2];f=a_data2.st;g=f[0];h=f[1];i=2.-step(g,u_zoom)-(1.-step(h,u_zoom));j=clamp((u_fadezoom-e)/u_fadedist,0.,1.);if(u_fadedist>=0.)b=j;else b=1.-j;if(u_maxfadezoom<e)b=0.;if(u_minfadezoom>=e)b=1.;i+=step(b,0.);if(u_skewed){vec4 k=u_exmatrix*vec4(a_offset/64.,0,0);gl_Position=u_matrix*vec4(a_pos+k.xy,0,1);gl_Position.z+=i*gl_Position.w;}else{vec4 k=u_exmatrix*vec4(a_offset/64.,i,0);gl_Position=u_matrix*vec4(a_pos,0,1)+k;}k=gl_Position.y/gl_Position.w;l=1./(1.-k*u_extra);c=l;a=d/u_texsize;}",fragment:"precision mediump float;uniform sampler2D u_texture;uniform vec4 u_color;uniform float u_buffer,u_gamma;varying vec2 a;varying float b,c;void main(){float d,e,f;d=u_gamma*c;e=texture2D(u_texture,a).a;f=smoothstep(u_buffer-d,u_buffer+d,e)*b;gl_FragColor=u_color*f;}"},collisionbox:{vertex:"precision mediump float;attribute vec2 a_pos,a_extrude,a_data;uniform mat4 u_matrix;uniform float u_scale;varying float a,b;void main(){gl_Position=u_matrix*vec4(a_pos+a_extrude/u_scale,0,1);a=a_data.x;b=a_data.y;}",fragment:"precision mediump float;uniform float u_zoom,u_maxzoom;varying float a,b;void main(){float c=.5;gl_FragColor=vec4(0,1,0,1)*c;if(b>u_zoom)gl_FragColor=vec4(1,0,0,1)*c;if(u_zoom>=a)gl_FragColor=vec4(0,0,0,1)*c*.25;if(b>=u_maxzoom)gl_FragColor=vec4(0,0,1,1)*c*.2;}"}}},{}],39:[function(t,e,i){function n(t){t=t||{},this._data=t.data,void 0!==t.maxzoom&&(this.maxzoom=t.maxzoom),this.geojsonVtOptions={maxZoom:this.maxzoom},void 0!==t.buffer&&(this.geojsonVtOptions.buffer=t.buffer),void 0!==t.tolerance&&(this.geojsonVtOptions.tolerance=t.tolerance),this._pyramid=new a({tileSize:512,minzoom:this.minzoom,maxzoom:this.maxzoom,cacheSize:20,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this)})}var r=t("../util/util"),o=t("../util/evented"),a=t("./tile_pyramid"),s=t("./source"),u=t("resolve-url");e.exports=n,n.prototype=r.inherit(o,{minzoom:0,maxzoom:14,_dirty:!0,setData:function(t){return this._data=t,this._dirty=!0,this.fire("change"),this.map&&this.update(this.map.transform),this},onAdd:function(t){this.map=t},loaded:function(){return this._loaded&&this._pyramid.loaded()},update:function(t){this._dirty&&this._updateData(),this._loaded&&this._pyramid.update(this.used,t)},reload:function(){this._loaded&&this._pyramid.reload()},render:s._renderTiles,featuresAt:s._vectorFeaturesAt,featuresIn:s._vectorFeaturesIn,_updateData:function(){this._dirty=!1;var t=this._data;"string"==typeof t&&(t=u(window.location.href,t)),this.workerID=this.dispatcher.send("parse geojson",{data:t,tileSize:512,source:this.id,geojsonVtOptions:this.geojsonVtOptions},function(t){return t?void this.fire("error",{error:t}):(this._loaded=!0,this._pyramid.reload(),void this.fire("change"))}.bind(this))},_loadTile:function(t){var e=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,i={uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxzoom,tileSize:512,source:this.id,overscaling:e,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug};t.workerID=this.dispatcher.send("load geojson tile",i,function(e,i){if(t.unloadVectorData(this.map.painter),!t.aborted){if(e)return void this.fire("tile.error",{tile:t});t.loadVectorData(i),this.fire("tile.load",{tile:t})}}.bind(this),this.workerID)},_abortTile:function(t){t.aborted=!0},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.unloadVectorData(this.map.painter),this.glyphAtlas.removeGlyphs(t.uid),this.dispatcher.send("remove tile",{uid:t.uid,source:this.id},null,t.workerID)}})},{"../util/evented":100,"../util/util":106,"./source":43,"./tile_pyramid":46,"resolve-url":140}],40:[function(t,e,i){function n(t){this.features=t,this.length=t.length}function r(t){this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=4096}var o=t("point-geometry"),a=t("vector-tile").VectorTileFeature;e.exports=n,n.prototype.feature=function(t){return new r(this.features[t])},r.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var i=t[e],n=[],r=0;r<i.length;r++)n.push(new o(i[r][0],i[r][1]));this.geometry.push(n)}return this.geometry},r.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,i=-1/0,n=1/0,r=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var u=a[s];e=Math.min(e,u.x),i=Math.max(i,u.x),n=Math.min(n,u.y),r=Math.max(r,u.y)}return[e,n,i,r]},r.prototype.toGeoJSON=a.prototype.toGeoJSON},{"point-geometry":137,"vector-tile":144}],41:[function(t,e,i){function n(t){this.coordinates=t.coordinates,l.getImage(t.url,function(t,e){t||(this.image=e,this.image.addEventListener("load",function(){this.map._rerender()}.bind(this)),this._loaded=!0,this.map&&(this.createTile(),this.fire("change")))}.bind(this))}var r=t("../util/util"),o=t("./tile"),a=t("../geo/lng_lat"),s=t("point-geometry"),u=t("../util/evented"),l=t("../util/ajax");e.exports=n,n.prototype=r.inherit(u,{onAdd:function(t){this.map=t,this.image&&this.createTile()},createTile:function(){var t=this.map,e=this.coordinates.map(function(e){var i=a.convert(e);return t.transform.locationCoordinate(i).zoomTo(0)}),i=r.getCoordinatesCenter(e),n=e.map(function(t){var e=t.zoomTo(i.zoom);return new s(Math.round(4096*(e.column-i.column)),Math.round(4096*(e.row-i.row)))}),u=t.painter.gl,l=32767,h=new Int16Array([n[0].x,n[0].y,0,0,n[1].x,n[1].y,l,0,n[3].x,n[3].y,0,l,n[2].x,n[2].y,l,l]);this.tile=new o,this.tile.buckets={},this.tile.boundsBuffer=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,this.tile.boundsBuffer),u.bufferData(u.ARRAY_BUFFER,h,u.STATIC_DRAW),this.center=i},loaded:function(){return this.image&&this.image.complete},update:function(){},reload:function(){},render:function(t,e){if(this._loaded&&this.loaded()){var i=this.center;this.tile.calculateMatrices(i.zoom,i.column,i.row,this.map.transform,e);var n=e.gl;this.tile.texture?(n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.image)):(this.tile.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.image)),e.drawLayers(t,this.tile.posMatrix,this.tile)}},featuresAt:function(t,e,i){return i(null,[])}})},{"../geo/lng_lat":20,"../util/ajax":94,"../util/evented":100,"../util/util":106,"./tile":44,"point-geometry":137}],42:[function(t,e,i){function n(t){r.extend(this,r.pick(t,["url","tileSize"])),s._loadTileJSON.call(this,t)}var r=t("../util/util"),o=t("../util/ajax"),a=t("../util/evented"),s=t("./source"),u=t("../util/mapbox").normalizeTileURL;e.exports=n,n.prototype=r.inherit(a,{minzoom:0,maxzoom:22,roundZoom:!0,tileSize:512,_loaded:!1,onAdd:function(t){this.map=t},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(t){this._pyramid&&this._pyramid.update(this.used,t,this.map.style.rasterFadeDuration)},reload:function(){},render:s._renderTiles,_loadTile:function(t){function e(e,i){if(delete t.request,!t.aborted){if(e)return void this.fire("tile.error",{tile:t});var n=this.map.painter.gl;t.texture=this.map.painter.getTexture(i.width),t.texture?(n.bindTexture(n.TEXTURE_2D,t.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,i)):(t.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,t.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i),t.texture.size=i.width),n.generateMipmap(n.TEXTURE_2D),t.timeAdded=(new Date).getTime(),this.map.animationLoop.set(this.style.rasterFadeDuration),t.source=this,t.loaded=!0,this.fire("tile.load",{tile:t})}}var i=u(t.coord.url(this.tiles),this.url);t.request=o.getImage(i,e.bind(this))},_abortTile:function(t){t.aborted=!0,t.request&&(t.request.abort(),delete t.request)},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.texture&&this.map.painter.saveTexture(t.texture)},featuresAt:function(t,e,i){i(null,[])},featuresIn:function(t,e,i){i(null,[])}})},{"../util/ajax":94,"../util/evented":100,"../util/mapbox":103,"../util/util":106,"./source":43}],43:[function(t,e,i){var n=t("../util/util"),r=t("../util/ajax"),o=t("../util/browser"),a=t("./tile_pyramid"),s=t("./tile_coord"),u=t("../util/mapbox").normalizeSourceURL;i._loadTileJSON=function(t){var e=function(t){this._pyramid=new a({index:t,tileSize:this.tileSize,cacheSize:20,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom,reparseOverscaled:this.reparseOverscaled,load:this._loadTile.bind(this),abort:this._abortTile.bind(this),unload:this._unloadTile.bind(this),add:this._addTile.bind(this),remove:this._removeTile.bind(this),redoPlacement:this._redoTilePlacement?this._redoTilePlacement.bind(this):void 0})}.bind(this),i=function(t,i){return t?void this.fire("error",{error:t}):(n.extend(this,n.pick(i,["tiles","minzoom","maxzoom","attribution"])),void(i.index?r.getJSON(u(i.index),function(t,i){return t?void this.fire("error",{error:t}):(e(i.index),void this.fire("load"))}.bind(this)):(e(),this.fire("load"))))}.bind(this);t.url?r.getJSON(u(t.url),i):o.frame(i.bind(this,null,t))},i._renderTiles=function(t,e){if(this._pyramid)for(var i=this._pyramid.renderedIDs(),n=0;n<i.length;n++){var r=this._pyramid.getTile(i[n]),o=s.fromID(i[n]),a=o.z,u=o.x,l=o.y,h=o.w;a=Math.min(a,this.maxzoom),(r.tileExtent>4096||r.parentId)&&(r.tileExtent=4096),u+=h*(1<<a),r.calculateMatrices(a,u,l,e.transform,e),e.drawTile(r,t)}},i._vectorFeaturesAt=function(t,e,i){if(!this._pyramid)return i(null,[]);var n=this._pyramid.tileAt(t);return n?void this.dispatcher.send("query features",{uid:n.tile.uid,x:n.x,y:n.y,tileExtent:n.tile.tileExtent,scale:n.scale,source:this.id,params:e},i,n.tile.workerID):i(null,[])},i._vectorFeaturesIn=function(t,e,i){if(!this._pyramid)return i(null,[]);var r=this._pyramid.tilesIn(t);return r?void n.asyncAll(r,function(t,i){this.dispatcher.send("query features",{uid:t.tile.uid,source:this.id,minX:t.minX,maxX:t.maxX,minY:t.minY,maxY:t.maxY,params:e},i,t.tile.workerID)}.bind(this),function(t,e){i(t,Array.prototype.concat.apply([],e))}):i(null,[])},i.create=function(e){var i={vector:t("./vector_tile_source"),raster:t("./raster_tile_source"),geojson:t("./geojson_source"),video:t("./video_source"),image:t("./image_source")};for(var n in i)if(e instanceof i[n])return e;return new i[e.type](e)}},{"../util/ajax":94,"../util/browser":95,"../util/mapbox":103,"../util/util":106,"./geojson_source":39,"./image_source":41,"./raster_tile_source":42,"./tile_coord":45,"./tile_pyramid":46,"./vector_tile_source":47,"./video_source":48}],44:[function(t,e,i){function n(t,e){this.coord=t,this.uid=s.uniqueId(),this.loaded=!1,this.uses=0,this.tileSize=e}var r=t("gl-matrix"),o=r.mat2,a=r.mat4,s=t("../util/util"),u=t("../data/buffer/buffer_set");e.exports=n,n.prototype={tileExtent:4096,calculateMatrices:function(t,e,i,n){var r=Math.pow(2,t),s=n.worldSize/r;this.scale=s,this.posMatrix=new Float64Array(16),a.identity(this.posMatrix),a.translate(this.posMatrix,this.posMatrix,[e*s,i*s,0]),a.scale(this.posMatrix,this.posMatrix,[s/this.tileExtent,s/this.tileExtent,1]),a.multiply(this.posMatrix,n.getProjMatrix(),this.posMatrix),this.exMatrix=a.create(),a.ortho(this.exMatrix,0,n.width,n.height,0,0,-1),this.rotationMatrix=o.create(),o.rotate(this.rotationMatrix,this.rotationMatrix,n.angle),this.posMatrix=new Float32Array(this.posMatrix)},positionAt:function(t,e){return t=t.zoomTo(Math.min(this.coord.z,e)),{x:(t.column-this.coord.x)*this.tileExtent,y:(t.row-this.coord.y)*this.tileExtent,scale:this.scale}},loadVectorData:function(t){this.loaded=!0,t&&(this.buffers=new u(t.buffers),this.elementGroups=t.elementGroups,this.tileExtent=t.extent)},reloadSymbolData:function(t,e){if(this.buffers){this.buffers.glyphVertex.destroy(e.gl),this.buffers.glyphElement.destroy(e.gl),this.buffers.iconVertex.destroy(e.gl),this.buffers.iconElement.destroy(e.gl),this.buffers.collisionBoxVertex.destroy(e.gl);var i=new u(t.buffers);this.buffers.glyphVertex=i.glyphVertex,this.buffers.glyphElement=i.glyphElement,this.buffers.iconVertex=i.iconVertex,this.buffers.iconElement=i.iconElement,this.buffers.collisionBoxVertex=i.collisionBoxVertex;for(var n in t.elementGroups)this.elementGroups[n]=t.elementGroups[n]}},unloadVectorData:function(t){for(var e in this.buffers)this.buffers[e].destroy(t.gl);this.buffers=null}}},{"../data/buffer/buffer_set":2,"../util/util":106,"gl-matrix":116}],45:[function(t,e,i){function n(t,e,i,n){isNaN(n)&&(n=0),this.z=+t,this.x=+e,this.y=+i,this.w=+n,0>(n*=2)&&(n=-1*n-1);var r=1<<this.z;this.id=32*(r*r*n+r*this.y+this.x)+this.z}function r(t,e){if(t.row>e.row){var i=t;t=e,e=i}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function o(t,e,i,n,r){var o=Math.max(i,Math.floor(e.y0)),a=Math.min(n,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var u=t.dx/t.dy,l=e.dx/e.dy,h=t.dx>0,c=e.dx<0,f=o;a>f;f++){var d=u*Math.max(0,Math.min(t.dy,f+h-t.y0))+t.x0,p=l*Math.max(0,Math.min(e.dy,f+c-e.y0))+e.x0;r(Math.floor(p),Math.ceil(d),f)}}function a(t,e,i,n,a,s){var u,l=r(t,e),h=r(e,i),c=r(i,t);l.dy>h.dy&&(u=l,l=h,h=u),l.dy>c.dy&&(u=l,l=c,c=u),h.dy>c.dy&&(u=h,h=c,c=u),l.dy&&o(c,l,n,a,s),h.dy&&o(c,h,n,a,s)}e.exports=n,n.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},n.fromID=function(t){var e=t%32,i=1<<e,r=(t-e)/32,o=r%i,a=(r-o)/i%i,s=Math.floor(r/(i*i));return s%2!=0&&(s=-1*s-1),s/=2,new n(e,o,a,s)},n.prototype.url=function(t,e){return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",Math.min(this.z,e||this.z)).replace("{x}",this.x).replace("{y}",this.y)},n.prototype.parent=function(t){return 0===this.z?null:this.z>t?new n(this.z-1,this.x,this.y,this.w):new n(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)},n.prototype.wrapped=function(){return new n(this.z,this.x,this.y,0)},n.prototype.children=function(t){if(this.z>=t)return[new n(this.z+1,this.x,this.y,this.w)];var e=this.z+1,i=2*this.x,r=2*this.y;return[new n(e,i,r,this.w),new n(e,i+1,r,this.w),new n(e,i,r+1,this.w),new n(e,i+1,r+1,this.w)]},n.cover=function(t,e,i){function r(t,e,r){var a,u,l;if(r>=0&&o>=r)for(a=t;e>a;a++)u=(a%o+o)%o,l=new n(i,u,r,Math.floor(a/o)),s[l.id]=l}var o=1<<t,s={};return a(e[0],e[1],e[2],0,o,r),a(e[2],e[3],e[0],0,o,r),Object.keys(s).map(function(t){return s[t]})}},{}],46:[function(t,e,i){function n(t){this.tileSize=t.tileSize,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.roundZoom=t.roundZoom,this.reparseOverscaled=t.reparseOverscaled,this.index=t.index,this._load=t.load,this._abort=t.abort,this._unload=t.unload,this._add=t.add,this._remove=t.remove,this._redoPlacement=t.redoPlacement,this._tiles={},this._cache=new s(t.cacheSize,function(t){return this._unload(t)}.bind(this))}var r=t("./tile"),o=t("./tile_coord"),a=t("point-geometry"),s=t("../util/mru_cache"),u=t("../util/util");e.exports=n,n.prototype={loaded:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0},orderedIDs:function(){return Object.keys(this._tiles).sort(function(t,e){return e%32-t%32}).map(function(t){return+t})},renderedIDs:function(){return this.orderedIDs().filter(function(t){return this._tiles[t].loaded&&!this._coveredTiles[t]}.bind(this))},reload:function(){this._cache.reset();for(var t in this._tiles)this._load(this._tiles[t])},getTile:function(t){return this._tiles[t]},getZoom:function(t){return t.zoom+Math.log(t.tileSize/this.tileSize)/Math.LN2},coveringZoomLevel:function(t){return(this.roundZoom?Math.round:Math.floor)(this.getZoom(t))},coveringTiles:function(t){var e=this.coveringZoomLevel(t),i=e;if(e<this.minzoom)return[];e>this.maxzoom&&(e=this.maxzoom);var n=t,r=n.locationCoordinate(n.center)._zoomTo(e),s=new a(r.column-.5,r.row-.5);return o.cover(e,[n.pointCoordinate(new a(0,0))._zoomTo(e),n.pointCoordinate(new a(n.width,0))._zoomTo(e),n.pointCoordinate(new a(n.width,n.height))._zoomTo(e),n.pointCoordinate(new a(0,n.height))._zoomTo(e)],this.reparseOverscaled?i:e).sort(function(t,e){return s.dist(t)-s.dist(e)})},findLoadedChildren:function(t,e,i){for(var n=!0,r=t.z,o=t.children(this.maxzoom),a=0;a<o.length;a++){var s=o[a].id;this._tiles[s]&&this._tiles[s].loaded?i[s]=!0:(n=!1,e>r&&this.findLoadedChildren(o[a],e,i))}return n},findLoadedParent:function(t,e,i){for(var n=t.z-1;n>=e;n--){t=t.parent(this.maxzoom);var r=this._tiles[t.id];if(r&&r.loaded)return i[t.id]=!0,r}},update:function(t,e,i){var n,r,a,s=(this.roundZoom?Math.round:Math.floor)(this.getZoom(e)),l=u.clamp(s-10,this.minzoom,this.maxzoom),h=u.clamp(s+1,this.minzoom,this.maxzoom),c={},f=(new Date).getTime();this._coveredTiles={};var d=t?this.coveringTiles(e):[];for(n=0;n<d.length;n++)r=d[n],a=this.addTile(r),c[r.id]=!0,a.loaded||this.findLoadedChildren(r,h,c)||this.findLoadedParent(r,l,c);for(var p in c)r=o.fromID(p),(a=this._tiles[p])&&a.timeAdded>f-(i||0)&&(this.findLoadedChildren(r,h,c)?(this._coveredTiles[p]=!0,c[p]=!0):this.findLoadedParent(r,l,c));var m=u.keysDifference(this._tiles,c);for(n=0;n<m.length;n++)this.removeTile(+m[n])},addTile:function(t){var e=this._tiles[t.id];if(e)return e;var i=t.wrapped();if(e=this._tiles[i.id],e||(e=this._cache.get(i.id))&&this._redoPlacement&&this._redoPlacement(e),!e){var n=t.z,o=n>this.maxzoom?Math.pow(2,n-this.maxzoom):1;e=new r(i,this.tileSize*o),this.index&&(e.parentId=this.indexSearch(t.id)),this._load(e)}return e.uses++,this._tiles[t.id]=e,this._add(e,t),e},removeTile:function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._remove(e),e.uses>0||(e.loaded?this._cache.add(e.coord.wrapped().id,e):(this._abort(e),this._unload(e))))},clearTiles:function(){for(var t in this._tiles)this.removeTile(t);this._cache.reset()},tileAt:function(t){for(var e=this.orderedIDs(),i=0;i<e.length;i++){var n=this._tiles[e[i]],r=n.positionAt(t,this.maxzoom);if(r&&r.x>=0&&r.x<n.tileExtent&&r.y>=0&&r.y<n.tileExtent)return{tile:n,x:r.x,y:r.y,scale:r.scale}}},tilesIn:function(t){
for(var e=[],i=this.orderedIDs(),n=0;n<i.length;n++){var r=this._tiles[i[n]],o=[r.positionAt(t[0],this.maxzoom),r.positionAt(t[1],this.maxzoom)];o[0].x<r.tileExtent&&o[0].y<r.tileExtent&&o[1].x>=0&&o[1].y>=0&&e.push({tile:r,minX:o[0].x,maxX:o[1].x,minY:o[0].y,maxY:o[1].y})}return e},indexSearch:function(t){for(var e=o.fromID(t),i=[t],n=e;0!==n.z;)n=n.parent(),i.push(n.id);for(var r,a=this.index,s=i.pop(),u=function(t){return t.id};i.length;)if(t=i.pop(),e=o.fromID(s),r=e.children(this.maxzoom).map(u).indexOf(t),a){if(0===a[r]){s=t;break}if(1===a[r]){s=t;break}s=t,a=a[r]}return 0===i.length?null:s}}},{"../util/mru_cache":104,"../util/util":106,"./tile":44,"./tile_coord":45,"point-geometry":137}],47:[function(t,e,i){function n(t){if(r.extend(this,r.pick(t,["url","tileSize"])),512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");a._loadTileJSON.call(this,t)}var r=t("../util/util"),o=t("../util/evented"),a=t("./source"),s=t("./tile_coord");e.exports=n,n.prototype=r.inherit(o,{minzoom:0,maxzoom:22,tileSize:512,reparseOverscaled:!0,_loaded:!1,onAdd:function(t){this.map=t},loaded:function(){return this._pyramid&&this._pyramid.loaded()},update:function(t){this._pyramid&&this._pyramid.update(this.used,t)},reload:function(){this._pyramid&&this._pyramid.reload()},redoPlacement:function(){if(this._pyramid)for(var t=this._pyramid.orderedIDs(),e=0;e<t.length;e++){var i=this._pyramid.getTile(t[e]);this._redoTilePlacement(i)}},render:a._renderTiles,featuresAt:a._vectorFeaturesAt,featuresIn:a._vectorFeaturesIn,_loadTile:function(t){var e=t.coord.z>this.maxzoom?Math.pow(2,t.coord.z-this.maxzoom):1,i={url:t.coord.url(this.tiles,this.maxzoom),uid:t.uid,coord:t.coord,zoom:t.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize*e,source:this.id,overscaling:e,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug,parentId:t.parentId};t.parentId&&(i.url=s.fromID(t.parentId).url(this.tiles,this.maxzoom)),t.workerID?this.dispatcher.send("reload tile",i,this._tileLoaded.bind(this,t),t.workerID):t.workerID=this.dispatcher.send("load tile",i,this._tileLoaded.bind(this,t))},_tileLoaded:function(t,e,i){if(!t.aborted){if(e)return void this.fire("tile.error",{tile:t});t.loadVectorData(i),t.redoWhenDone&&(t.redoWhenDone=!1,this._redoTilePlacement(t)),this.fire("tile.load",{tile:t}),this.fire("tile.stats",i.bucketStats)}},_abortTile:function(t){t.aborted=!0,this.dispatcher.send("abort tile",{uid:t.uid,source:this.id},null,t.workerID)},_addTile:function(t){this.fire("tile.add",{tile:t})},_removeTile:function(t){this.fire("tile.remove",{tile:t})},_unloadTile:function(t){t.unloadVectorData(this.map.painter),this.glyphAtlas.removeGlyphs(t.uid),this.dispatcher.send("remove tile",{uid:t.uid,source:this.id},null,t.workerID)},_redoTilePlacement:function(t){function e(e,i){t.reloadSymbolData(i,this.map.painter),this.fire("tile.load",{tile:t}),t.redoingPlacement=!1,t.redoWhenDone&&(this._redoTilePlacement(t),t.redoWhenDone=!1)}return!t.loaded||t.redoingPlacement?void(t.redoWhenDone=!0):(t.redoingPlacement=!0,void this.dispatcher.send("redo placement",{uid:t.uid,source:this.id,angle:this.map.transform.angle,pitch:this.map.transform.pitch,collisionDebug:this.map.collisionDebug},e.bind(this),t.workerID))}})},{"../util/evented":100,"../util/util":106,"./source":43,"./tile_coord":45}],48:[function(t,e,i){function n(t){this.coordinates=t.coordinates,l.getVideo(t.urls,function(t,e){if(!t){this.video=e,this.video.loop=!0;var i;this.video.addEventListener("playing",function(){i=this.map.style.animationLoop.set(1/0),this.map._rerender()}.bind(this)),this.video.addEventListener("pause",function(){this.map.style.animationLoop.cancel(i)}.bind(this)),this._loaded=!0,this.map&&(this.video.play(),this.createTile(),this.fire("change"))}}.bind(this))}var r=t("../util/util"),o=t("./tile"),a=t("../geo/lng_lat"),s=t("point-geometry"),u=t("../util/evented"),l=t("../util/ajax");e.exports=n,n.prototype=r.inherit(u,{roundZoom:!0,getVideo:function(){return this.video},onAdd:function(t){this.map=t,this.video&&(this.video.play(),this.createTile())},createTile:function(){var t=this.map,e=this.coordinates.map(function(e){var i=a.convert(e);return t.transform.locationCoordinate(i).zoomTo(0)}),i=r.getCoordinatesCenter(e),n=e.map(function(t){var e=t.zoomTo(i.zoom);return new s(Math.round(4096*(e.column-i.column)),Math.round(4096*(e.row-i.row)))}),u=t.painter.gl,l=32767,h=new Int16Array([n[0].x,n[0].y,0,0,n[1].x,n[1].y,l,0,n[3].x,n[3].y,0,l,n[2].x,n[2].y,l,l]);this.tile=new o,this.tile.buckets={},this.tile.boundsBuffer=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,this.tile.boundsBuffer),u.bufferData(u.ARRAY_BUFFER,h,u.STATIC_DRAW),this.center=i},loaded:function(){return this.video&&this.video.readyState>=2},update:function(){},reload:function(){},render:function(t,e){if(this._loaded&&!(this.video.readyState<2)){var i=this.center;this.tile.calculateMatrices(i.zoom,i.column,i.row,this.map.transform,e);var n=e.gl;this.tile.texture?(n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.tile.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.tile.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.video)),e.drawLayers(t,this.tile.posMatrix,this.tile)}},featuresAt:function(t,e,i){return i(null,[])},featuresIn:function(t,e,i){return i(null,[])}})},{"../geo/lng_lat":20,"../util/ajax":94,"../util/evented":100,"../util/util":106,"./tile":44,"point-geometry":137}],49:[function(t,e,i){function n(t){this.self=t,this.actor=new r(t,this),this.loading={},this.loaded={},this.layers=[],this.geoJSONIndexes={}}var r=t("../util/actor"),o=t("./worker_tile"),a=t("../util/util"),s=t("../util/ajax"),u=t("vector-tile"),l=t("pbf"),h=t("./tile_coord"),c=t("geojson-vt"),f=t("./geojson_wrapper");e.exports=function(t){return new n(t)},a.extend(n.prototype,{"set layers":function(t){this.layers=t},"load tile":function(t,e){function i(i,o){if(delete this.loading[n][r],i)return e(i);if(a.data=new u.VectorTile(new l(new Uint8Array(o))),t.parentId&&a.data.layers){var s=this.getChildPosition(t.coord.id,t.parentId);a.parse(a.data,this.layers,this.actor,e,s.dz,s.xPos,s.yPos)}else a.parse(a.data,this.layers,this.actor,e);this.loaded[n]=this.loaded[n]||{},this.loaded[n][r]=a}var n=t.source,r=t.uid;this.loading[n]||(this.loading[n]={});var a=this.loading[n][r]=new o(t);a.xhr=s.getArrayBuffer(t.url,i.bind(this))},"reload tile":function(t,e){var i=this.loaded[t.source],n=t.uid;if(i&&i[n]){var r=i[n];r.parse(r.data,this.layers,this.actor,e)}},"abort tile":function(t){var e=this.loading[t.source],i=t.uid;e&&e[i]&&(e[i].xhr.abort(),delete e[i])},"remove tile":function(t){var e=this.loaded[t.source],i=t.uid;e&&e[i]&&delete e[i]},"redo placement":function(t,e){var i=this.loaded[t.source],n=this.loading[t.source],r=t.uid;if(i&&i[r]){var o=i[r],a=o.redoPlacement(t.angle,t.pitch,t.collisionDebug);a.result&&e(null,a.result,a.transferables)}else n&&n[r]&&(n[r].angle=t.angle)},"parse geojson":function(t,e){var i=function(i,n){return i?e(i):(this.geoJSONIndexes[t.source]=c(n,t.geojsonVtOptions),void e(null))}.bind(this);"string"==typeof t.data?s.getJSON(t.data,i):i(null,t.data)},"load geojson tile":function(t,e){var i=t.source,n=t.coord,r=this.geoJSONIndexes[i].getTile(n.z,n.x,n.y);if(!r)return e(null,null);var a=new o(t);a.parse(new f(r.features),this.layers,this.actor,e),this.loaded[i]=this.loaded[i]||{},this.loaded[i][t.uid]=a},"query features":function(t,e){var i=this.loaded[t.source]&&this.loaded[t.source][t.uid];i?i.featureTree.query(t,e):e(null,[])},getChildPosition:function(t,e){var i=h.fromID(t),n=h.fromID(e),r=i.z-n.z;return{dz:r,xPos:i.x&(1<<r)-1,yPos:i.y&(1<<r)-1}}})},{"../util/actor":93,"../util/ajax":94,"../util/util":106,"./geojson_wrapper":40,"./tile_coord":45,"./worker_tile":50,"geojson-vt":111,pbf:136,"vector-tile":144}],50:[function(t,e,i){function n(t){this.coord=t.coord,this.uid=t.uid,this.zoom=t.zoom,this.maxZoom=t.maxZoom,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=t.overscaling,this.angle=t.angle,this.pitch=t.pitch,this.collisionDebug=t.collisionDebug,this.stacks={}}var r=t("../data/feature_tree"),o=t("../symbol/collision_tile"),a=t("../data/buffer/buffer_set"),s=t("../data/create_bucket");e.exports=n,n.prototype.parse=function(t,e,i,n,u,l,h){function c(t,e,i,n,r){for(var o=0;o<t.length;o++){var a=t.feature(o);a.dz=i,a.xPos=n,a.yPos=r;for(var s in e){var u=e[s];u.filter(a)&&u.features.push(a)}}}function f(t,e,i){if((!e.getDependencies||e.dependenciesLoaded)&&(!e.needsPlacement||e.previousPlaced)){if(!i){var n=Date.now();e.features.length&&e.addFeatures(x);var r=Date.now()-n;if(e.interactive)for(var o=0;o<e.features.length;o++){var a=e.features[o];t.featureTree.insert(a.bbox(),e.layers,a)}"undefined"!=typeof self&&(self.bucketStats=self.bucketStats||{_total:0},self.bucketStats._total+=r,self.bucketStats[e.id]=(self.bucketStats[e.id]||0)+r),e.features=null}return R--,R?void(e.next&&(e.next.previousPlaced=!0,f(t,e.next))):void d()}}function d(){if(_.status="done",_.redoPlacementAfterDone){var t=_.redoPlacement(_.angle,_.pitch).result;g.glyphVertex=t.buffers.glyphVertex,g.iconVertex=t.buffers.iconVertex,g.collisionBoxVertex=t.buffers.collisionBoxVertex}var e=[],i={};for(m in g)e.push(g[m].array);for(m in b)i[m]=b[m].elementGroups;n(null,{elementGroups:i,buffers:g,extent:L,bucketStats:"undefined"!=typeof self?self.bucketStats:null},e)}this.status="parsing",this.featureTree=new r(this.coord,this.overscaling);var p,m,y,v,_=this,g=new a,x=new o(this.angle,this.pitch),b={},w=this.bucketsInOrder=[],M={};for(p=0;p<e.length;p++)if(y=e[p],y.source===this.source&&!y.ref){var E=y.minzoom;if(!(E&&this.zoom<E&&E<this.maxZoom)){var S=y.maxzoom;if(!(S&&this.zoom>=S)){var T=y.layout.visibility;if("none"!==T)if(v=s(y,g,this.zoom,this.overscaling,this.collisionDebug),v.layers=[y.id],b[v.id]=v,w.push(v),t.layers){var z=y["source-layer"];M[z]||(M[z]={}),M[z][v.id]=v}else M[v.id]=v}}}for(p=0;p<e.length;p++)y=e[p],y.source===this.source&&y.ref&&(v=b[y.ref])&&v.layers.push(y.id);var L=4096;if(t.layers)for(m in M)(y=t.layers[m])&&(y.extent&&(L=y.extent),c(y,M[m],u,l,h));else c(t,M);var P,R=w.length;for(p=w.length-1;p>=0;p--)v=w[p],v.needsPlacement&&(P?P.next=v:v.previousPlaced=!0,P=v),v.getDependencies&&v.getDependencies(this,i,function(t){return function(e){t.dependenciesLoaded=!0,f(_,t,e)}}(v)),v.needsPlacement||v.getDependencies||f(_,v)},n.prototype.redoPlacement=function(t,e,i){if("done"!==this.status)return this.redoPlacementAfterDone=!0,this.angle=t,{};for(var n=new a,r=[],s={},u=new o(t,e),l=this.bucketsInOrder,h=l.length-1;h>=0;h--){var c=l[h];"symbol"===c.type&&(c.placeFeatures(u,n,i),s[c.id]=c.elementGroups)}for(var f in n)r.push(n[f].array);return{result:{elementGroups:s,buffers:n},transferables:r}}},{"../data/buffer/buffer_set":2,"../data/create_bucket":13,"../data/feature_tree":15,"../symbol/collision_tile":68}],51:[function(t,e,i){function n(){this.n=0,this.times=[]}e.exports=n,n.prototype.stopped=function(){return this.times=this.times.filter(function(t){return t.time>=(new Date).getTime()}),!this.times.length},n.prototype.set=function(t){return this.times.push({id:this.n,time:t+(new Date).getTime()}),this.n++},n.prototype.cancel=function(t){this.times=this.times.filter(function(e){return e.id!==t})}},{}],52:[function(t,e,i){function n(t){this.base=t,this.retina=s.devicePixelRatio>1;var e=this.retina?"@2x":"";a.getJSON(u(t,e,".json"),function(t,e){return t?void this.fire("error",{error:t}):(this.data=e,void(this.img&&this.fire("load")))}.bind(this)),a.getImage(u(t,e,".png"),function(t,e){if(t)return void this.fire("error",{error:t});for(var i=e.getData(),n=e.data=new Uint8Array(i.length),r=0;r<i.length;r+=4){var o=i[r+3]/255;n[r+0]=i[r+0]*o,n[r+1]=i[r+1]*o,n[r+2]=i[r+2]*o,n[r+3]=i[r+3]}this.img=e,this.data&&this.fire("load")}.bind(this))}function r(){}var o=t("../util/evented"),a=t("../util/ajax"),s=t("../util/browser"),u=t("../util/mapbox").normalizeSpriteURL;e.exports=n,n.prototype=Object.create(o),n.prototype.toJSON=function(){return this.base},n.prototype.loaded=function(){return!(!this.data||!this.img)},n.prototype.resize=function(){if(s.devicePixelRatio>1!==this.retina){var t=new n(this.base);t.on("load",function(){this.img=t.img,this.data=t.data,this.retina=t.retina}.bind(this))}},r.prototype={x:0,y:0,width:0,height:0,pixelRatio:1,sdf:!1},n.prototype.getSpritePosition=function(t){if(!this.loaded())return new r;var e=this.data&&this.data[t];return e&&this.img?e:new r}},{"../util/ajax":94,"../util/browser":95,"../util/evented":100,"../util/mapbox":103}],53:[function(t,e,i){var n=t("./reference");e.exports={},n.layout.forEach(function(t){var i=function(t){for(var e in t)this[e]=t[e]},r=n[t];for(var o in r)void 0!==r[o].default&&(i.prototype[o]=r[o].default);e.exports[t.replace("layout_","")]=i})},{"./reference":55}],54:[function(t,e,i){var n=t("./reference"),r=t("csscolorparser").parseCSSColor;e.exports={},n.paint.forEach(function(t){var i=function(){},o=n[t];for(var a in o){var s=o[a],u=s.default;void 0!==u&&("color"===s.type&&(u=r(u)),i.prototype[a]=u)}i.prototype.hidden=!1,e.exports[t.replace("paint_","")]=i})},{"./reference":55,csscolorparser:107}],55:[function(t,e,i){e.exports=t("mapbox-gl-style-spec/reference/latest")},{"mapbox-gl-style-spec/reference/latest":131}],56:[function(t,e,i){function n(t,e){this.animationLoop=e||new v,this.dispatcher=new y(Math.max(m.hardwareConcurrency-1,1),this),this.glyphAtlas=new l(1024,1024),this.spriteAtlas=new h(512,512),this.spriteAtlas.resize(m.devicePixelRatio),this.lineAtlas=new c(256,512),this._layers={},this._order=[],this._groups=[],this.sources={},this.zoomHistory={},f.bindAll(["_forwardSourceEvent","_forwardTileEvent","_redoPlacement"],this);var i=function(t,e){if(t)return void this.fire("error",{error:t});var i=_(e);if(i.length)for(var n=0;n<i.length;n++)this.fire("error",{error:new Error(i[n].message)});else{this._loaded=!0,this.stylesheet=e;var r=e.sources;for(var o in r)this.addSource(o,r[o]);e.sprite&&(this.sprite=new s(e.sprite),this.sprite.on("load",this.fire.bind(this,"change"))),this.glyphSource=new u(e.glyphs,this.glyphAtlas),this._resolve(),this.fire("load")}}.bind(this);"string"==typeof t?d.getJSON(p(t),i):m.frame(i.bind(this,null,t))}var r=t("../util/evented"),o=t("./style_batch"),a=t("./style_layer"),s=t("./image_sprite"),u=t("../symbol/glyph_source"),l=t("../symbol/glyph_atlas"),h=t("../symbol/sprite_atlas"),c=t("../render/line_atlas"),f=t("../util/util"),d=t("../util/ajax"),p=t("../util/mapbox").normalizeStyleURL,m=t("../util/browser"),y=t("../util/dispatcher"),v=t("./animation_loop"),_=t("mapbox-gl-style-spec/lib/validate/latest");e.exports=n,n.prototype=f.inherit(r,{_loaded:!1,loaded:function(){if(!this._loaded)return!1;for(var t in this.sources)if(!this.sources[t].loaded())return!1;return!(this.sprite&&!this.sprite.loaded())},_resolve:function(){var t,e;this._layers={},this._order=[];for(var i=0;i<this.stylesheet.layers.length;i++)e=new a(this.stylesheet.layers[i]),this._layers[e.id]=e,this._order.push(e.id);for(t in this._layers)this._layers[t].resolveLayout();for(t in this._layers)this._layers[t].resolveReference(this._layers),this._layers[t].resolvePaint();this._groupLayers(),this._broadcastLayers()},_groupLayers:function(){var t;this._groups=[];for(var e=0;e<this._order.length;++e){var i=this._layers[this._order[e]];t&&i.source===t.source||(t=[],t.source=i.source,this._groups.push(t)),t.push(i)}},_broadcastLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e].json());this.dispatcher.broadcast("set layers",t)},_cascade:function(t,e){if(this._loaded){e=e||{transition:!0};for(var i in this._layers)this._layers[i].cascade(t,e,this.stylesheet.transition||{},this.animationLoop);this.fire("change")}},_recalculate:function(t){for(var e in this.sources)this.sources[e].used=!1;this._updateZoomHistory(t),this.rasterFadeDuration=300;for(e in this._layers){var i=this._layers[e];i.recalculate(t,this.zoomHistory)&&i.source&&(this.sources[i.source].used=!0)}Math.floor(this.z)!==Math.floor(t)&&this.animationLoop.set(300),this.z=t,this.fire("zoom")},_updateZoomHistory:function(t){var e=this.zoomHistory;void 0===e.lastIntegerZoom&&(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=0,e.lastZoom=t),Math.floor(e.lastZoom)<Math.floor(t)?(e.lastIntegerZoom=Math.floor(t),e.lastIntegerZoomTime=Date.now()):Math.floor(e.lastZoom)>Math.floor(t)&&(e.lastIntegerZoom=Math.floor(t+1),e.lastIntegerZoomTime=Date.now()),e.lastZoom=t},batch:function(t){o(this,t)},addSource:function(t,e){return this.batch(function(i){i.addSource(t,e)}),this},removeSource:function(t){return this.batch(function(e){e.removeSource(t)}),this},getSource:function(t){return this.sources[t]},addLayer:function(t,e){return this.batch(function(i){i.addLayer(t,e)}),this},removeLayer:function(t){return this.batch(function(e){e.removeLayer(t)}),this},getLayer:function(t){return this._layers[t]},getReferentLayer:function(t){var e=this.getLayer(t);return e.ref&&(e=this.getLayer(e.ref)),e},setFilter:function(t,e){return this.batch(function(i){i.setFilter(t,e)}),this},setLayerZoomRange:function(t,e,i){return this.batch(function(n){n.setLayerZoomRange(t,e,i)}),this},getFilter:function(t){return this.getReferentLayer(t).filter},getLayoutProperty:function(t,e){return this.getReferentLayer(t).getLayoutProperty(e)},getPaintProperty:function(t,e,i){return this.getLayer(t).getPaintProperty(e,i)},featuresAt:function(t,e,i){var n=[],r=null;e.layer&&(e.layerIds=Array.isArray(e.layer)?e.layer:[e.layer]),f.asyncEach(Object.keys(this.sources),function(i,o){this.sources[i].featuresAt(t,e,function(t,e){e&&(n=n.concat(e)),t&&(r=t),o()})}.bind(this),function(){return r?i(r):void i(null,n.filter(function(t){return void 0!==this._layers[t.layer]}.bind(this)).map(function(t){return t.layer=this._layers[t.layer].json(),t}.bind(this)))}.bind(this))},featuresIn:function(t,e,i){var n=[],r=null;e.layer&&(e.layer={id:e.layer}),f.asyncEach(Object.keys(this.sources),function(i,o){this.sources[i].featuresIn(t,e,function(t,e){e&&(n=n.concat(e)),t&&(r=t),o()})}.bind(this),function(){return r?i(r):void i(null,n.filter(function(t){return void 0!==this._layers[t.layer]}.bind(this)).map(function(t){return t.layer=this._layers[t.layer].json(),t}.bind(this)))}.bind(this))},_remove:function(){this.dispatcher.remove()},_reloadSource:function(t){this.sources[t].reload()},_updateSources:function(t){for(var e in this.sources)this.sources[e].update(t)},_redoPlacement:function(){for(var t in this.sources)this.sources[t].redoPlacement&&this.sources[t].redoPlacement()},_forwardSourceEvent:function(t){this.fire("source."+t.type,f.extend({source:t.target},t))},_forwardTileEvent:function(t){this.fire(t.type,f.extend({source:t.target},t))},"get sprite json":function(t,e){var i=this.sprite;i.loaded()?e(null,{sprite:i.data,retina:i.retina}):i.on("load",function(){e(null,{sprite:i.data,retina:i.retina})})},"get icons":function(t,e){var i=this.sprite,n=this.spriteAtlas;i.loaded()?(n.setSprite(i),n.addIcons(t.icons,e)):i.on("load",function(){n.setSprite(i),n.addIcons(t.icons,e)})},"get glyphs":function(t,e){this.glyphSource.getSimpleGlyphs(t.fontstack,t.codepoints,t.uid,e)}})},{"../render/line_atlas":36,"../symbol/glyph_atlas":70,"../symbol/glyph_source":71,"../symbol/sprite_atlas":77,"../util/ajax":94,"../util/browser":95,"../util/dispatcher":97,"../util/evented":100,"../util/mapbox":103,"../util/util":106,"./animation_loop":51,"./image_sprite":52,"./style_batch":57,"./style_layer":60,"mapbox-gl-style-spec/lib/validate/latest":129}],57:[function(t,e,i){function n(t,e){if(!t._loaded)throw new Error("Style is not done loading");var i=Object.create(n.prototype);i._style=t,i._groupLayers=!1,i._broadcastLayers=!1,i._reloadSources={},i._events=[],i._change=!1,e(i),i._groupLayers&&i._style._groupLayers(),i._broadcastLayers&&i._style._broadcastLayers(),Object.keys(i._reloadSources).forEach(function(t){i._style._reloadSource(t)}),i._events.forEach(function(t){i._style.fire.apply(i._style,t)}),i._change&&i._style.fire("change")}var r=t("../source/source"),o=t("./style_layer");n.prototype={addLayer:function(t,e){if(void 0!==this._style._layers[t.id])throw new Error("There is already a layer with this ID");return t instanceof o||(t=new o(t)),this._style._layers[t.id]=t,this._style._order.splice(e?this._style._order.indexOf(e):1/0,0,t.id),t.resolveLayout(),t.resolveReference(this._style._layers),t.resolvePaint(),this._groupLayers=!0,this._broadcastLayers=!0,t.source&&(this._reloadSources[t.source]=!0),this._events.push(["layer.add",{layer:t}]),this._change=!0,this},removeLayer:function(t){var e=this._style._layers[t];if(void 0===e)throw new Error("There is no layer with this ID");for(var i in this._style._layers)this._style._layers[i].ref===t&&this.removeLayer(i);return delete this._style._layers[t],this._style._order.splice(this._style._order.indexOf(t),1),this._groupLayers=!0,this._broadcastLayers=!0,this._events.push(["layer.remove",{layer:e}]),this._change=!0,this},setPaintProperty:function(t,e,i,n){return this._style.getLayer(t).setPaintProperty(e,i,n),this._change=!0,this},setLayoutProperty:function(t,e,i){return t=this._style.getReferentLayer(t),t.setLayoutProperty(e,i),this._broadcastLayers=!0,t.source&&(this._reloadSources[t.source]=!0),this._change=!0,this},setFilter:function(t,e){return t=this._style.getReferentLayer(t),t.filter=e,this._broadcastLayers=!0,t.source&&(this._reloadSources[t.source]=!0),this._change=!0,this},setLayerZoomRange:function(t,e,i){var n=this._style.getReferentLayer(t);return null!=e&&(n.minzoom=e),null!=i&&(n.maxzoom=i),this._broadcastLayers=!0,n.source&&(this._reloadSources[n.source]=!0),this._change=!0,this},addSource:function(t,e){if(!this._style._loaded)throw new Error("Style is not done loading");if(void 0!==this._style.sources[t])throw new Error("There is already a source with this ID");return e=r.create(e),this._style.sources[t]=e,e.id=t,e.style=this._style,e.dispatcher=this._style.dispatcher,e.glyphAtlas=this._style.glyphAtlas,e.on("load",this._style._forwardSourceEvent).on("error",this._style._forwardSourceEvent).on("change",this._style._forwardSourceEvent).on("tile.add",this._style._forwardTileEvent).on("tile.load",this._style._forwardTileEvent).on("tile.error",this._style._forwardTileEvent).on("tile.remove",this._style._forwardTileEvent).on("tile.stats",this._style._forwardTileEvent),this._events.push(["source.add",{source:e}]),this._change=!0,this},removeSource:function(t){if(void 0===this._style.sources[t])throw new Error("There is no source with this ID");var e=this._style.sources[t];return delete this._style.sources[t],e.off("load",this._style._forwardSourceEvent).off("error",this._style._forwardSourceEvent).off("change",this._style._forwardSourceEvent).off("tile.add",this._style._forwardTileEvent).off("tile.load",this._style._forwardTileEvent).off("tile.error",this._style._forwardTileEvent).off("tile.remove",this._style._forwardTileEvent).off("tile.stats",this._style._forwardTileEvent),this._events.push(["source.remove",{source:e}]),this._change=!0,this}},e.exports=n},{"../source/source":43,"./style_layer":60}],58:[function(t,e,i){function n(t,e){this.type=t.type,this.transitionable=t.transition,null==e&&(e=t.default),this.json=JSON.stringify(e),"color"===this.type?this.value=o(e):this.value=e,"interpolated"===t.function?this.calculate=u.interpolated(this.value):(this.calculate=u["piecewise-constant"](this.value),t.transition&&(this.calculate=r(this.calculate)))}function r(t){return function(e,i,n){var r,o,a,s=e%1,u=Math.min((Date.now()-i.lastIntegerZoomTime)/n,1),l=1;return e>i.lastIntegerZoom?(r=s+(1-s)*u,l*=2,o=t(e-1),a=t(e)):(r=1-(1-u)*s,a=t(e),o=t(e+1),l/=2),{from:o,fromScale:l,to:a,toScale:1,t:r}}}function o(t){if(h[t])return h[t];if(Array.isArray(t))return t;if(t.stops)return l.extend({},t,{stops:t.stops.map(function(t){return[t[0],o(t[1])]})});if("string"==typeof t){var e=a(s(t));return h[t]=e,e}throw new Error("Invalid color "+t)}function a(t){return[t[0]/255,t[1]/255,t[2]/255,t[3]/1]}var s=t("csscolorparser").parseCSSColor,u=t("mapbox-gl-function"),l=t("../util/util");e.exports=n;var h={}},{"../util/util":106,csscolorparser:107,"mapbox-gl-function":128}],59:[function(t,e,i){function n(t){function e(t){this._values={},this._transitions={};for(var e in t)this[e]=t[e]}return Object.keys(t).forEach(function(i){var n=t[i];Object.defineProperty(e.prototype,i,{set:function(t){this._values[i]=new a(n,t)},get:function(){return this._values[i].value}}),n.transition&&Object.defineProperty(e.prototype,i+"-transition",{set:function(t){this._transitions[i]=t},get:function(){return this._transitions[i]}})}),e.prototype.values=function(){return this._values},e.prototype.transition=function(t,e){var i=this._transitions[t]||{};return{duration:r.coalesce(i.duration,e.duration,300),delay:r.coalesce(i.delay,e.delay,0)}},e.prototype.json=function(){var t={};for(var e in this._values)t[e]=this._values[e].value;for(var i in this._transitions)t[i+"-transition"]=this._transitions[e];return t},e}var r=t("../util/util"),o=t("./reference"),a=t("./style_declaration"),s={paint:{},layout:{}};o.layer.type.values.forEach(function(t){s.paint[t]=n(o["paint_"+t]),s.layout[t]=n(o["layout_"+t])}),e.exports=function(t,e,i){return new s[t][e](i)}},{"../util/util":106,"./reference":55,"./style_declaration":58}],60:[function(t,e,i){function n(t){this._layer=t,this.id=t.id,this.ref=t.ref,this._resolved={},this._cascaded={},this.assign(t)}function r(t,e){var i=e+"-color",n=e+"-halo-color",r=e+"-outline-color",a=t[i],s=t[n],u=t[r],l=t[e+"-opacity"],h=a&&l*a[3],c=s&&l*s[3],f=u&&l*u[3];void 0!==h&&1>h&&(t[i]=o.premultiply([a[0],a[1],a[2],h])),void 0!==c&&1>c&&(t[n]=o.premultiply([s[0],s[1],s[2],c])),void 0!==f&&1>f&&(t[r]=o.premultiply([u[0],u[1],u[2],f]))}var o=t("../util/util"),a=t("./style_transition"),s=t("./style_declaration_set"),u=t("./layout_properties"),l=t("./paint_properties");e.exports=n,n.prototype={resolveLayout:function(){this.ref||(this.layout=new u[this.type](this._layer.layout),"line"===this.layout["symbol-placement"]&&(this.layout.hasOwnProperty("text-rotation-alignment")||(this.layout["text-rotation-alignment"]="map"),this.layout.hasOwnProperty("icon-rotation-alignment")||(this.layout["icon-rotation-alignment"]="map"),this.layout["symbol-avoid-edges"]=!0))},setLayoutProperty:function(t,e){null==e?delete this.layout[t]:this.layout[t]=e},getLayoutProperty:function(t){return this.layout[t]},resolveReference:function(t){this.ref&&this.assign(t[this.ref])},resolvePaint:function(){for(var t in this._layer){var e=t.match(/^paint(?:\.(.*))?$/);e&&(this._resolved[e[1]||""]=new s("paint",this.type,this._layer[t]))}},setPaintProperty:function(t,e,i){var n=this._resolved[i||""];n||(n=this._resolved[i||""]=new s("paint",this.type,{})),n[t]=e},getPaintProperty:function(t,e){var i=this._resolved[e||""];if(i)return i[t]},cascade:function(t,e,i,n){for(var r in this._resolved)if(""===r||t[r]){var o=this._resolved[r],u=o.values();for(var l in u){var h=u[l],c=e.transition?this._cascaded[l]:void 0;if(!c||c.declaration.json!==h.json){var f=o.transition(l,i),d=this._cascaded[l]=new a(h,c,f);d.instant()||(d.loopID=n.set(d.endTime-(new Date).getTime())),c&&n.cancel(c.loopID)}}}if("symbol"===this.type){var p=new s("layout",this.type,this.layout);this._cascaded["text-size"]=new a(p.values()["text-size"],void 0,i),this._cascaded["icon-size"]=new a(p.values()["icon-size"],void 0,i)}},recalculate:function(t,e){var i=this.type,n=this.paint=new l[i];for(var o in this._cascaded)n[o]=this._cascaded[o].at(t,e);if(this.hidden=this.minzoom&&t<this.minzoom||this.maxzoom&&t>=this.maxzoom||"none"===this.layout.visibility,"symbol"===i?0!==n["text-opacity"]&&this.layout["text-field"]||0!==n["icon-opacity"]&&this.layout["icon-image"]?(r(n,"text"),r(n,"icon")):this.hidden=!0:0===n[i+"-opacity"]?this.hidden=!0:r(n,i),this._cascaded["line-dasharray"]){var a=n["line-dasharray"],s=this._cascaded["line-width"]?this._cascaded["line-width"].at(Math.floor(t),1/0):n["line-width"];a.fromScale*=s,a.toScale*=s}return!this.hidden},assign:function(t){o.extend(this,o.pick(t,["type","source","source-layer","minzoom","maxzoom","filter","layout"]))},json:function(){return o.extend({},this._layer,o.pick(this,["type","source","source-layer","minzoom","maxzoom","filter","layout","paint"]))}}},{"../util/util":106,"./layout_properties":53,"./paint_properties":54,"./style_declaration_set":59,"./style_transition":61}],61:[function(t,e,i){function n(t,e,i){this.declaration=t,this.startTime=this.endTime=(new Date).getTime();var n=t.type;"string"!==n&&"array"!==n||!t.transitionable?this.interp=a[n]:this.interp=r,this.oldTransition=e,this.duration=i.duration||0,this.delay=i.delay||0,this.instant()||(this.endTime=this.startTime+this.duration+this.delay,this.ease=o.easeCubicInOut),e&&e.endTime<=this.startTime&&delete e.oldTransition}function r(t,e,i){return{from:t.to,fromScale:t.toScale,to:e.to,toScale:e.toScale,t:i}}var o=t("../util/util"),a=t("../util/interpolate");e.exports=n,n.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay},n.prototype.at=function(t,e,i){var n=this.declaration.calculate(t,e,this.duration);if(this.instant())return n;if((i=i||Date.now())<this.endTime){var r=this.oldTransition.at(t,e,this.startTime),o=this.ease((i-this.startTime-this.delay)/this.duration);n=this.interp(r,n,o)}return n}},{"../util/interpolate":102,"../util/util":106}],62:[function(t,e,i){function n(t,e,i,n){this.x=t,this.y=e,this.angle=i,void 0!==n&&(this.segment=n)}var r=t("point-geometry");e.exports=n,n.prototype=Object.create(r.prototype),n.prototype.clone=function(){return new n(this.x,this.y,this.angle,this.segment)}},{"point-geometry":137}],63:[function(t,e,i){function n(t,e){this.width=t,this.height=e,this.free=[{x:0,y:0,w:t,h:e}]}e.exports=n,n.prototype.release=function(t){for(var e=0;e<this.free.length;e++){var i=this.free[e];if(i.y===t.y&&i.h===t.h&&i.x+i.w===t.x)i.w+=t.w;else if(i.x===t.x&&i.w===t.w&&i.y+i.h===t.y)i.h+=t.h;else if(t.y===i.y&&t.h===i.h&&t.x+t.w===i.x)i.x=t.x,i.w+=t.w;else{if(t.x!==i.x||t.w!==i.w||t.y+t.h!==i.y)continue;i.y=t.y,i.h+=t.h}return this.free.splice(e,1),void this.release(i)}this.free.push(t)},n.prototype.allocate=function(t,e){for(var i={x:1/0,y:1/0,w:1/0,h:1/0},n=-1,r=0;r<this.free.length;r++){var o=this.free[r];t<=o.w&&e<=o.h&&o.y<=i.y&&o.x<=i.x&&(i=o,n=r)}return 0>n?{x:-1,y:-1}:(this.free.splice(n,1),i.w<i.h?(i.w>t&&this.free.push({x:i.x+t,y:i.y,w:i.w-t,h:e}),i.h>e&&this.free.push({x:i.x,y:i.y+e,w:i.w,h:i.h-e})):(i.w>t&&this.free.push({x:i.x+t,y:i.y,w:i.w-t,h:i.h}),i.h>e&&this.free.push({x:i.x,y:i.y+e,w:t,h:i.h-e})),{x:i.x,y:i.y,w:t,h:e})}},{}],64:[function(t,e,i){function n(t,e,i,n,r){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-i/2;){if(0>--a)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var u=[],l=0;i/2>s;){var h=t[a-1],c=t[a],f=t[a+1];if(!f)return!1;var d=h.angleTo(c)-c.angleTo(f);for(d=(d+3*Math.PI)%(2*Math.PI)-Math.PI,u.push({distance:s,angleDelta:d}),l+=d;s-u[0].distance>n;)l-=u.shift().angleDelta;if(Math.abs(l)>r)return!1;a++,s+=c.dist(f)}return!0}e.exports=n},{}],65:[function(t,e,i){function n(t,e,i,n,o){for(var a=[],s=0;s<t.length;s++)for(var u,l=t[s],h=0;h<l.length-1;h++){var c=l[h],f=l[h+1];c.x<e&&f.x<e||(c.x<e?c=new r(e,c.y+(f.y-c.y)*((e-c.x)/(f.x-c.x))):f.x<e&&(f=new r(e,c.y+(f.y-c.y)*((e-c.x)/(f.x-c.x)))),c.y<i&&f.y<i||(c.y<i?c=new r(c.x+(f.x-c.x)*((i-c.y)/(f.y-c.y)),i):f.y<i&&(f=new r(c.x+(f.x-c.x)*((i-c.y)/(f.y-c.y)),i)),
c.x>=n&&f.x>=n||(c.x>=n?c=new r(n,c.y+(f.y-c.y)*((n-c.x)/(f.x-c.x))):f.x>=n&&(f=new r(n,c.y+(f.y-c.y)*((n-c.x)/(f.x-c.x)))),c.y>=o&&f.y>=o||(c.y>=o?c=new r(c.x+(f.x-c.x)*((o-c.y)/(f.y-c.y)),o):f.y>=o&&(f=new r(c.x+(f.x-c.x)*((o-c.y)/(f.y-c.y)),o)),u&&c.equals(u[u.length-1])||(u=[c],a.push(u)),u.push(f)))))}return a}var r=t("point-geometry");e.exports=n},{"point-geometry":137}],66:[function(t,e,i){function n(t,e,i,n,r,o){this.anchorPoint=t,this.x1=e,this.y1=i,this.x2=n,this.y2=r,this.maxScale=o,this.placementScale=0,this[0]=this[1]=this[2]=this[3]=0}e.exports=n},{}],67:[function(t,e,i){function n(t,e,i,n,a,s){var u=i.top*n-a,l=i.bottom*n+a,h=i.left*n-a,c=i.right*n+a;if(this.boxes=[],s){var f=l-u,d=c-h;if(0>=f)return;f=Math.max(10*n,f),this._addLineCollisionBoxes(t,e,d,f)}else this.boxes.push(new r(new o(e.x,e.y),h,u,c,l,1/0))}var r=t("./collision_box"),o=t("point-geometry");e.exports=n,n.prototype._addLineCollisionBoxes=function(t,e,i,n){var o=n/2,a=Math.floor(i/o),s=-n/2,u=this.boxes,l=e,h=e.segment+1,c=s;do{if(0>--h)return u;c-=t[h].dist(l),l=t[h]}while(c>-i/2);for(var f=t[h].dist(t[h+1]),d=0;a>d;d++){for(var p=-i/2+d*o;p>c+f;){if(c+=f,++h+1>=t.length)return u;f=t[h].dist(t[h+1])}var m=p-c,y=t[h],v=t[h+1],_=v.sub(y)._unit()._mult(m)._add(y),g=Math.max(Math.abs(p-s)-o/2,0),x=i/2/g;u.push(new r(_,-n/2,-n/2,n/2,n/2,x))}return u}},{"./collision_box":66,"point-geometry":137}],68:[function(t,e,i){function n(t,e){this.tree=r(),this.angle=t;var i=Math.sin(t),n=Math.cos(t);this.rotationMatrix=[n,-i,i,n],this.yStretch=1/Math.cos(e/180*Math.PI),this.yStretch=Math.pow(this.yStretch,1.3)}var r=t("rbush");e.exports=n,n.prototype.minScale=.25,n.prototype.maxScale=2,n.prototype.placeCollisionFeature=function(t){for(var e=this.minScale,i=this.rotationMatrix,n=this.yStretch,r=0;r<t.boxes.length;r++){var o=t.boxes[r],a=o.anchorPoint.matMult(i),s=a.x,u=a.y;o[0]=s+o.x1,o[1]=u+o.y1*n,o[2]=s+o.x2,o[3]=u+o.y2*n;for(var l=this.tree.search(o),h=0;h<l.length;h++){var c=l[h],f=c.anchorPoint.matMult(i),d=(c.x1-o.x2)/(s-f.x),p=(c.x2-o.x1)/(s-f.x),m=(c.y1-o.y2)*n/(u-f.y),y=(c.y2-o.y1)*n/(u-f.y);(isNaN(d)||isNaN(p))&&(d=p=1),(isNaN(m)||isNaN(y))&&(m=y=1);var v=Math.min(Math.max(d,p),Math.max(m,y));if(v>c.maxScale&&(v=c.maxScale),v>o.maxScale&&(v=o.maxScale),v>e&&v>=c.placementScale&&(e=v),e>=this.maxScale)return e}}return e},n.prototype.insertCollisionFeature=function(t,e){for(var i=t.boxes,n=0;n<i.length;n++)i[n].placementScale=e;e<this.maxScale&&this.tree.load(i)}},{rbush:139}],69:[function(t,e,i){function n(t,e,i,n,o,a,s,u){var l=n?.6*a*s:0,h=Math.max(n?n.right-n.left:0,o?o.right-o.left:0);if(0===t[0].x||4096===t[0].x||0===t[0].y||4096===t[0].y)var c=!0;e/4>e-h*s&&(e=h*s+e/4);var f=2*a;return r(t,c?e/2*u%e:(h/2+f)*s*u%e,e,l,i,h*s,c,!1)}function r(t,e,i,n,u,l,h,c){for(var f=0,d=e-i,p=[],m=0;m<t.length-1;m++){for(var y=t[m],v=t[m+1],_=y.dist(v),g=v.angleTo(y);f+_>d+i;){d+=i;var x=(d-f)/_,b=o(y.x,v.x,x),w=o(y.y,v.y,x);if(b>=0&&4096>b&&w>=0&&4096>w){b=Math.round(b),w=Math.round(w);var M=new a(b,w,g,m);(!n||s(t,M,l,n,u))&&p.push(M)}}f+=_}return c||p.length||h||(p=r(t,f/2,i,n,u,l,h,!0)),p}var o=t("../util/interpolate"),a=t("../symbol/anchor"),s=t("./check_max_angle");e.exports=n},{"../symbol/anchor":62,"../util/interpolate":102,"./check_max_angle":64}],70:[function(t,e,i){function n(t,e){this.width=t,this.height=e,this.bin=new r(t,e),this.index={},this.ids={},this.data=new Uint8Array(t*e)}var r=t("./bin_pack");e.exports=n,n.prototype={get debug(){return"canvas"in this},set debug(t){t&&!this.canvas?(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")):!t&&this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),delete this.ctx,delete this.canvas)}},n.prototype.getGlyphs=function(){var t,e,i,n={};for(var r in this.ids)t=r.split("#"),e=t[0],i=t[1],n[e]||(n[e]=[]),n[e].push(i);return n},n.prototype.getRects=function(){var t,e,i,n={};for(var r in this.ids)t=r.split("#"),e=t[0],i=t[1],n[e]||(n[e]={}),n[e][i]=this.index[r];return n},n.prototype.removeGlyphs=function(t){for(var e in this.ids){var i=this.ids[e],n=i.indexOf(t);if(n>=0&&i.splice(n,1),this.ids[e]=i,!i.length){for(var r=this.index[e],o=this.data,a=0;a<r.h;a++)for(var s=this.width*(r.y+a)+r.x,u=0;u<r.w;u++)o[s+u]=0;this.dirty=!0,this.bin.release(r),delete this.index[e],delete this.ids[e]}}this.updateTexture(this.gl)},n.prototype.addGlyph=function(t,e,i,n){if(!i)return null;var r=e+"#"+i.id;if(this.index[r])return this.ids[r].indexOf(t)<0&&this.ids[r].push(t),this.index[r];if(!i.bitmap)return null;var o=i.width+2*n,a=i.height+2*n,s=o+2,u=a+2;s+=4-s%4,u+=4-u%4;var l=this.bin.allocate(s,u);if(l.x<0)return console.warn("glyph bitmap overflow"),{glyph:i,rect:null};this.index[r]=l,this.ids[r]=[t];for(var h=this.data,c=i.bitmap,f=0;a>f;f++)for(var d=this.width*(l.y+f+1)+l.x+1,p=o*f,m=0;o>m;m++)h[d+m]=c[p+m];return this.dirty=!0,l},n.prototype.bind=function(t){this.gl=t,this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,null))},n.prototype.updateTexture=function(t){if(this.bind(t),this.dirty){if(t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data),this.ctx){for(var e=this.ctx.getImageData(0,0,this.width,this.height),i=0,n=0;i<this.data.length;i++,n+=4)e.data[n]=this.data[i],e.data[n+1]=this.data[i],e.data[n+2]=this.data[i],e.data[n+3]=255;this.ctx.putImageData(e,0,0),this.ctx.strokeStyle="red";for(var r=0;r<this.bin.free.length;r++){var o=this.bin.free[r];this.ctx.strokeRect(o.x,o.y,o.w,o.h)}}this.dirty=!1}}},{"./bin_pack":63}],71:[function(t,e,i){function n(t,e){this.url=t&&a(t),this.glyphAtlas=e,this.stacks=[],this.loading={}}function r(t,e,i){this.advance=t.advance,this.left=t.left-i-1,this.top=t.top+i+1,this.rect=e}function o(t,e,i,n){return n=n||"abc",i.replace("{s}",n[t.length%n.length]).replace("{fontstack}",t).replace("{range}",e)}var a=t("../util/mapbox").normalizeGlyphsURL,s=t("../util/ajax").getArrayBuffer,u=t("../util/glyphs"),l=t("pbf");e.exports=n,n.prototype.getSimpleGlyphs=function(t,e,i,n){void 0===this.stacks[t]&&(this.stacks[t]={});for(var o,a={},s=this.stacks[t],u=this.glyphAtlas,l={},h=0,c=0;c<e.length;c++){var f=e[c];if(o=Math.floor(f/256),s[o]){var d=s[o].glyphs[f],p=u.addGlyph(i,t,d,3);d&&(a[f]=new r(d,p,3))}else void 0===l[o]&&(l[o]=[],h++),l[o].push(f)}h||n(void 0,a);var m=function(e,o,s){if(!e)for(var c=this.stacks[t][o]=s.stacks[0],f=0;f<l[o].length;f++){var d=l[o][f],p=c.glyphs[d],m=u.addGlyph(i,t,p,3);p&&(a[d]=new r(p,m,3))}--h||n(void 0,a)}.bind(this);for(var y in l)this.loadRange(t,y,m)},n.prototype.loadRange=function(t,e,i){if(256*e>65535)return i("gyphs > 65535 not supported");void 0===this.loading[t]&&(this.loading[t]={});var n=this.loading[t];if(n[e])n[e].push(i);else{n[e]=[i];var r=256*e+"-"+(256*e+255),a=o(t,r,this.url);s(a,function(t,i){for(var r=!t&&new u(new l(new Uint8Array(i))),o=0;o<n[e].length;o++)n[e][o](t,e,r);delete n[e]})}}},{"../util/ajax":94,"../util/glyphs":101,"../util/mapbox":103,pbf:136}],72:[function(t,e,i){e.exports=function(t,e,i){function n(n){h.push(t[n]),c.push(i[n]),f.push(e[n]),d++}function r(t,e,i){var n=l[t];return delete l[t],l[e]=n,c[n][0].pop(),c[n][0]=c[n][0].concat(i[0]),n}function o(t,e,i){var n=u[e];return delete u[e],u[t]=n,c[n][0].shift(),c[n][0]=i[0].concat(c[n][0]),n}function a(t,e,i){var n=i?e[0][e[0].length-1]:e[0][0];return t+":"+n.x+":"+n.y}var s,u={},l={},h=[],c=[],f=[],d=0;for(s=0;s<t.length;s++){var p=i[s],m=e[s];if(p)if(m){var y=a(m,p),v=a(m,p,!0);if(y in l&&v in u&&l[y]!==u[v]){var _=o(y,v,p),g=r(y,v,c[_]);delete u[y],delete l[v],l[a(m,c[g],!0)]=g,c[_]=null}else y in l?r(y,v,p):v in u?o(y,v,p):(n(s),u[y]=d-1,l[v]=d-1)}else n(s)}return{features:h,textFeatures:f,geometries:c}}},{}],73:[function(t,e,i){function n(t,e,i,n,r,o,a,s,u){this.anchorPoint=t,this.tl=e,this.tr=i,this.bl=n,this.br=r,this.tex=o,this.angle=a,this.minScale=s,this.maxScale=u}function r(t,e,i,r,o,a){var l=e.image.rect,h=e.left-1,c=h+l.w,f=e.top-1,d=f+l.h,p=new s(h,f),m=new s(c,f),y=new s(c,d),v=new s(h,d),_=o["icon-rotate"]*Math.PI/180;if(a){var g=r[t.segment];_+=Math.atan2(t.y-g.y,t.x-g.x)}if(_){var x=Math.sin(_),b=Math.cos(_),w=[b,-x,x,b];p=p.matMult(w),m=m.matMult(w),v=v.matMult(w),y=y.matMult(w)}return[new n(new s(t.x,t.y),p,m,v,y,e.image.rect,0,u,1/0)]}function o(t,e,i,r,o,l){for(var h=o["text-rotate"]*Math.PI/180,c=o["text-keep-upright"],f=e.positionedGlyphs,d=[],p=0;p<f.length;p++){var m=f[p],y=m.glyph,v=y.rect;if(v){var _,g=(m.x+y.advance/2)*i,x=u;l?(_=[],x=a(_,t,g,r,t.segment,!0),c&&(x=Math.min(x,a(_,t,g,r,t.segment,!1)))):_=[{anchorPoint:new s(t.x,t.y),offset:0,angle:0,maxScale:1/0,minScale:u}];for(var b=m.x+y.left,w=m.y-y.top,M=b+v.w,E=w+v.h,S=new s(b,w),T=new s(M,w),z=new s(b,E),L=new s(M,E),P=0;P<_.length;P++){var R=_[P],A=S,I=T,D=z,k=L,C=R.angle+h;if(C){var j=Math.sin(C),F=Math.cos(C),B=[F,-j,j,F];A=A.matMult(B),I=I.matMult(B),D=D.matMult(B),k=k.matMult(B)}var N=Math.max(R.minScale,x),O=(t.angle+h+R.offset+2*Math.PI)%(2*Math.PI);d.push(new n(R.anchorPoint,A,I,D,k,v,O,N,R.maxScale))}}}return d}function a(t,e,i,n,r,o){var a=!o;0>i&&(o=!o),o&&r++;var l=new s(e.x,e.y),h=n[r],c=1/0;i=Math.abs(i);for(var f=u;;){var d=l.dist(h),p=i/d,m=Math.atan2(h.y-l.y,h.x-l.x);if(o||(m+=Math.PI),a&&(m+=Math.PI),t.push({anchorPoint:l,offset:a?Math.PI:0,minScale:p,maxScale:c,angle:(m+2*Math.PI)%(2*Math.PI)}),f>=p)break;for(l=h;l.equals(h);)if(r+=o?1:-1,!(h=n[r]))return p;var y=h.sub(l)._unit();l=l.sub(y._mult(d)),c=p}return f}var s=t("point-geometry");e.exports={getIconQuads:r,getGlyphQuads:o};var u=.5},{"point-geometry":137}],74:[function(t,e,i){function n(t,e){for(var i=[],n=0,o=t.length;o>n;n++){var a=r(t[n].properties,e["icon-image"]);a&&i.indexOf(a)<0&&i.push(a)}return i}var r=t("../util/token");e.exports=n},{"../util/token":105}],75:[function(t,e,i){function n(t,e,i){for(var n=[],o=[],s=0,u=t.length;u>s;s++){var l=a(t[s].properties,e["text-field"]);if(l){l=l.toString();var h=e["text-transform"];"uppercase"===h?l=l.toLocaleUpperCase():"lowercase"===h&&(l=l.toLocaleLowerCase());for(var c=0,f=l.length;f>c;c++)o.push(l.charCodeAt(c));n[s]=l}else n[s]=null}return o=r(o,i),{textFeatures:n,codepoints:o}}function r(t,e){var i,n=[];t.sort(o);for(var r=0;r<t.length;r++)t[r]!==i&&(i=t[r],e[i]||n.push(t[r]));return n}function o(t,e){return t-e}var a=t("../util/token");e.exports=n},{"../util/token":105}],76:[function(t,e,i){function n(t,e,i,n){this.codePoint=t,this.x=e,this.y=i,this.glyph=n}function r(t,e,i,n,r,o){this.positionedGlyphs=t,this.text=e,this.top=i,this.bottom=n,this.left=r,this.right=o}function o(t,e,i,o,s,u,l,h,c){for(var f=[],d=new r(f,t,c[1],c[1],c[0],c[0]),p=c[0],m=c[1]+-17,y=0;y<t.length;y++){var v=t.charCodeAt(y),_=e[v];_&&(f.push(new n(v,p,m,_)),p+=_.advance+h)}return!!f.length&&(a(d,e,o,i,s,u,l),d)}function a(t,e,i,n,r,o,a){var l=null,h=0,f=0,d=0,p=0,m=t.positionedGlyphs;if(n)for(var y=0;y<m.length;y++){var v=m[y];if(v.x-=h,v.y+=i*d,v.x>n&&null!==l){var _=m[l+1].x;p=Math.max(_,p);for(var g=l+1;y>=g;g++)m[g].y+=i,m[g].x-=_;a&&s(m,e,f,l-1,a),f=l+1,l=null,h+=_,d++}c[v.codePoint]&&(l=y)}var x=m[m.length-1],b=x.x+e[x.codePoint].advance;p=Math.max(p,b);var w=(d+1)*i;s(m,e,f,m.length-1,a),u(m,a,r,o,p,i,d),t.top+=-o*w,t.bottom=t.top+w,t.left+=-r*p,t.right=t.left+p}function s(t,e,i,n,r){for(var o=e[t[n].codePoint].advance,a=(t[n].x+o)*r,s=i;n>=s;s++)t[s].x-=a}function u(t,e,i,n,r,o,a){for(var s=(e-i)*r,u=(-n*(a+1)+.5)*o,l=0;l<t.length;l++)t[l].x+=s,t[l].y+=u}function l(t,e){if(!t||!t.rect)return null;var i=e["icon-offset"][0],n=e["icon-offset"][1],r=i-t.width/2,o=r+t.width,a=n-t.height/2;return new h(t,a,a+t.height,r,o)}function h(t,e,i,n,r){this.image=t,this.top=e,this.bottom=i,this.left=n,this.right=r}e.exports={shapeText:o,shapeIcon:l};var c={32:!0}},{}],77:[function(t,e,i){function n(t,e){this.width=t,this.height=e,this.bin=new a(t,e),this.images={},this.data=!1,this.texture=0,this.filter=0,this.pixelRatio=1,this.dirty=!0}function r(t,e,i,n,r,o,a,s,u,l,h){var c,f,d=n*e+i,p=s*o+a;if(h)for(p-=o,f=-1;l>=f;f++,d=((f+l)%l+n)*e+i,p+=o)for(c=-1;u>=c;c++)r[p+c]=t[d+(c+u)%u];else for(f=0;l>f;f++,d+=e,p+=o)for(c=0;u>c;c++)r[p+c]=t[d+c]}function o(t,e,i,n){this.rect=t,this.width=e,this.height=i,this.sdf=n}var a=t("./bin_pack");e.exports=n,n.prototype={get debug(){return"canvas"in this},set debug(t){t&&!this.canvas?(this.canvas=document.createElement("canvas"),this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.canvas.style.width=this.width+"px",this.canvas.style.width=this.width+"px",document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")):!t&&this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),delete this.ctx,delete this.canvas)}},n.prototype.resize=function(t){if(this.pixelRatio===t)return!1;var e=this.pixelRatio;if(this.pixelRatio=t,this.canvas&&(this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio),this.data){var i=this.data;this.data=!1,this.allocate(),this.texture=!1;for(var n=this.width*e,r=this.height*e,o=this.width*t,a=this.height*t,s=this.data,u=i,l=0;a>l;l++)for(var h=Math.floor(l*r/a)*n,c=l*o,f=0;o>f;f++){var d=Math.floor(f*n/o);s[c+f]=u[h+d]}i=null,this.dirty=!0}return this.dirty},n.prototype.allocateImage=function(t,e){var i=t+2+(4-(t+2)%4),n=e+2+(4-(e+2)%4),r=this.bin.allocate(i,n);return 0===r.w?r:(r.originalWidth=t,r.originalHeight=e,r)},n.prototype.getImage=function(t,e){if(this.images[t])return this.images[t];if(!this.sprite)return null;var i=this.sprite.getSpritePosition(t);if(!i.width||!i.height)return null;var n=i.width/i.pixelRatio,r=i.height/i.pixelRatio,a=this.allocateImage(n,r);if(0===a.w)return a;var s=new o(a,n,r,i.sdf);return this.images[t]=s,this.copy(a,i,e),s},n.prototype.getPosition=function(t,e){var i=this.getImage(t,e),n=i&&i.rect;if(!n)return null;var r=e?i.width:n.w,o=e?i.height:n.h;return{size:[r,o],tl:[(n.x+1)/this.width,(n.y+1)/this.height],br:[(n.x+1+r)/this.width,(n.y+1+o)/this.height]}},n.prototype.allocate=function(){if(!this.data){var t=Math.floor(this.width*this.pixelRatio),e=Math.floor(this.height*this.pixelRatio);this.data=new Uint32Array(t*e);for(var i=0;i<this.data.length;i++)this.data[i]=0}},n.prototype.copy=function(t,e,i){if(this.sprite.img.data){var n=new Uint32Array(this.sprite.img.data.buffer);this.allocate();var o=this.data;r(n,this.sprite.img.width,e.x,e.y,o,this.width*this.pixelRatio,(t.x+1)*this.pixelRatio,(t.y+1)*this.pixelRatio,e.width,e.height,i),this.dirty=!0}},n.prototype.setSprite=function(t){this.sprite=t},n.prototype.addIcons=function(t,e){for(var i=0;i<t.length;i++)this.getImage(t[i]);e(null,this.images)},n.prototype.bind=function(t,e){var i=!1;this.texture?t.bindTexture(t.TEXTURE_2D,this.texture):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i=!0);var n=e?t.LINEAR:t.NEAREST;if(n!==this.filter&&(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n),this.filter=n),this.dirty&&(this.allocate(),i?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width*this.pixelRatio,this.height*this.pixelRatio,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width*this.pixelRatio,this.height*this.pixelRatio,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),this.dirty=!1,this.ctx)){var r=this.ctx.getImageData(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio);r.data.set(new Uint8ClampedArray(this.data.buffer)),this.ctx.putImageData(r,0,0),this.ctx.strokeStyle="red";for(var o=0;o<this.bin.free.length;o++){var a=this.bin.free[o];this.ctx.strokeRect(a.x*this.pixelRatio,a.y*this.pixelRatio,a.w*this.pixelRatio,a.h*this.pixelRatio)}}}},{"./bin_pack":63}],78:[function(t,e,i){var n=t("../util/util"),r=t("../util/interpolate"),o=t("../util/browser"),a=t("../geo/lng_lat"),s=t("../geo/lng_lat_bounds"),u=t("point-geometry"),l=e.exports=function(){};n.extend(l.prototype,{getCenter:function(){return this.transform.center},setCenter:function(t){return this.jumpTo({center:t}),this},panBy:function(t,e){return this.panTo(this.transform.center,n.extend({offset:u.convert(t).mult(-1)},e)),this},panTo:function(t,e){this.stop(),t=a.convert(t),e=n.extend({duration:500,easing:n.ease,offset:[0,0]},e);var i=this.transform,r=u.convert(e.offset).rotate(-i.angle),o=i.point,s=i.project(t).sub(r);return e.noMoveStart||this.fire("movestart"),this._ease(function(t){i.center=i.unproject(o.add(s.sub(o).mult(t))),this.fire("move")},function(){this.fire("moveend")},e),this},getZoom:function(){return this.transform.zoom},setZoom:function(t){return this.jumpTo({zoom:t}),this},zoomTo:function(t,e){this.stop(),e=n.extend({duration:500},e),e.easing=this._updateEasing(e.duration,t,e.easing);var i=this.transform,o=i.center,s=i.zoom;return e.around?o=a.convert(e.around):e.offset&&(o=i.pointLocation(i.centerPoint.add(u.convert(e.offset)))),!1===e.animate&&(e.duration=0),this.zooming||(this.zooming=!0,this.fire("movestart")),this._ease(function(e){i.setZoomAround(r(s,t,e),o),this.fire("move").fire("zoom")},function(){this.ease=null,e.duration>=200&&(this.zooming=!1,this.fire("moveend"))},e),e.duration<200&&(clearTimeout(this._onZoomEnd),this._onZoomEnd=setTimeout(function(){this.zooming=!1,this.fire("moveend")}.bind(this),200)),this},zoomIn:function(t){return this.zoomTo(this.getZoom()+1,t),this},zoomOut:function(t){return this.zoomTo(this.getZoom()-1,t),this},getBearing:function(){return this.transform.bearing},setBearing:function(t){return this.jumpTo({bearing:t}),this},rotateTo:function(t,e){this.stop(),e=n.extend({duration:500,easing:n.ease},e);var i=this.transform,o=this.getBearing(),s=i.center;return e.around?s=a.convert(e.around):e.offset&&(s=i.pointLocation(i.centerPoint.add(u.convert(e.offset)))),t=this._normalizeBearing(t,o),this.rotating=!0,this.fire("movestart"),this._ease(function(e){i.setBearingAround(r(o,t,e),s),this.fire("move").fire("rotate")},function(){this.rotating=!1,this.fire("moveend")},e),this},resetNorth:function(t){return this.rotateTo(0,n.extend({duration:1e3},t)),this},snapToNorth:function(t){return Math.abs(this.getBearing())<this.options.bearingSnap?this.resetNorth(t):this},getPitch:function(){return this.transform.pitch},setPitch:function(t){return this.jumpTo({pitch:t}),this},fitBounds:function(t,e){e=n.extend({padding:0,offset:[0,0],maxZoom:1/0},e),t=s.convert(t);var i=u.convert(e.offset),r=this.transform,o=r.project(t.getNorthWest()),a=r.project(t.getSouthEast()),l=a.sub(o),h=(r.width-2*e.padding-2*Math.abs(i.x))/l.x,c=(r.height-2*e.padding-2*Math.abs(i.y))/l.y;return e.center=r.unproject(o.add(a).div(2)),e.zoom=Math.min(r.scaleZoom(r.scale*Math.min(h,c)),e.maxZoom),e.bearing=0,e.linear?this.easeTo(e):this.flyTo(e)},jumpTo:function(t){this.stop();var e=this.transform,i=!1,n=!1,r=!1;return"center"in t&&(e.center=a.convert(t.center)),"zoom"in t&&e.zoom!==+t.zoom&&(i=!0,e.zoom=+t.zoom),"bearing"in t&&e.bearing!==+t.bearing&&(n=!0,e.bearing=+t.bearing),"pitch"in t&&e.pitch!==+t.pitch&&(r=!0,e.pitch=+t.pitch),this.fire("movestart").fire("move"),i&&this.fire("zoom"),n&&this.fire("rotate"),r&&this.fire("pitch"),this.fire("moveend")},easeTo:function(t){this.stop(),t=n.extend({offset:[0,0],duration:500,easing:n.ease},t);var e=this.transform,i=u.convert(t.offset).rotate(-e.angle),o=e.point,s=this.getZoom(),l=this.getBearing(),h=this.getPitch(),c="zoom"in t?+t.zoom:s,f="bearing"in t?this._normalizeBearing(t.bearing,l):l,d="pitch"in t?+t.pitch:h,p=e.zoomScale(c-s),m="center"in t?e.project(a.convert(t.center)).sub(i.div(p)):o,y=a.convert(t.around);return c!==s&&(this.zooming=!0),l!==f&&(this.rotating=!0),this.zooming&&!y&&(y=e.pointLocation(e.centerPoint.add(m.sub(o).div(1-1/p)))),this.fire("movestart"),this._ease(function(t){this.zooming?e.setZoomAround(r(s,c,t),y):e.center=e.unproject(o.add(m.sub(o).mult(t))),this.rotating&&(e.bearing=r(l,f,t)),d!==h&&(e.pitch=r(h,d,t)),this.fire("move"),this.zooming&&this.fire("zoom"),this.rotating&&this.fire("rotate")},function(){this.zooming=!1,this.rotating=!1,this.fire("moveend")},t),this},flyTo:function(t){function e(t){var e=(M*M-w*w+(t?-1:1)*S*S*E*E)/(2*(t?M:w)*S*E);return Math.log(Math.sqrt(e*e+1)-e)}function i(t){return(Math.exp(t)-Math.exp(-t))/2}function o(t){return(Math.exp(t)+Math.exp(-t))/2}function s(t){return i(t)/o(t)}this.stop(),t=n.extend({offset:[0,0],speed:1.2,curve:1.42,easing:n.ease},t);var l=this.transform,h=u.convert(t.offset),c=this.getZoom(),f=this.getBearing(),d="center"in t?a.convert(t.center):this.getCenter(),p="zoom"in t?+t.zoom:c,m="bearing"in t?this._normalizeBearing(t.bearing,f):f,y=l.zoomScale(p-c),v=l.point,_=l.project(d).sub(h.div(y)),g=l.worldSize,x=t.curve,b=t.speed,w=Math.max(l.width,l.height),M=w/y,E=_.sub(v).mag(),S=x*x,T=e(0),z=function(t){return o(T)/o(T+x*t)},L=function(t){return w*((o(T)*s(T+x*t)-i(T))/S)/E},P=(e(1)-T)/x;if(Math.abs(E)<1e-6){if(Math.abs(w-M)<1e-6)return this;var R=w>M?-1:1;P=Math.abs(Math.log(M/w))/x,L=function(){return 0},z=function(t){return Math.exp(R*x*t)}}return t.duration=1e3*P/b,this.zooming=!0,f!==m&&(this.rotating=!0),this.fire("movestart"),this._ease(function(t){var e=t*P,i=L(e);l.zoom=c+l.scaleZoom(1/z(e)),l.center=l.unproject(v.add(_.sub(v).mult(i)),g),m!==f&&(l.bearing=r(f,m,t)),this.fire("move").fire("zoom"),m!==f&&this.fire("rotate")},function(){this.zooming=!1,this.rotating=!1,this.fire("moveend")},t),this},isEasing:function(){return!!this._abortFn},stop:function(){return this._abortFn&&(this._abortFn(),this._finishEase()),this},_ease:function(t,e,i){this._finishFn=e,this._abortFn=o.timed(function(e){t.call(this,i.easing(e)),1===e&&this._finishEase()},!1===i.animate?0:i.duration,this)},_finishEase:function(){delete this._abortFn;var t=this._finishFn;delete this._finishFn,t.call(this)},_normalizeBearing:function(t,e){t=n.wrap(t,-180,180);var i=Math.abs(t-e);return Math.abs(t-360-e)<i&&(t-=360),Math.abs(t+360-e)<i&&(t+=360),t},_updateEasing:function(t,e,i){var r;if(this.ease){var o=this.ease,a=(Date.now()-o.start)/o.duration,s=o.easing(a+.01)-o.easing(a),u=.27/Math.sqrt(s*s+1e-4)*.01,l=Math.sqrt(.0729-u*u);r=n.bezier(u,l,.25,1)}else r=i?n.bezier.apply(n,i):n.ease;return this.ease={start:(new Date).getTime(),to:Math.pow(2,e),duration:t,easing:r},r}})},{"../geo/lng_lat":20,"../geo/lng_lat_bounds":21,"../util/browser":95,"../util/interpolate":102,"../util/util":106,"point-geometry":137}],79:[function(t,e,i){function n(){}var r=t("./control"),o=t("../../util/dom"),a=t("../../util/util");e.exports=n,n.prototype=a.inherit(r,{options:{position:"bottom-right"},onAdd:function(t){var e=this._container=o.create("div","mapboxgl-ctrl-attrib",t.getContainer());return this._update(),t.on("source.load",this._update.bind(this)),t.on("source.change",this._update.bind(this)),t.on("source.remove",this._update.bind(this)),t.on("moveend",this._updateEditLink.bind(this)),e},_update:function(){var t=[];if(this._map.style)for(var e in this._map.style.sources){var i=this._map.style.sources[e];i.attribution&&t.indexOf(i.attribution)<0&&t.push(i.attribution)}this._container.innerHTML=t.join(" | "),this._editLink=this._container.getElementsByClassName("mapbox-improve-map")[0],this._updateEditLink()},_updateEditLink:function(){if(this._editLink){var t=this._map.getCenter();this._editLink.href="https://www.mapbox.com/map-feedback/#/"+t.lng+"/"+t.lat+"/"+Math.round(this._map.getZoom()+1)}}})},{"../../util/dom":98,"../../util/util":106,"./control":80}],80:[function(t,e,i){function n(){}e.exports=n,n.prototype={addTo:function(t){this._map=t;var e=this._container=this.onAdd(t);if(this.options&&this.options.position){var i=this.options.position,n=t._controlCorners[i];e.className+=" mapboxgl-ctrl",-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e)}return this},remove:function(){return this._container.parentNode.removeChild(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this}}},{}],81:[function(t,e,i){function n(t){a.setOptions(this,t)}var r=t("./control"),o=t("../../util/dom"),a=t("../../util/util");e.exports=n,n.prototype=a.inherit(r,{options:{position:"top-right"},onAdd:function(t){var e="mapboxgl-ctrl",i=this._container=o.create("div",e+"-group",t.getContainer());this._zoomInButton=this._createButton(e+"-icon "+e+"-zoom-in",t.zoomIn.bind(t)),this._zoomOutButton=this._createButton(e+"-icon "+e+"-zoom-out",t.zoomOut.bind(t)),this._compass=this._createButton(e+"-compass",t.resetNorth.bind(t));var n=this._compassCanvas=o.create("canvas",e+"-compass-canvas",this._compass);return n.style.cssText="width:30px; height:30px;",n.width=52,n.height=52,this._compass.addEventListener("mousedown",this._onCompassDown.bind(this)),this._onCompassMove=this._onCompassMove.bind(this),this._onCompassUp=this._onCompassUp.bind(this),this._compassCtx=n.getContext("2d"),t.on("rotate",this._drawNorth.bind(this)),this._drawNorth(),i},_onCompassDown:function(t){o.disableDrag(),document.addEventListener("mousemove",this._onCompassMove),document.addEventListener("mouseup",this._onCompassUp),this._prevX=t.screenX,t.stopPropagation()},_onCompassMove:function(t){var e=t.screenX,i=2>e?-5:e>window.screen.width-2?5:(e-this._prevX)/4;this._map.setBearing(this._map.getBearing()-i),this._prevX=t.screenX,this._moved=!0,t.preventDefault()},_onCompassUp:function(){document.removeEventListener("mousemove",this._onCompassMove),document.removeEventListener("mouseup",this._onCompassUp),o.enableDrag(),this._moved&&(this._moved=!1,o.suppressClick()),this._map.snapToNorth()},_createButton:function(t,e){var i=o.create("button",t,this._container);return i.addEventListener("click",function(){e()}),i},_drawNorth:function(){var t=this._map.transform.angle+Math.PI/2,e=this._compassCtx;this._compassCanvas.width=this._compassCanvas.width,e.translate(26,26),e.rotate(t),e.beginPath(),e.fillStyle="#000",e.lineTo(0,-8),e.lineTo(-20,0),e.lineTo(0,8),e.fill(),e.beginPath(),e.fillStyle="#bbb",e.moveTo(0,0),e.lineTo(0,8),e.lineTo(20,0),e.lineTo(0,-8),e.fill(),e.beginPath(),e.strokeStyle="#fff",e.lineWidth=4,e.moveTo(0,-8),e.lineTo(0,8),e.stroke()}})},{"../../util/dom":98,"../../util/util":106,"./control":80}],82:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),a.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../geo/lng_lat_bounds"),a=t("../../util/util");e.exports=n,n.prototype={enable:function(){this._el.addEventListener("mousedown",this._onMouseDown,!1)},disable:function(){this._el.removeEventListener("mousedown",this._onMouseDown)},_onMouseDown:function(t){(t.shiftKey||1===t.which&&1===t.button)&&(document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("keydown",this._onKeyDown,!1),document.addEventListener("mouseup",this._onMouseUp,!1),this._startPos=r.mousePos(this._el,t),this.active=!0)},_onMouseMove:function(t){var e=this._startPos,i=r.mousePos(this._el,t);this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),r.disableDrag(),this._map.fire("boxzoomstart"));var n=Math.min(e.x,i.x),o=Math.max(e.x,i.x),a=Math.min(e.y,i.y),s=Math.max(e.y,i.y);r.setTransform(this._box,"translate("+n+"px,"+a+"px)"),this._box.style.width=o-n+"px",this._box.style.height=s-a+"px"},_onMouseUp:function(t){var e=this._startPos,i=r.mousePos(this._el,t),n=new o(this._map.unproject(e),this._map.unproject(i));this._finish(),this._map.fitBounds(n,{linear:!0}).fire("boxzoomend",{boxZoomBounds:n})},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._map.fire("boxzoomcancel"))},_finish:function(){this._box&&(this.active=!1,document.removeEventListener("mousemove",this._onMouseMove,!1),document.removeEventListener("keydown",this._onKeyDown,!1),document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box.parentNode.removeChild(this._box),this._box=null,r.enableDrag())}}},{"../../geo/lng_lat_bounds":21,"../../util/dom":98,"../../util/util":106}],83:[function(t,e,i){function n(t){this._map=t,this._onDblClick=this._onDblClick.bind(this)}e.exports=n,n.prototype={enable:function(){this._map.on("dblclick",this._onDblClick)},disable:function(){this._map.off("dblclick",this._onDblClick)},_onDblClick:function(t){this._map.zoomTo(Math.round(this._map.getZoom())+1,{around:t.lngLat})}}},{}],84:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),o.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../util/util");e.exports=n;var a=o.bezier(0,0,.25,1);n.prototype={enable:function(){this._el.addEventListener("mousedown",this._onDown,!1),this._el.addEventListener("touchstart",this._onDown,!1)},disable:function(){this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown)},_onDown:function(t){this._startPos=this._pos=r.mousePos(this._el,t),this._inertia=[[Date.now(),this._pos]],t.touches?1===t.touches.length&&(document.addEventListener("touchmove",this._onMove,!1),document.addEventListener("touchend",this._onTouchEnd,!1)):(document.addEventListener("mousemove",this._onMove,!1),document.addEventListener("mouseup",this._onMouseUp,!1))},_onMove:function(t){var e=this._map;if(!(e.boxZoom.active||e.dragRotate.active||t.touches&&t.touches.length>1)){this.active=!0;var i=r.mousePos(this._el,t),n=this._inertia,o=Date.now();for(n.push([o,i]);n.length>2&&o-n[0][0]>50;)n.shift();e.stop(),e.transform.setLocationAtPoint(e.transform.pointLocation(this._pos),i),e.fire("move"),this._pos=i,t.preventDefault()}},_onUp:function(){var t=this._inertia;if(t.length<2)return void this._map.fire("moveend");var e=t[t.length-1],i=t[0],n=e[1].sub(i[1]),r=(e[0]-i[0])/1e3,o=n.mult(.25/r),s=o.mag();s>3e3&&(s=3e3,o._unit()._mult(s));var u=s/1e3,l=o.mult(-u/2);this._map.panBy(l,{duration:1e3*u,easing:a,noMoveStart:!0}),this.active=!1},_onMouseUp:function(){this._onUp(),document.removeEventListener("mousemove",this._onMove,!1),document.removeEventListener("mouseup",this._onMouseUp,!1)},_onTouchEnd:function(){this._onUp(),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd)}}},{"../../util/dom":98,"../../util/util":106}],85:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),a.bindHandlers(this)}var r=t("../../util/dom"),o=t("point-geometry"),a=t("../../util/util");e.exports=n,n.prototype={enable:function(){this._el.addEventListener("contextmenu",this._onContextMenu,!1)},disable:function(){this._el.removeEventListener("contextmenu",this._onContextMenu)},_onContextMenu:function(t){this._map.stop(),this._startPos=this._pos=r.mousePos(this._el,t),document.addEventListener("mousemove",this._onMouseMove,!1),document.addEventListener("mouseup",this._onMouseUp,!1),t.preventDefault()},_onMouseMove:function(t){var e=this._startPos,i=this._pos,n=r.mousePos(this._el,t),a=this._map,s=a.transform.centerPoint,u=e.sub(s),l=u.mag();this.active=!0,a.rotating||(a.fire("movestart"),a.rotating=!0),200>l&&(s=e.add(new o(-200,0)._rotate(u.angle())));var h=i.sub(s).angleWith(n.sub(s))/Math.PI*180;a.transform.bearing=a.getBearing()-h,a.fire("move").fire("rotate"),clearTimeout(this._timeout),this._timeout=setTimeout(this._onTimeout,200),this._pos=n},_onTimeout:function(){var t=this._map;t.rotating=!1,t.snapToNorth(),t.rotating||(t._rerender(),t.fire("moveend"))},_onMouseUp:function(){this.active=!1,
document.removeEventListener("mousemove",this._onMouseMove,!1),document.removeEventListener("mouseup",this._onMouseUp,!1)}}},{"../../util/dom":98,"../../util/util":106,"point-geometry":137}],86:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),this._onKeyDown=this._onKeyDown.bind(this)}e.exports=n;n.prototype={enable:function(){this._el.addEventListener("keydown",this._onKeyDown,!1)},disable:function(){this._el.removeEventListener("keydown",this._onKeyDown)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=this._map;switch(t.keyCode){case 61:case 107:case 171:case 187:e.zoomTo(Math.round(e.getZoom())+(t.shiftKey?2:1));break;case 189:case 109:case 173:e.zoomTo(Math.round(e.getZoom())-(t.shiftKey?2:1));break;case 37:t.shiftKey?e.setBearing(e.getBearing()-2):e.panBy([-80,0]);break;case 39:t.shiftKey?e.setBearing(e.getBearing()+2):e.panBy([80,0]);break;case 38:e.panBy([0,-80]);break;case 40:e.panBy([0,80])}}}}},{}],87:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),o.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../util/util");e.exports=n,n.prototype={enable:function(){this._el.addEventListener("touchstart",this._onStart,!1)},disable:function(){this._el.removeEventListener("touchstart",this._onStart)},_onStart:function(t){if(2===t.touches.length){var e=r.mousePos(this._el,t.touches[0]),i=r.mousePos(this._el,t.touches[1]);this._startVec=e.sub(i),this._startScale=this._map.transform.scale,this._startBearing=this._map.transform.bearing,document.addEventListener("touchmove",this._onMove,!1),document.addEventListener("touchend",this._onEnd,!1)}},_onMove:function(t){if(2===t.touches.length){var e=r.mousePos(this._el,t.touches[0]),i=r.mousePos(this._el,t.touches[1]),n=e.add(i).div(2),o=e.sub(i),a=o.mag()/this._startVec.mag(),s=180*o.angleWith(this._startVec)/Math.PI,u=this._map;u.easeTo({zoom:u.transform.scaleZoom(this._startScale*a),bearing:this._startBearing+s,duration:0,around:u.unproject(n)}),t.preventDefault()}},_onEnd:function(){this._map.snapToNorth(),document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onEnd)}}},{"../../util/dom":98,"../../util/util":106}],88:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer(),a.bindHandlers(this)}var r=t("../../util/dom"),o=t("../../util/browser"),a=t("../../util/util");e.exports=n;var s="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",u=-1!==s.indexOf("firefox"),l=-1!==s.indexOf("safari")&&-1===s.indexOf("chrom");n.prototype={enable:function(){this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1)},disable:function(){this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel)},_onWheel:function(t){var e;"wheel"===t.type?(e=t.deltaY,u&&t.deltaMode===window.WheelEvent.DOM_DELTA_PIXEL&&(e/=o.devicePixelRatio),t.deltaMode===window.WheelEvent.DOM_DELTA_LINE&&(e*=40)):"mousewheel"===t.type&&(e=-t.wheelDeltaY,l&&(e/=3));var i=(window.performance||Date).now(),n=i-(this._time||0);this._pos=r.mousePos(this._el,t),this._time=i,0!==e&&e%4.000244140625==0?(this._type="wheel",e=Math.floor(e/4)):0!==e&&Math.abs(e)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=Math.abs(n*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&this._zoom(-e),t.preventDefault()},_onTimeout:function(){this._type="wheel",this._zoom(-this._lastValue)},_zoom:function(t){var e=this._map,i=2/(1+Math.exp(-Math.abs(t/100)));0>t&&0!==i&&(i=1/i);var n=e.ease?e.ease.to:e.transform.scale,r=e.transform.scaleZoom(n*i);e.zoomTo(r,{duration:0,around:e.unproject(this._pos)})}}},{"../../util/browser":95,"../../util/dom":98,"../../util/util":106}],89:[function(t,e,i){function n(){r.bindAll(["_onHashChange","_updateHash"],this)}e.exports=n;var r=t("../util/util");n.prototype={addTo:function(t){return this._map=t,window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},remove:function(){return window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},_onHashChange:function(){var t=location.hash.replace("#","").split("/");return t.length>=3&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0)}),!0)},_updateHash:function(){var t=this._map.getCenter(),e=this._map.getZoom(),i=this._map.getBearing(),n=Math.max(0,Math.ceil(Math.log(e)/Math.LN2)),r="#"+Math.round(100*e)/100+"/"+t.lat.toFixed(n)+"/"+t.lng.toFixed(n)+(i?"/"+Math.round(10*i)/10:"");window.history.replaceState("","",r)}}},{"../util/util":106}],90:[function(t,e,i){function n(t){this._map=t,this._el=t.getCanvasContainer();for(var e in r)t[e]=new r[e](t);a.bindHandlers(this)}var r={scrollZoom:t("./handler/scroll_zoom"),boxZoom:t("./handler/box_zoom"),dragRotate:t("./handler/drag_rotate"),dragPan:t("./handler/drag_pan"),keyboard:t("./handler/keyboard"),doubleClickZoom:t("./handler/dblclick_zoom"),pinch:t("./handler/pinch")},o=t("../util/dom"),a=t("../util/util");e.exports=n,n.prototype={enable:function(){var t=this._map.options,e=this._el;for(var i in r)t[i]&&this._map[i].enable();e.addEventListener("mousedown",this._onMouseDown,!1),e.addEventListener("mouseup",this._onMouseUp,!1),e.addEventListener("touchstart",this._onTouchStart,!1),e.addEventListener("click",this._onClick,!1),e.addEventListener("mousemove",this._onMouseMove,!1),e.addEventListener("dblclick",this._onDblClick,!1),e.addEventListener("contextmenu",this._onContextMenu,!1)},disable:function(){var t=this._map.options,e=this._el;for(var i in r)t[i]&&this._map[i].disable();e.removeEventListener("mousedown",this._onMouseDown),e.removeEventListener("mouseup",this._onMouseUp),e.removeEventListener("touchstart",this._onTouchStart),e.removeEventListener("click",this._onClick),e.removeEventListener("mousemove",this._onMouseMove),e.removeEventListener("dblclick",this._onDblClick),e.removeEventListener("contextmenu",this._onContextMenu)},_onMouseDown:function(t){this._startPos=o.mousePos(this._el,t)},_onMouseUp:function(t){!this._contextMenuFired||this._map.dragRotate.active||this._map.dragPan.active||this._fireEvent("contextmenu",t),this._contextMenuFired=null},_onTouchStart:function(t){!t.touches||t.touches.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._fireEvent("dblclick",t)):this._tapped=setTimeout(this._onTimeout,300))},_onTimeout:function(){this._tapped=null},_onMouseMove:function(t){var e=this._map,i=this._el;if(!e.dragPan.active&&!e.dragRotate.active){for(var n=t.toElement||t.target;n&&n!==i;)n=n.parentNode;n===i&&this._fireEvent("mousemove",t)}},_onClick:function(t){o.mousePos(this._el,t).equals(this._startPos)&&this._fireEvent("click",t)},_onDblClick:function(t){this._fireEvent("dblclick",t),t.preventDefault()},_onContextMenu:function(){this._contextMenuFired=!0},_fireEvent:function(t,e){var i=o.mousePos(this._el,e);this._map.fire(t,{lngLat:this._map.unproject(i),point:i,originalEvent:e})}}},{"../util/dom":98,"../util/util":106,"./handler/box_zoom":82,"./handler/dblclick_zoom":83,"./handler/drag_pan":84,"./handler/drag_rotate":85,"./handler/keyboard":86,"./handler/pinch":87,"./handler/scroll_zoom":88}],91:[function(t,e,i){var n=t("../util/canvas"),r=t("../util/util"),o=t("../util/browser"),a=t("../util/evented"),s=t("../util/dom"),u=t("../style/style"),l=t("../style/animation_loop"),h=t("../render/painter"),c=t("../geo/transform"),f=t("./hash"),d=t("./interaction"),p=t("./camera"),m=t("../geo/lng_lat"),y=t("../geo/lng_lat_bounds"),v=t("point-geometry"),_=t("./control/attribution"),g=e.exports=function(t){if(t=this.options=r.inherit(this.options,t),this.animationLoop=new l,this.transform=new c(t.minZoom,t.maxZoom),t.maxBounds){var e=y.convert(t.maxBounds);this.transform.lngRange=[e.getWest(),e.getEast()],this.transform.latRange=[e.getSouth(),e.getNorth()]}r.bindAll(["_forwardStyleEvent","_forwardSourceEvent","_forwardLayerEvent","_forwardTileEvent","_onStyleLoad","_onStyleChange","_onSourceAdd","_onSourceRemove","_onSourceUpdate","_onWindowResize","onError","update","render"],this),this._setupContainer(),this._setupPainter(),this.on("move",this.update),this.on("zoom",this.update.bind(this,!0)),this.on("moveend",function(){this.animationLoop.set(300),this._rerender()}.bind(this)),"undefined"!=typeof window&&window.addEventListener("resize",this._onWindowResize,!1),this.interaction=new d(this),t.interactive&&this.interaction.enable(),this._hash=t.hash&&(new f).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo(t),this.sources={},this.stacks={},this._classes={},this.resize(),t.classes&&this.setClasses(t.classes),t.style&&this.setStyle(t.style),t.attributionControl&&this.addControl(new _),this.on("style.error",this.onError),this.on("source.error",this.onError),this.on("tile.error",this.onError)};r.extend(g.prototype,a),r.extend(g.prototype,p.prototype),r.extend(g.prototype,{options:{center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:20,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,pinch:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1},addControl:function(t){return t.addTo(this),this},addClass:function(t,e){this._classes[t]||(this._classes[t]=!0,this.style&&this.style._cascade(this._classes,e))},removeClass:function(t,e){this._classes[t]&&(delete this._classes[t],this.style&&this.style._cascade(this._classes,e))},setClasses:function(t,e){this._classes={};for(var i=0;i<t.length;i++)this._classes[t[i]]=!0;this.style&&this.style._cascade(this._classes,e)},hasClass:function(t){return!!this._classes[t]},getClasses:function(){return Object.keys(this._classes)},resize:function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),this._canvas.resize(t,e),this.transform.width=t,this.transform.height=e,this.transform._constrain(),this.painter.resize(t,e),this.fire("movestart").fire("move").fire("resize").fire("moveend")},getBounds:function(){return new y(this.transform.pointLocation(new v(0,0)),this.transform.pointLocation(this.transform.size))},project:function(t){return this.transform.locationPoint(m.convert(t))},unproject:function(t){return this.transform.pointLocation(v.convert(t))},featuresAt:function(t,e,i){var n=this.unproject(t).wrap(),r=this.transform.locationCoordinate(n);return this.style.featuresAt(r,e,i),this},featuresIn:function(t,e,i){return void 0===i&&(i=e,e=t,t=[v.convert([0,0]),v.convert([this.transform.width,this.transform.height])]),t=t.map(v.convert.bind(v)),t=[new v(Math.min(t[0].x,t[1].x),Math.min(t[0].y,t[1].y)),new v(Math.max(t[0].x,t[1].x),Math.max(t[0].y,t[1].y))].map(this.transform.pointCoordinate.bind(this.transform)),this.style.featuresIn(t,e,i),this},batch:function(t){this.style.batch(t),this.style._cascade(this._classes),this.update(!0)},setStyle:function(t){return this.style&&(this.style.off("load",this._onStyleLoad).off("error",this._forwardStyleEvent).off("change",this._onStyleChange).off("source.add",this._onSourceAdd).off("source.remove",this._onSourceRemove).off("source.load",this._onSourceUpdate).off("source.error",this._forwardSourceEvent).off("source.change",this._onSourceUpdate).off("layer.add",this._forwardLayerEvent).off("layer.remove",this._forwardLayerEvent).off("tile.add",this._forwardTileEvent).off("tile.remove",this._forwardTileEvent).off("tile.load",this.update).off("tile.error",this._forwardTileEvent).off("tile.stats",this._forwardTileEvent)._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement)),t?(this.style=t instanceof u?t:new u(t,this.animationLoop),this.style.on("load",this._onStyleLoad).on("error",this._forwardStyleEvent).on("change",this._onStyleChange).on("source.add",this._onSourceAdd).on("source.remove",this._onSourceRemove).on("source.load",this._onSourceUpdate).on("source.error",this._forwardSourceEvent).on("source.change",this._onSourceUpdate).on("layer.add",this._forwardLayerEvent).on("layer.remove",this._forwardLayerEvent).on("tile.add",this._forwardTileEvent).on("tile.remove",this._forwardTileEvent).on("tile.load",this.update).on("tile.error",this._forwardTileEvent).on("tile.stats",this._forwardTileEvent),this.on("rotate",this.style._redoPlacement),this.on("pitch",this.style._redoPlacement),this):(this.style=null,this)},addSource:function(t,e){return this.style.addSource(t,e),this},removeSource:function(t){return this.style.removeSource(t),this},getSource:function(t){return this.style.getSource(t)},addLayer:function(t,e){return this.style.addLayer(t,e),this.style._cascade(this._classes),this},removeLayer:function(t){return this.style.removeLayer(t),this.style._cascade(this._classes),this},setFilter:function(t,e){return this.style.setFilter(t,e),this},setLayerZoomRange:function(t,e,i){return this.style.setLayerZoomRange(t,e,i),this},getFilter:function(t){return this.style.getFilter(t)},setPaintProperty:function(t,e,i,n){return this.batch(function(r){r.setPaintProperty(t,e,i,n)}),this},getPaintProperty:function(t,e,i){return this.style.getPaintProperty(t,e,i)},setLayoutProperty:function(t,e,i){return this.batch(function(n){n.setLayoutProperty(t,e,i)}),this},getLayoutProperty:function(t,e){return this.style.getLayoutProperty(t,e)},getContainer:function(){return this._container},getCanvasContainer:function(){return this._canvasContainer},getCanvas:function(){return this._canvas.getElement()},_setupContainer:function(){var t=this.options.container,e=this._container="string"==typeof t?document.getElementById(t):t;e.classList.add("mapboxgl-map");var i=this._canvasContainer=s.create("div","mapboxgl-canvas-container",e);this.options.interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=new n(this,i);var r=s.create("div","mapboxgl-control-container",e),o=this._controlCorners={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){o[t]=s.create("div","mapboxgl-ctrl-"+t,r)})},_setupPainter:function(){var t=this._canvas.getWebGLContext({failIfMajorPerformanceCaveat:this.options.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.options.preserveDrawingBuffer});return t?void(this.painter=new h(t,this.transform)):void console.error("Failed to initialize WebGL")},_contextLost:function(t){t.preventDefault(),this._frameId&&o.cancelFrame(this._frameId)},_contextRestored:function(){this._setupPainter(),this.resize(),this.update()},loaded:function(){return!this._styleDirty&&!this._sourcesDirty&&!(this.style&&!this.style.loaded())},update:function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender(),this):this},render:function(){return this.style&&this._styleDirty&&(this._styleDirty=!1,this.style._recalculate(this.transform.zoom)),this.style&&this._sourcesDirty&&!this._sourcesDirtyTimeout&&(this._sourcesDirty=!1,this._sourcesDirtyTimeout=setTimeout(function(){this._sourcesDirtyTimeout=null}.bind(this),50),this.style._updateSources(this.transform)),this.painter.render(this.style,{debug:this.debug,vertices:this.vertices,rotating:this.rotating,zooming:this.zooming}),this.fire("render"),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load")),this._frameId=null,this.animationLoop.stopped()||(this._styleDirty=!0),(this._sourcesDirty||this._repaint||!this.animationLoop.stopped())&&this._rerender(),this},remove:function(){return this._hash&&this._hash.remove(),o.cancelFrame(this._frameId),clearTimeout(this._sourcesDirtyTimeout),this.setStyle(null),"undefined"!=typeof window&&window.removeEventListener("resize",this._onWindowResize,!1),this},onError:function(t){console.error(t.error)},_rerender:function(){this.style&&!this._frameId&&(this._frameId=o.frame(this.render))},_forwardStyleEvent:function(t){this.fire("style."+t.type,r.extend({style:t.target},t))},_forwardSourceEvent:function(t){this.fire(t.type,r.extend({style:t.target},t))},_forwardLayerEvent:function(t){this.fire(t.type,r.extend({style:t.target},t))},_forwardTileEvent:function(t){this.fire(t.type,r.extend({style:t.target},t))},_onStyleLoad:function(t){var e=new c,i=this.transform;i.center.lng===e.center.lng&&i.center.lat===e.center.lat&&i.zoom===e.zoom&&i.bearing===e.bearing&&i.pitch===e.pitch&&this.jumpTo(this.style.stylesheet),this.style._cascade(this._classes,{transition:!1}),this._forwardStyleEvent(t)},_onStyleChange:function(t){this.update(!0),this._forwardStyleEvent(t)},_onSourceAdd:function(t){var e=t.source;e.onAdd&&e.onAdd(this),this._forwardSourceEvent(t)},_onSourceRemove:function(t){var e=t.source;e.onRemove&&e.onRemove(this),this._forwardSourceEvent(t)},_onSourceUpdate:function(t){this.update(),this._forwardSourceEvent(t)},_onWindowResize:function(){this.stop().resize().update()}}),r.extendAll(g.prototype,{_debug:!1,get debug(){return this._debug},set debug(t){this._debug=t,this.update()},_collisionDebug:!1,get collisionDebug(){return this._collisionDebug},set collisionDebug(t){this._collisionDebug=t,this.style._redoPlacement()},_repaint:!1,get repaint(){return this._repaint},set repaint(t){this._repaint=t,this.update()},_vertices:!1,get vertices(){return this._vertices},set vertices(t){this._vertices=t,this.update()}})},{"../geo/lng_lat":20,"../geo/lng_lat_bounds":21,"../geo/transform":22,"../render/painter":37,"../style/animation_loop":51,"../style/style":56,"../util/browser":95,"../util/canvas":96,"../util/dom":98,"../util/evented":100,"../util/util":106,"./camera":78,"./control/attribution":79,"./hash":89,"./interaction":90,"point-geometry":137}],92:[function(t,e,i){function n(t){r.setOptions(this,t),r.bindAll(["_updatePosition","_onClickClose"],this)}e.exports=n;var r=t("../util/util"),o=t("../util/evented"),a=t("../util/dom"),s=t("../geo/lng_lat");n.prototype=r.inherit(o,{options:{closeButton:!0,closeOnClick:!0},addTo:function(t){return this._map=t,this._map.on("move",this._updatePosition),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this},remove:function(){return this._container&&this._container.parentNode.removeChild(this._container),this._map&&(this._map.off("move",this._updatePosition),this._map.off("click",this._onClickClose),delete this._map),this},getLngLat:function(){return this._lngLat},setLngLat:function(t){return this._lngLat=s.convert(t),this._update(),this},setText:function(t){return this._content=document.createTextNode(t),this._updateContent(),this},setHTML:function(t){this._content=document.createDocumentFragment();var e,i=document.createElement("body");for(i.innerHTML=t;e=i.firstChild;)this._content.appendChild(e);return this._updateContent(),this},_update:function(){this._map&&(this._container||(this._container=a.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=a.create("div","mapboxgl-popup-tip",this._container),this._wrapper=a.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=a.create("button","mapboxgl-popup-close-button",this._wrapper),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))),this._updateContent(),this._updatePosition())},_updateContent:function(){if(this._content&&this._container){for(var t=this._wrapper;t.hasChildNodes();)t.removeChild(t.firstChild);this.options.closeButton&&t.appendChild(this._closeButton),t.appendChild(this._content)}},_updatePosition:function(){if(this._lngLat&&this._container){var t=this._map.project(this._lngLat).round(),e=this.options.anchor;if(!e){var i=this._container.offsetWidth,n=this._container.offsetHeight;e=t.y<n?["top"]:t.y>this._map.transform.height-n?["bottom"]:[],t.x<i/2?e.push("left"):t.x>this._map.transform.width-i/2&&e.push("right"),e=0===e.length?"bottom":e.join("-"),this.options.anchor=e}var r={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},o=this._container.classList;for(var s in r)o.remove("mapboxgl-popup-anchor-"+s);o.add("mapboxgl-popup-anchor-"+e),a.setTransform(this._container,r[e]+" translate("+t.x+"px,"+t.y+"px)")}},_onClickClose:function(){this.remove()}})},{"../geo/lng_lat":20,"../util/dom":98,"../util/evented":100,"../util/util":106}],93:[function(t,e,i){function n(t,e){this.target=t,this.parent=e,this.callbacks={},this.callbackID=0,this.receive=this.receive.bind(this),this.target.addEventListener("message",this.receive,!1)}e.exports=n,n.prototype.receive=function(t){var e,i=t.data;if("<response>"===i.type)e=this.callbacks[i.id],delete this.callbacks[i.id],e(i.error||null,i.data);else if(void 0!==i.id){var n=i.id;this.parent[i.type](i.data,function(t,e,i){this.postMessage({type:"<response>",id:String(n),error:t?String(t):null,data:e},i)}.bind(this))}else this.parent[i.type](i.data)},n.prototype.send=function(t,e,i,n){var r=null;i&&(this.callbacks[r=this.callbackID++]=i),this.postMessage({type:t,id:String(r),data:e},n)},n.prototype.postMessage=function(t,e){try{this.target.postMessage(t,e)}catch(e){this.target.postMessage(t)}}},{}],94:[function(t,e,i){function n(t){var e=document.createElement("a");return e.href=t,e.protocol===document.location.protocol&&e.host===document.location.host}i.getJSON=function(t,e){var i=new XMLHttpRequest;return i.open("GET",t,!0),i.setRequestHeader("Accept","application/json"),i.onerror=function(t){e(t)},i.onload=function(){if(i.status>=200&&i.status<300&&i.response){var t;try{t=JSON.parse(i.response)}catch(t){return e(t)}e(null,t)}else e(new Error(i.statusText))},i.send(),i},i.getArrayBuffer=function(t,e){var i=new XMLHttpRequest;return i.open("GET",t,!0),i.responseType="arraybuffer",i.onerror=function(t){e(t)},i.onload=function(){i.status>=200&&i.status<300&&i.response?e(null,i.response):e(new Error(i.statusText))},i.send(),i},i.getImage=function(t,e){return i.getArrayBuffer(t,function(t,i){t&&e(t);var n=new Image;n.onload=function(){e(null,n),(window.URL||window.webkitURL).revokeObjectURL(n.src)};var r=new Blob([new Uint8Array(i)],{type:"image/png"});return n.src=(window.URL||window.webkitURL).createObjectURL(r),n.getData=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return t.width=n.width,t.height=n.height,e.drawImage(n,0,0),e.getImageData(0,0,n.width,n.height).data},n})},i.getVideo=function(t,e){var i=document.createElement("video");i.onloadstart=function(){e(null,i)};for(var r=0;r<t.length;r++){var o=document.createElement("source");n(t[r])||(i.crossOrigin="Anonymous"),o.src=t[r],i.appendChild(o)}return i.getData=function(){return i},i}},{}],95:[function(t,e,i){var n=t("./canvas"),r=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;i.frame=function(t){return r(t)};var o=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;i.cancelFrame=function(t){o(t)},i.timed=function(t,e,n){function r(s){o||(window.performance||(s=Date.now()),s>=a+e?t.call(n,1):(t.call(n,(s-a)/e),i.frame(r)))}if(!e)return t.call(n,1),null;var o=!1,a=window.performance?window.performance.now():Date.now();return i.frame(r),function(){o=!0}},i.supported=function(t){for(var e=([function(){return"undefined"!=typeof window},function(){return"undefined"!=typeof document},function(){return!!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)},function(){return!(!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions))},function(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON},function(){return(new n).supportsWebGLContext(t&&t.failIfMajorPerformanceCaveat||!1)},function(){return"Worker"in window}]),i=0;i<e.length;i++)if(!e[i]())return!1;return!0},i.hardwareConcurrency=navigator.hardwareConcurrency||8,Object.defineProperty(i,"devicePixelRatio",{get:function(){return window.devicePixelRatio}})},{"./canvas":96}],96:[function(t,e,i){function n(t,e){this.canvas=document.createElement("canvas"),t&&e&&(this.canvas.style.position="absolute",this.canvas.classList.add("mapboxgl-canvas"),this.canvas.addEventListener("webglcontextlost",t._contextLost.bind(t),!1),this.canvas.addEventListener("webglcontextrestored",t._contextRestored.bind(t),!1),this.canvas.setAttribute("tabindex",0),e.appendChild(this.canvas))}var r=t("../util");e.exports=n,n.prototype.resize=function(t,e){var i=window.devicePixelRatio||1;this.canvas.width=i*t,this.canvas.height=i*e,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"};var o={antialias:!1,alpha:!0,stencil:!0,depth:!1};n.prototype.getWebGLContext=function(t){return t=r.extend({},t,o),this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t)},n.prototype.supportsWebGLContext=function(t){var e=r.extend({failIfMajorPerformanceCaveat:t},o);return"probablySupportsContext"in this.canvas?this.canvas.probablySupportsContext("webgl",e)||this.canvas.probablySupportsContext("experimental-webgl",e):"supportsContext"in this.canvas?this.canvas.supportsContext("webgl",e)||this.canvas.supportsContext("experimental-webgl",e):!!window.WebGLRenderingContext&&!!this.getWebGLContext(t)},n.prototype.getElement=function(){return this.canvas}},{"../util":106}],97:[function(t,e,i){function n(e,i){this.actors=[],this.currentActor=0;for(var n=0;e>n;n++){var a=new o(t("../../source/worker")),s=new r(a,i);s.name="Worker "+n,this.actors.push(s)}}var r=t("../actor"),o=t("webworkify");e.exports=n,n.prototype={broadcast:function(t,e){for(var i=0;i<this.actors.length;i++)this.actors[i].send(t,e)},send:function(t,e,i,n,r){return("number"!=typeof n||isNaN(n))&&(n=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[n].send(t,e,i,r),n},remove:function(){for(var t=0;t<this.actors.length;t++)this.actors[t].target.terminate();this.actors=[]}}},{"../../source/worker":49,"../actor":93,webworkify:149}],98:[function(t,e,i){function n(t){for(var e=0;e<t.length;e++)if(t[e]in s)return t[e]}function r(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",r,!0)}var o=t("point-geometry");i.create=function(t,e,i){var n=document.createElement(t);return e&&(n.className=e),i&&i.appendChild(n),n};var a,s=document.documentElement.style,u=n(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);i.disableDrag=function(){u&&(a=s[u],s[u]="none")},i.enableDrag=function(){u&&(s[u]=a)};var l=n(["transform","WebkitTransform"]);i.setTransform=function(t,e){t.style[l]=e},i.suppressClick=function(){window.addEventListener("click",r,!0),window.setTimeout(function(){window.removeEventListener("click",r,!0)},0)},i.mousePos=function(t,e){var i=t.getBoundingClientRect();return e=e.touches?e.touches[0]:e,new o(e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop)}},{"point-geometry":137}],99:[function(t,e,i){e.exports={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0}},{}],100:[function(t,e,i){var n=t("./util"),r={on:function(t,e){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e),this},off:function(t,e){if(!t)return delete this._events,this;if(!this.listens(t))return this;if(e){var i=this._events[t].indexOf(e);i>=0&&this._events[t].splice(i,1),this._events[t].length||delete this._events[t]}else delete this._events[t];return this},once:function(t,e){var i=function(n){this.off(t,i),e.call(this,n)}.bind(this);return this.on(t,i),this},fire:function(t,e){if(!this.listens(t))return this;e=n.extend({},e),n.extend(e,{type:t,target:this});for(var i=this._events[t].slice(),r=0;r<i.length;r++)i[r].call(this,e);return this},listens:function(t){return!(!this._events||!this._events[t])}};e.exports=r},{"./util":106}],101:[function(t,e,i){function n(t,e){this.stacks=t.readFields(r,[],e)}function r(t,e,i){if(1===t){var n=i.readMessage(o,{glyphs:{}});e.push(n)}}function o(t,e,i){if(1===t)e.name=i.readString();else if(2===t)e.range=i.readString();else if(3===t){var n=i.readMessage(a,{});e.glyphs[n.id]=n}}function a(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}e.exports=n},{}],102:[function(t,e,i){function n(t,e,i){return t*(1-i)+e*i}e.exports=n,n.number=n,n.vec2=function(t,e,i){return[n(t[0],e[0],i),n(t[1],e[1],i)]},n.color=function(t,e,i){return[n(t[0],e[0],i),n(t[1],e[1],i),n(t[2],e[2],i),n(t[3],e[3],i)]},n.array=function(t,e,i){return t.map(function(t,r){return n(t,e[r],i)})}},{}],103:[function(t,e,i){function n(t,e,i){if(!(i=i||r.ACCESS_TOKEN)&&r.REQUIRE_ACCESS_TOKEN)throw new Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/developers/api/#access-tokens");if(t=t.replace(/^mapbox:\/\//,r.API_URL+e),t+=-1!==t.indexOf("?")?"&access_token=":"?access_token=",r.REQUIRE_ACCESS_TOKEN){if("s"===i[0])throw new Error("Use a public access token (pk.*) with Mapbox GL JS, not a secret access token (sk.*). See https://www.mapbox.com/developers/api/#access-tokens");t+=i}return t}var r=t("./config"),o=t("./browser");e.exports.normalizeStyleURL=function(t,e){if(!t.match(/^mapbox:\/\/styles\//))return t;var i=t.split("/");return n("mapbox://"+i[3]+"/"+i[4]+(i[5]?"/draft":""),"/styles/v1/",e)},e.exports.normalizeSourceURL=function(t,e){return t.match(/^mapbox:\/\//)?n(t+".json","/v4/",e)+"&secure":t},e.exports.normalizeGlyphsURL=function(t,e){return t.match(/^mapbox:\/\//)?n("mapbox://"+t.split("/")[3]+"/{fontstack}/{range}.pbf","/fonts/v1/",e):t},e.exports.normalizeSpriteURL=function(t,e,i,r){if(!t.match(/^mapbox:\/\/sprites\//))return t+e+i;var o=t.split("/");return n("mapbox://"+o[3]+"/"+o[4]+(o[5]?"/draft":"")+"/sprite"+e+i,"/styles/v1/",r)},e.exports.normalizeTileURL=function(t,e){return e&&e.match(/^mapbox:\/\//)?t.replace(/\.((?:png|jpg)\d*)(?=$|\?)/,o.devicePixelRatio>=2?"@2x.$1":".$1"):t}},{"./browser":95,"./config":99}],104:[function(t,e,i){function n(t,e){this.max=t,this.onRemove=e,this.reset()}e.exports=n,n.prototype.reset=function(){for(var t in this.list)this.onRemove(this.list[t]);return this.list={},this.order=[],this},n.prototype.add=function(t,e){if(this.list[t]=e,this.order.push(t),this.order.length>this.max){var i=this.get(this.order[0]);i&&this.onRemove(i)}return this},n.prototype.has=function(t){return t in this.list},n.prototype.keys=function(){return this.order},n.prototype.get=function(t){if(!this.has(t))return null;var e=this.list[t];return delete this.list[t],this.order.splice(this.order.indexOf(t),1),e}},{}],105:[function(t,e,i){function n(t,e){return e.replace(/{([^{}()\[\]<>$=:;.,^]+)}/g,function(e,i){return i in t?t[i]:""})}e.exports=n},{}],106:[function(t,e,i){var n=t("unitbezier"),r=t("../geo/coordinate");i.easeCubicInOut=function(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,i=e*t;return 4*(.5>t?i:3*(t-e)+i-.75)},i.bezier=function(t,e,i,r){var o=new n(t,e,i,r);return function(t){return o.solve(t)}},i.ease=i.bezier(.25,.1,.25,1),i.premultiply=function(t){return t[0]*=t[3],t[1]*=t[3],t[2]*=t[3],t},i.clamp=function(t,e,i){return Math.min(i,Math.max(e,t))},i.wrap=function(t,e,i){var n=i-e,r=((t-e)%n+n)%n+e;return r===e?i:r},i.coalesce=function(){for(var t=0;t<arguments.length;t++){var e=arguments[t]
;if(null!==e&&void 0!==e)return e}},i.asyncEach=function(t,e,i){function n(){0==--r&&i()}var r=t.length;if(0===r)return i();for(var o=0;o<t.length;o++)e(t[o],n)},i.asyncAll=function(t,e,i){var n=t.length,r=new Array(t.length),o=null;t.forEach(function(t,a){e(t,function(t,e){t&&(o=t),r[a]=e,0==--n&&i(o,r)})})},i.keysDifference=function(t,e){var i=[];for(var n in t)n in e||i.push(n);return i},i.extend=function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t},i.extendAll=function(t,e){for(var i in e)Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i));return t},i.inherit=function(t,e){var n="function"==typeof t?t.prototype:t,r=Object.create(n);return i.extendAll(r,e),r},i.pick=function(t,e){for(var i={},n=0;n<e.length;n++){var r=e[n];r in t&&(i[r]=t[r])}return i};var o=1;i.uniqueId=function(){return o++},i.throttle=function(t,e,i){var n,r,o,a;return a=function(){n=!1,r&&(o.apply(i,r),r=!1)},o=function(){n?r=arguments:(t.apply(i,arguments),setTimeout(a,e),n=!0)}},i.debounce=function(t,e){var i,n;return function(){n=arguments,clearTimeout(i),i=setTimeout(function(){t.apply(null,n)},e)}},i.bindAll=function(t,e){t.forEach(function(t){e[t]=e[t].bind(e)})},i.bindHandlers=function(t){for(var e in t)"function"==typeof t[e]&&0===e.indexOf("_on")&&(t[e]=t[e].bind(t))},i.setOptions=function(t,e){t.hasOwnProperty("options")||(t.options=t.options?Object.create(t.options):{});for(var i in e)t.options[i]=e[i];return t.options},i.getCoordinatesCenter=function(t){for(var e=1/0,i=1/0,n=-1/0,o=-1/0,a=0;a<t.length;a++)e=Math.min(e,t[a].column),i=Math.min(i,t[a].row),n=Math.max(n,t[a].column),o=Math.max(o,t[a].row);var s=n-e,u=o-i,l=Math.max(s,u);return new r((e+n)/2,(i+o)/2,0).zoomTo(Math.floor(-Math.log(l)/Math.LN2))}},{"../geo/coordinate":19,unitbezier:141}],107:[function(t,e,i){function n(t){return t=Math.round(t),0>t?0:t>255?255:t}function r(t){return 0>t?0:t>1?1:t}function o(t){return n("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function a(t){return r("%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))}function s(t,e,i){return 0>i?i+=1:i>1&&(i-=1),1>6*i?t+(e-t)*i*6:1>2*i?e:2>3*i?t+(e-t)*(2/3-i)*6:t}function u(t){var e=t.replace(/ /g,"").toLowerCase();if(e in l)return l[e].slice();if("#"===e[0]){if(4===e.length){var i=parseInt(e.substr(1),16);return i>=0&&4095>=i?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null}if(7===e.length){var i=parseInt(e.substr(1),16);return i>=0&&16777215>=i?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null}return null}var r=e.indexOf("("),u=e.indexOf(")");if(-1!==r&&u+1===e.length){var h=e.substr(0,r),c=e.substr(r+1,u-(r+1)).split(","),f=1;switch(h){case"rgba":if(4!==c.length)return null;f=a(c.pop());case"rgb":return 3!==c.length?null:[o(c[0]),o(c[1]),o(c[2]),f];case"hsla":if(4!==c.length)return null;f=a(c.pop());case"hsl":if(3!==c.length)return null;var d=(parseFloat(c[0])%360+360)%360/360,p=a(c[1]),m=a(c[2]),y=.5>=m?m*(p+1):m+p-m*p,v=2*m-y;return[n(255*s(v,y,d+1/3)),n(255*s(v,y,d)),n(255*s(v,y,d-1/3)),f];default:return null}}return null}var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{i.parseCSSColor=u}catch(t){}},{}],108:[function(t,e,i){function n(t){return function(e,i,n){return"$type"===i?"t"+t+s.indexOf(n):"p["+JSON.stringify(i)+"]"+t+JSON.stringify(n)}}function r(t){var e=n(t);return function(t,i,n){return"$type"===i?e(t,i,n):"typeof(p["+JSON.stringify(i)+"]) === typeof("+JSON.stringify(n)+") && "+e(t,i,n)}}function o(t){return u[t[0]].apply(t,t)}function a(){return!0}var s=["Unknown","Point","LineString","Polygon"],u={"==":n("==="),"!=":n("!=="),">":r(">"),"<":r("<"),"<=":r("<="),">=":r(">="),in:function(t,e){return"(function(){"+Array.prototype.slice.call(arguments,2).map(function(i){return"if ("+u["=="](t,e,i)+") return true;"}).join("")+"return false;})()"},"!in":function(){return"!("+u.in.apply(this,arguments)+")"},any:function(){return Array.prototype.slice.call(arguments,1).map(function(t){return"("+o(t)+")"}).join("||")||"false"},all:function(){return Array.prototype.slice.call(arguments,1).map(function(t){return"("+o(t)+")"}).join("&&")||"true"},none:function(){return"!("+u.any.apply(this,arguments)+")"}};e.exports=function(t){if(!t)return a;var e="var p = f.properties || f.tags || {}, t = f.type; return "+o(t)+";";return new Function("f",e)}},{}],109:[function(t,e,i){function n(t,e,i,n,a,s,u,l){if(i/=e,n/=e,u>=i&&n>=l)return t;if(u>n||i>l)return null;for(var h=[],c=0;c<t.length;c++){var f,d,p=t[c],m=p.geometry,y=p.type;if(f=p.min[a],d=p.max[a],f>=i&&n>=d)h.push(p);else if(!(f>n||i>d)){var v=1===y?r(m,i,n,a):o(m,i,n,a,s,3===y);v.length&&h.push({geometry:v,type:y,tags:t[c].tags||null,min:p.min,max:p.max})}}return h.length?h:null}function r(t,e,i,n){for(var r=[],o=0;o<t.length;o++){var a=t[o],s=a[n];s>=e&&i>=s&&r.push(a)}return r}function o(t,e,i,n,r,o){for(var s=[],u=0;u<t.length;u++){var l,h,c,f=0,d=0,p=null,m=t[u],y=m.area,v=m.dist,_=m.length,g=[];for(h=0;_-1>h;h++)l=p||m[h],p=m[h+1],f=d||l[n],d=p[n],e>f?d>i?(g.push(r(l,p,e),r(l,p,i)),o||(g=a(s,g,y,v))):d>=e&&g.push(r(l,p,e)):f>i?e>d?(g.push(r(l,p,i),r(l,p,e)),o||(g=a(s,g,y,v))):i>=d&&g.push(r(l,p,i)):(g.push(l),e>d?(g.push(r(l,p,e)),o||(g=a(s,g,y,v))):d>i&&(g.push(r(l,p,i)),o||(g=a(s,g,y,v))));l=m[_-1],f=l[n],f>=e&&i>=f&&g.push(l),c=g[g.length-1],o&&c&&(g[0][0]!==c[0]||g[0][1]!==c[1])&&g.push(g[0]),a(s,g,y,v)}return s}function a(t,e,i,n){return e.length&&(e.area=i,e.dist=n,t.push(e)),[]}e.exports=n},{}],110:[function(t,e,i){function n(t,e){var i=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)r(i,t.features[n],e);else"Feature"===t.type?r(i,t,e):r(i,{geometry:t},e);return i}function r(t,e,i){var n,u,l,h=e.geometry,c=h.type,f=h.coordinates,d=e.properties;if("Point"===c)t.push(o(d,1,[s(f)]));else if("MultiPoint"===c)t.push(o(d,1,a(f)));else if("LineString"===c)t.push(o(d,2,[a(f,i)]));else if("MultiLineString"===c||"Polygon"===c){for(l=[],n=0;n<f.length;n++)l.push(a(f[n],i));t.push(o(d,"Polygon"===c?3:2,l))}else if("MultiPolygon"===c){for(l=[],n=0;n<f.length;n++)for(u=0;u<f[n].length;u++)l.push(a(f[n][u],i));t.push(o(d,3,l))}else{if("GeometryCollection"!==c)throw new Error("Input data is not a valid GeoJSON object.");for(n=0;n<h.geometries.length;n++)r(t,{geometry:h.geometries[n],properties:d},i)}}function o(t,e,i){var n={geometry:i,type:e,tags:t||null,min:[2,1],max:[-1,0]};return l(n),n}function a(t,e){for(var i=[],n=0;n<t.length;n++)i.push(s(t[n]));return e&&(c(i,e),u(i)),i}function s(t){var e=Math.sin(t[1]*Math.PI/180),i=t[0]/360+.5,n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n=-1>n?-1:n>1?1:n,[i,n,0]}function u(t){for(var e,i,n=0,r=0,o=0;o<t.length-1;o++)e=i||t[o],i=t[o+1],n+=e[0]*i[1]-i[0]*e[1],r+=Math.abs(i[0]-e[0])+Math.abs(i[1]-e[1]);t.area=Math.abs(n/2),t.dist=r}function l(t){var e=t.geometry,i=t.min,n=t.max;if(1===t.type)h(i,n,e);else for(var r=0;r<e.length;r++)h(i,n,e[r]);return t}function h(t,e,i){for(var n,r=0;r<i.length;r++)n=i[r],t[0]=Math.min(n[0],t[0]),e[0]=Math.max(n[0],e[0]),t[1]=Math.min(n[1],t[1]),e[1]=Math.max(n[1],e[1])}e.exports=n;var c=t("./simplify")},{"./simplify":112}],111:[function(t,e,i){function n(t,e){return new r(t,e)}function r(t,e){e=this.options=u(Object.create(this.options),e);var i=e.debug;i&&console.time("preprocess data");var n=1<<e.maxZoom,r=h(t,e.tolerance/(n*e.extent));this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=d(r,e.buffer/e.extent,a),r.length&&this.splitTile(r,0,0,0),i&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function o(t,e,i){return 32*((1<<t)*i+e)+t}function a(t,e,i){return[i,(i-t[0])*(e[1]-t[1])/(e[0]-t[0])+t[1],1]}function s(t,e,i){return[(i-t[1])*(e[0]-t[0])/(e[1]-t[1])+t[0],i,1]}function u(t,e){for(var i in e)t[i]=e[i];return t}function l(t,e,i){var n=t.source;if(1!==n.length)return!1;var r=n[0];if(3!==r.type||r.geometry.length>1)return!1;var o=r.geometry[0].length;if(5!==o)return!1;for(var a=0;o>a;a++){var s=c.point(r.geometry[0][a],e,t.z2,t.x,t.y);if(s[0]!==-i&&s[0]!==e+i||s[1]!==-i&&s[1]!==e+i)return!1}return!0}e.exports=n;var h=t("./convert"),c=t("./transform"),f=t("./clip"),d=t("./wrap"),p=t("./tile");r.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0},r.prototype.splitTile=function(t,e,i,n,r,u,h){for(var c=[t,e,i,n],d=this.options,m=d.debug,y=null;c.length;){n=c.pop(),i=c.pop(),e=c.pop(),t=c.pop();var v=1<<e,_=o(e,i,n),g=this.tiles[_],x=e===d.maxZoom?0:d.tolerance/(v*d.extent);if(!g&&(m>1&&console.time("creation"),g=this.tiles[_]=p(t,v,i,n,x,e===d.maxZoom),this.tileCoords.push({z:e,x:i,y:n}),m)){m>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,n,g.numFeatures,g.numPoints,g.numSimplified),console.timeEnd("creation"));var b="z"+e;this.stats[b]=(this.stats[b]||0)+1,this.total++}if(g.source=t,r){if(e===d.maxZoom||e===r)continue;var w=1<<r-e;if(i!==Math.floor(u/w)||n!==Math.floor(h/w))continue}else if(e===d.indexMaxZoom||g.numPoints<=d.indexMaxPoints)continue;if(d.solidChildren||!l(g,d.extent,d.buffer)){g.source=null,m>1&&console.time("clipping");var M,E,S,T,z,L,P=.5*d.buffer/d.extent,R=.5-P,A=.5+P,I=1+P;M=E=S=T=null,z=f(t,v,i-P,i+A,0,a,g.min[0],g.max[0]),L=f(t,v,i+R,i+I,0,a,g.min[0],g.max[0]),z&&(M=f(z,v,n-P,n+A,1,s,g.min[1],g.max[1]),E=f(z,v,n+R,n+I,1,s,g.min[1],g.max[1])),L&&(S=f(L,v,n-P,n+A,1,s,g.min[1],g.max[1]),T=f(L,v,n+R,n+I,1,s,g.min[1],g.max[1])),m>1&&console.timeEnd("clipping"),M&&c.push(M,e+1,2*i,2*n),E&&c.push(E,e+1,2*i,2*n+1),S&&c.push(S,e+1,2*i+1,2*n),T&&c.push(T,e+1,2*i+1,2*n+1)}else r&&(y=e)}return y},r.prototype.getTile=function(t,e,i){var n=this.options,r=n.extent,a=n.debug,s=1<<t;e=(e%s+s)%s;var u=o(t,e,i);if(this.tiles[u])return c.tile(this.tiles[u],r);a>1&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var h,f=t,d=e,p=i;!h&&f>0;)f--,d=Math.floor(d/2),p=Math.floor(p/2),h=this.tiles[o(f,d,p)];if(!h||!h.source)return null;if(a>1&&console.log("found parent tile z%d-%d-%d",f,d,p),l(h,r,n.buffer))return c.tile(h,r);a>1&&console.time("drilling down");var m=this.splitTile(h.source,f,d,p,t,e,i);if(a>1&&console.timeEnd("drilling down"),null!==m){var y=1<<t-m;u=o(m,Math.floor(e/y),Math.floor(i/y))}return this.tiles[u]?c.tile(this.tiles[u],r):null}},{"./clip":109,"./convert":110,"./tile":113,"./transform":114,"./wrap":115}],112:[function(t,e,i){function n(t,e){var i,n,o,a,s=e*e,u=t.length,l=0,h=u-1,c=[];for(t[l][2]=1,t[h][2]=1;h;){for(n=0,i=l+1;h>i;i++)(o=r(t[i],t[l],t[h]))>n&&(a=i,n=o);n>s?(t[a][2]=n,c.push(l),c.push(a),l=a):(h=c.pop(),l=c.pop())}}function r(t,e,i){var n=e[0],r=e[1],o=i[0],a=i[1],s=t[0],u=t[1],l=o-n,h=a-r;if(0!==l||0!==h){var c=((s-n)*l+(u-r)*h)/(l*l+h*h);c>1?(n=o,r=a):c>0&&(n+=l*c,r+=h*c)}return l=s-n,h=u-r,l*l+h*h}e.exports=n},{}],113:[function(t,e,i){function n(t,e,i,n,o,a){for(var s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:n,z2:e,transformed:!1,min:[2,1],max:[-1,0]},u=0;u<t.length;u++){s.numFeatures++,r(s,t[u],o,a);var l=t[u].min,h=t[u].max;l[0]<s.min[0]&&(s.min[0]=l[0]),l[1]<s.min[1]&&(s.min[1]=l[1]),h[0]>s.max[0]&&(s.max[0]=h[0]),h[1]>s.max[1]&&(s.max[1]=h[1])}return s}function r(t,e,i,n){var r,o,a,s,u=e.geometry,l=e.type,h=[],c=i*i;if(1===l)for(r=0;r<u.length;r++)h.push(u[r]),t.numPoints++,t.numSimplified++;else for(r=0;r<u.length;r++)if(a=u[r],n||!(2===l&&a.dist<i||3===l&&a.area<c)){var f=[];for(o=0;o<a.length;o++)s=a[o],(n||s[2]>c)&&(f.push(s),t.numSimplified++),t.numPoints++;h.push(f)}else t.numPoints+=a.length;h.length&&t.features.push({geometry:h,type:l,tags:e.tags||null})}e.exports=n},{}],114:[function(t,e,i){function n(t,e){if(t.transformed)return t;var i,n,o,a=t.z2,s=t.x,u=t.y;for(i=0;i<t.features.length;i++){var l=t.features[i],h=l.geometry;if(1===l.type)for(n=0;n<h.length;n++)h[n]=r(h[n],e,a,s,u);else for(n=0;n<h.length;n++){var c=h[n];for(o=0;o<c.length;o++)c[o]=r(c[o],e,a,s,u)}}return t.transformed=!0,t}function r(t,e,i,n,r){return[Math.round(e*(t[0]*i-n)),Math.round(e*(t[1]*i-r))]}i.tile=n,i.point=r},{}],115:[function(t,e,i){function n(t,e,i){var n=t,o=a(t,1,-1-e,e,0,i,-1,2),s=a(t,1,1-e,2+e,0,i,-1,2);return(o||s)&&(n=a(t,1,-e,1+e,0,i,-1,2),o&&(n=r(o,1).concat(n)),s&&(n=n.concat(r(s,-1)))),n}function r(t,e){for(var i=[],n=0;n<t.length;n++){var r,a=t[n],s=a.type;if(1===s)r=o(a.geometry,e);else{r=[];for(var u=0;u<a.geometry.length;u++)r.push(o(a.geometry[u],e))}i.push({geometry:r,type:s,tags:a.tags,min:[a.min[0]+e,a.min[1]],max:[a.max[0]+e,a.max[1]]})}return i}function o(t,e){var i=[];i.area=t.area,i.dist=t.dist;for(var n=0;n<t.length;n++)i.push([t[n][0]+e,t[n][1],t[n][2]]);return i}var a=t("./clip");e.exports=n},{"./clip":109}],116:[function(t,e,i){i.glMatrix=t("./gl-matrix/common.js"),i.mat2=t("./gl-matrix/mat2.js"),i.mat2d=t("./gl-matrix/mat2d.js"),i.mat3=t("./gl-matrix/mat3.js"),i.mat4=t("./gl-matrix/mat4.js"),i.quat=t("./gl-matrix/quat.js"),i.vec2=t("./gl-matrix/vec2.js"),i.vec3=t("./gl-matrix/vec3.js"),i.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":117,"./gl-matrix/mat2.js":118,"./gl-matrix/mat2d.js":119,"./gl-matrix/mat3.js":120,"./gl-matrix/mat4.js":121,"./gl-matrix/quat.js":122,"./gl-matrix/vec2.js":123,"./gl-matrix/vec3.js":124,"./gl-matrix/vec4.js":125}],117:[function(t,e,i){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.setMatrixArrayType=function(t){GLMAT_ARRAY_TYPE=t};var r=Math.PI/180;n.toRadian=function(t){return t*r},e.exports=n},{}],118:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.transpose=function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=i*o-r*n;return a?(a=1/a,t[0]=o*a,t[1]=-n*a,t[2]=-r*a,t[3]=i*a,t):null},r.adjoint=function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=i[0],u=i[1],l=i[2],h=i[3];return t[0]=n*s+o*u,t[1]=r*s+a*u,t[2]=n*l+o*h,t[3]=r*l+a*h,t},r.mul=r.multiply,r.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(i),u=Math.cos(i);return t[0]=n*u+o*s,t[1]=r*u+a*s,t[2]=n*-s+o*u,t[3]=r*-s+a*u,t},r.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=i[0],u=i[1];return t[0]=n*s,t[1]=r*s,t[2]=o*u,t[3]=a*u,t},r.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},r.LDU=function(t,e,i,n){return t[2]=n[2]/n[0],i[0]=n[0],i[1]=n[1],i[3]=n[3]-t[2]*i[1],[t,e,i]},e.exports=r},{"./common.js":117}],119:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=i*o-n*r;return u?(u=1/u,t[0]=o*u,t[1]=-n*u,t[2]=-r*u,t[3]=i*u,t[4]=(r*s-o*a)*u,t[5]=(n*a-i*s)*u,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=i[0],h=i[1],c=i[2],f=i[3],d=i[4],p=i[5];return t[0]=n*l+o*h,t[1]=r*l+a*h,t[2]=n*c+o*f,t[3]=r*c+a*f,t[4]=n*d+o*p+s,t[5]=r*d+a*p+u,t},r.mul=r.multiply,r.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=Math.sin(i),h=Math.cos(i);return t[0]=n*h+o*l,t[1]=r*h+a*l,t[2]=n*-l+o*h,t[3]=r*-l+a*h,t[4]=s,t[5]=u,t},r.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=i[0],h=i[1];return t[0]=n*l,t[1]=r*l,t[2]=o*h,t[3]=a*h,t[4]=s,t[5]=u,t},r.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=i[0],h=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=n*l+o*h+s,t[5]=r*l+a*h+u,t},r.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.exports=r},{"./common.js":117}],120:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=h*a-s*l,f=-h*o+s*u,d=l*o-a*u,p=i*c+n*f+r*d;return p?(p=1/p,t[0]=c*p,t[1]=(-h*n+r*l)*p,t[2]=(s*n-r*a)*p,t[3]=f*p,t[4]=(h*i-r*u)*p,t[5]=(-s*i+r*o)*p,t[6]=d*p,t[7]=(-l*i+n*u)*p,t[8]=(a*i-n*o)*p,t):null},r.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8];return t[0]=a*h-s*l,t[1]=r*l-n*h,t[2]=n*s-r*a,t[3]=s*u-o*h,t[4]=i*h-r*u,t[5]=r*o-i*s,t[6]=o*l-a*u,t[7]=n*u-i*l,t[8]=i*a-n*o,t},r.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*(l*o-a*u)+i*(-l*r+a*s)+n*(u*r-o*s)},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=i[0],d=i[1],p=i[2],m=i[3],y=i[4],v=i[5],_=i[6],g=i[7],x=i[8];return t[0]=f*n+d*a+p*l,t[1]=f*r+d*s+p*h,t[2]=f*o+d*u+p*c,t[3]=m*n+y*a+v*l,t[4]=m*r+y*s+v*h,t[5]=m*o+y*u+v*c,t[6]=_*n+g*a+x*l,t[7]=_*r+g*s+x*h,t[8]=_*o+g*u+x*c,t},r.mul=r.multiply,r.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=i[0],d=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=f*n+d*a+l,t[7]=f*r+d*s+h,t[8]=f*o+d*u+c,t},r.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=Math.sin(i),d=Math.cos(i);return t[0]=d*n+f*a,t[1]=d*r+f*s,t[2]=d*o+f*u,t[3]=d*a-f*n,t[4]=d*s-f*r,t[5]=d*u-f*o,t[6]=l,t[7]=h,t[8]=c,t},r.scale=function(t,e,i){var n=i[0],r=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=i+i,s=n+n,u=r+r,l=i*a,h=n*a,c=n*s,f=r*a,d=r*s,p=r*u,m=o*a,y=o*s,v=o*u;return t[0]=1-c-p,t[3]=h-v,t[6]=f+y,t[1]=h+v,t[4]=1-l-p,t[7]=d-m,t[2]=f-y,t[5]=d+m,t[8]=1-l-c,t},r.normalFromMat4=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],y=e[14],v=e[15],_=i*s-n*a,g=i*u-r*a,x=i*l-o*a,b=n*u-r*s,w=n*l-o*s,M=r*l-o*u,E=h*m-c*p,S=h*y-f*p,T=h*v-d*p,z=c*y-f*m,L=c*v-d*m,P=f*v-d*y,R=_*P-g*L+x*z+b*T-w*S+M*E;return R?(R=1/R,t[0]=(s*P-u*L+l*z)*R,t[1]=(u*T-a*P-l*S)*R,t[2]=(a*L-s*T+l*E)*R,t[3]=(r*L-n*P-o*z)*R,t[4]=(i*P-r*T+o*S)*R,t[5]=(n*T-i*L-o*E)*R,t[6]=(m*M-y*w+v*b)*R,t[7]=(y*x-p*M-v*g)*R,t[8]=(p*w-m*x+v*_)*R,t):null},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.exports=r},{"./common.js":117}],121:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=r,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},r.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],y=e[14],v=e[15],_=i*s-n*a,g=i*u-r*a,x=i*l-o*a,b=n*u-r*s,w=n*l-o*s,M=r*l-o*u,E=h*m-c*p,S=h*y-f*p,T=h*v-d*p,z=c*y-f*m,L=c*v-d*m,P=f*v-d*y,R=_*P-g*L+x*z+b*T-w*S+M*E;return R?(R=1/R,t[0]=(s*P-u*L+l*z)*R,t[1]=(r*L-n*P-o*z)*R,t[2]=(m*M-y*w+v*b)*R,t[3]=(f*w-c*M-d*b)*R,t[4]=(u*T-a*P-l*S)*R,t[5]=(i*P-r*T+o*S)*R,t[6]=(y*x-p*M-v*g)*R,t[7]=(h*M-f*x+d*g)*R,t[8]=(a*L-s*T+l*E)*R,t[9]=(n*T-i*L-o*E)*R,t[10]=(p*w-m*x+v*_)*R,t[11]=(c*x-h*w-d*_)*R,t[12]=(s*S-a*z-u*E)*R,t[13]=(i*z-n*S+r*E)*R,t[14]=(m*g-p*b-y*_)*R,t[15]=(h*b-c*g+f*_)*R,t):null},r.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],f=e[10],d=e[11],p=e[12],m=e[13],y=e[14],v=e[15];return t[0]=s*(f*v-d*y)-c*(u*v-l*y)+m*(u*d-l*f),t[1]=-(n*(f*v-d*y)-c*(r*v-o*y)+m*(r*d-o*f)),t[2]=n*(u*v-l*y)-s*(r*v-o*y)+m*(r*l-o*u),t[3]=-(n*(u*d-l*f)-s*(r*d-o*f)+c*(r*l-o*u)),t[4]=-(a*(f*v-d*y)-h*(u*v-l*y)+p*(u*d-l*f)),t[5]=i*(f*v-d*y)-h*(r*v-o*y)+p*(r*d-o*f),t[6]=-(i*(u*v-l*y)-a*(r*v-o*y)+p*(r*l-o*u)),t[7]=i*(u*d-l*f)-a*(r*d-o*f)+h*(r*l-o*u),t[8]=a*(c*v-d*m)-h*(s*v-l*m)+p*(s*d-l*c),t[9]=-(i*(c*v-d*m)-h*(n*v-o*m)+p*(n*d-o*c)),t[10]=i*(s*v-l*m)-a*(n*v-o*m)+p*(n*l-o*s),t[11]=-(i*(s*d-l*c)-a*(n*d-o*c)+h*(n*l-o*s)),t[12]=-(a*(c*y-f*m)-h*(s*y-u*m)+p*(s*f-u*c)),t[13]=i*(c*y-f*m)-h*(n*y-r*m)+p*(n*f-r*c),t[14]=-(i*(s*y-u*m)-a*(n*y-r*m)+p*(n*u-r*s)),t[15]=i*(s*f-u*c)-a*(n*f-r*c)+h*(n*u-r*s),t},r.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],h=t[9],c=t[10],f=t[11],d=t[12],p=t[13],m=t[14],y=t[15];return(e*a-i*o)*(c*y-f*m)-(e*s-n*o)*(h*y-f*p)+(e*u-r*o)*(h*m-c*p)+(i*s-n*a)*(l*y-f*d)-(i*u-r*a)*(l*m-c*d)+(n*u-r*s)*(l*p-h*d)},r.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=e[9],d=e[10],p=e[11],m=e[12],y=e[13],v=e[14],_=e[15],g=i[0],x=i[1],b=i[2],w=i[3];return t[0]=g*n+x*s+b*c+w*m,t[1]=g*r+x*u+b*f+w*y,t[2]=g*o+x*l+b*d+w*v,t[3]=g*a+x*h+b*p+w*_,g=i[4],x=i[5],b=i[6],w=i[7],t[4]=g*n+x*s+b*c+w*m,t[5]=g*r+x*u+b*f+w*y,t[6]=g*o+x*l+b*d+w*v,t[7]=g*a+x*h+b*p+w*_,g=i[8],x=i[9],b=i[10],w=i[11],t[8]=g*n+x*s+b*c+w*m,t[9]=g*r+x*u+b*f+w*y,t[10]=g*o+x*l+b*d+w*v,t[11]=g*a+x*h+b*p+w*_,g=i[12],x=i[13],b=i[14],w=i[15],t[12]=g*n+x*s+b*c+w*m,t[13]=g*r+x*u+b*f+w*y,t[14]=g*o+x*l+b*d+w*v,t[15]=g*a+x*h+b*p+w*_,t},r.mul=r.multiply,r.translate=function(t,e,i){var n,r,o,a,s,u,l,h,c,f,d,p,m=i[0],y=i[1],v=i[2];return e===t?(t[12]=e[0]*m+e[4]*y+e[8]*v+e[12],t[13]=e[1]*m+e[5]*y+e[9]*v+e[13],t[14]=e[2]*m+e[6]*y+e[10]*v+e[14],t[15]=e[3]*m+e[7]*y+e[11]*v+e[15]):(n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=e[9],d=e[10],p=e[11],t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=h,t[8]=c,t[9]=f,t[10]=d,t[11]=p,t[12]=n*m+s*y+c*v+e[12],t[13]=r*m+u*y+f*v+e[13],t[14]=o*m+l*y+d*v+e[14],t[15]=a*m+h*y+p*v+e[15]),t},r.scale=function(t,e,i){var n=i[0],r=i[1],o=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.rotate=function(t,e,i,r){var o,a,s,u,l,h,c,f,d,p,m,y,v,_,g,x,b,w,M,E,S,T,z,L,P=r[0],R=r[1],A=r[2],I=Math.sqrt(P*P+R*R+A*A);return Math.abs(I)<n.EPSILON?null:(I=1/I,P*=I,R*=I,A*=I,o=Math.sin(i),a=Math.cos(i),s=1-a,u=e[0],l=e[1],h=e[2],c=e[3],f=e[4],d=e[5],p=e[6],m=e[7],y=e[8],v=e[9],_=e[10],g=e[11],x=P*P*s+a,b=R*P*s+A*o,w=A*P*s-R*o,M=P*R*s-A*o,E=R*R*s+a,S=A*R*s+P*o,T=P*A*s+R*o,z=R*A*s-P*o,L=A*A*s+a,t[0]=u*x+f*b+y*w,t[1]=l*x+d*b+v*w,t[2]=h*x+p*b+_*w,t[3]=c*x+m*b+g*w,t[4]=u*M+f*E+y*S,t[5]=l*M+d*E+v*S,t[6]=h*M+p*E+_*S,t[7]=c*M+m*E+g*S,t[8]=u*T+f*z+y*L,t[9]=l*T+d*z+v*L,t[10]=h*T+p*z+_*L,t[11]=c*T+m*z+g*L,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},r.rotateX=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],h=e[9],c=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+l*n,t[5]=a*r+h*n,t[6]=s*r+c*n,t[7]=u*r+f*n,t[8]=l*r-o*n,t[9]=h*r-a*n,t[10]=c*r-s*n,t[11]=f*r-u*n,t},r.rotateY=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],a=e[1],s=e[2],u=e[3],l=e[8],h=e[9],c=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-l*n,t[1]=a*r-h*n,t[2]=s*r-c*n,t[3]=u*r-f*n,t[8]=o*n+l*r,t[9]=a*n+h*r,t[10]=s*n+c*r,t[11]=u*n+f*r,t},r.rotateZ=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],h=e[5],c=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+l*n,t[1]=a*r+h*n,t[2]=s*r+c*n,t[3]=u*r+f*n,t[4]=l*r-o*n,t[5]=h*r-a*n,t[6]=c*r-s*n,t[7]=f*r-u*n,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,i){var r,o,a,s=i[0],u=i[1],l=i[2],h=Math.sqrt(s*s+u*u+l*l);return Math.abs(h)<n.EPSILON?null:(h=1/h,s*=h,u*=h,l*=h,r=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=s*s*a+o,t[1]=u*s*a+l*r,t[2]=l*s*a-u*r,t[3]=0,t[4]=s*u*a-l*r,t[5]=u*u*a+o,t[6]=l*u*a+s*r,t[7]=0,t[8]=s*l*a+u*r,t[9]=u*l*a-s*r,t[10]=l*l*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},r.fromXRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,
t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=n+n,u=r+r,l=o+o,h=n*s,c=n*u,f=n*l,d=r*u,p=r*l,m=o*l,y=a*s,v=a*u,_=a*l;return t[0]=1-(d+m),t[1]=c+_,t[2]=f-v,t[3]=0,t[4]=c-_,t[5]=1-(h+m),t[6]=p+y,t[7]=0,t[8]=f+v,t[9]=p-y,t[10]=1-(h+d),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},r.fromRotationTranslationScale=function(t,e,i,n){var r=e[0],o=e[1],a=e[2],s=e[3],u=r+r,l=o+o,h=a+a,c=r*u,f=r*l,d=r*h,p=o*l,m=o*h,y=a*h,v=s*u,_=s*l,g=s*h,x=n[0],b=n[1],w=n[2];return t[0]=(1-(p+y))*x,t[1]=(f+g)*x,t[2]=(d-_)*x,t[3]=0,t[4]=(f-g)*b,t[5]=(1-(c+y))*b,t[6]=(m+v)*b,t[7]=0,t[8]=(d+_)*w,t[9]=(m-v)*w,t[10]=(1-(c+p))*w,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,i,n,r){var o=e[0],a=e[1],s=e[2],u=e[3],l=o+o,h=a+a,c=s+s,f=o*l,d=o*h,p=o*c,m=a*h,y=a*c,v=s*c,_=u*l,g=u*h,x=u*c,b=n[0],w=n[1],M=n[2],E=r[0],S=r[1],T=r[2];return t[0]=(1-(m+v))*b,t[1]=(d+x)*b,t[2]=(p-g)*b,t[3]=0,t[4]=(d-x)*w,t[5]=(1-(f+v))*w,t[6]=(y+_)*w,t[7]=0,t[8]=(p+g)*M,t[9]=(y-_)*M,t[10]=(1-(f+m))*M,t[11]=0,t[12]=i[0]+E-(t[0]*E+t[4]*S+t[8]*T),t[13]=i[1]+S-(t[1]*E+t[5]*S+t[9]*T),t[14]=i[2]+T-(t[2]*E+t[6]*S+t[10]*T),t[15]=1,t},r.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=i+i,s=n+n,u=r+r,l=i*a,h=n*a,c=n*s,f=r*a,d=r*s,p=r*u,m=o*a,y=o*s,v=o*u;return t[0]=1-c-p,t[1]=h+v,t[2]=f-y,t[3]=0,t[4]=h-v,t[5]=1-l-p,t[6]=d+m,t[7]=0,t[8]=f+y,t[9]=d-m,t[10]=1-l-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,i,n,r,o,a){var s=1/(i-e),u=1/(r-n),l=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(i+e)*s,t[9]=(r+n)*u,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t},r.perspective=function(t,e,i,n,r){var o=1/Math.tan(e/2),a=1/(n-r);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*a,t[15]=0,t},r.perspectiveFromFieldOfView=function(t,e,i,n){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(r+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(r-o)*l*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t},r.ortho=function(t,e,i,n,r,o,a){var s=1/(e-i),u=1/(n-r),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*u,t[14]=(a+o)*l,t[15]=1,t},r.lookAt=function(t,e,i,o){var a,s,u,l,h,c,f,d,p,m,y=e[0],v=e[1],_=e[2],g=o[0],x=o[1],b=o[2],w=i[0],M=i[1],E=i[2];return Math.abs(y-w)<n.EPSILON&&Math.abs(v-M)<n.EPSILON&&Math.abs(_-E)<n.EPSILON?r.identity(t):(f=y-w,d=v-M,p=_-E,m=1/Math.sqrt(f*f+d*d+p*p),f*=m,d*=m,p*=m,a=x*p-b*d,s=b*f-g*p,u=g*d-x*f,m=Math.sqrt(a*a+s*s+u*u),m?(m=1/m,a*=m,s*=m,u*=m):(a=0,s=0,u=0),l=d*u-p*s,h=p*a-f*u,c=f*s-d*a,m=Math.sqrt(l*l+h*h+c*c),m?(m=1/m,l*=m,h*=m,c*=m):(l=0,h=0,c=0),t[0]=a,t[1]=l,t[2]=f,t[3]=0,t[4]=s,t[5]=h,t[6]=d,t[7]=0,t[8]=u,t[9]=c,t[10]=p,t[11]=0,t[12]=-(a*y+s*v+u*_),t[13]=-(l*y+h*v+c*_),t[14]=-(f*y+d*v+p*_),t[15]=1,t)},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.exports=r},{"./common.js":117}],122:[function(t,e,i){var n=t("./common.js"),r=t("./mat3.js"),o=t("./vec3.js"),a=t("./vec4.js"),s={};s.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),i=o.fromValues(0,1,0);return function(n,r,a){var u=o.dot(r,a);return-.999999>u?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,i,r),o.normalize(t,t),s.setAxisAngle(n,t,Math.PI),n):u>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,r,a),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+u,s.normalize(n,n))}}(),s.setAxes=function(){var t=r.create();return function(e,i,n,r){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-i[0],t[5]=-i[1],t[8]=-i[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=a.clone,s.fromValues=a.fromValues,s.copy=a.copy,s.set=a.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,i){i*=.5;var n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t},s.add=a.add,s.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=i[0],u=i[1],l=i[2],h=i[3];return t[0]=n*h+a*s+r*l-o*u,t[1]=r*h+a*u+o*s-n*l,t[2]=o*h+a*l+n*u-r*s,t[3]=a*h-n*s-r*u-o*l,t},s.mul=s.multiply,s.scale=a.scale,s.rotateX=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(i),u=Math.cos(i);return t[0]=n*u+a*s,t[1]=r*u+o*s,t[2]=o*u-r*s,t[3]=a*u-n*s,t},s.rotateY=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(i),u=Math.cos(i);return t[0]=n*u-o*s,t[1]=r*u+a*s,t[2]=o*u+n*s,t[3]=a*u-r*s,t},s.rotateZ=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(i),u=Math.cos(i);return t[0]=n*u+r*s,t[1]=r*u-n*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t},s.calculateW=function(t,e){var i=e[0],n=e[1],r=e[2];return t[0]=i,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t},s.dot=a.dot,s.lerp=a.lerp,s.slerp=function(t,e,i,n){var r,o,a,s,u,l=e[0],h=e[1],c=e[2],f=e[3],d=i[0],p=i[1],m=i[2],y=i[3];return o=l*d+h*p+c*m+f*y,0>o&&(o=-o,d=-d,p=-p,m=-m,y=-y),1-o>1e-6?(r=Math.acos(o),a=Math.sin(r),s=Math.sin((1-n)*r)/a,u=Math.sin(n*r)/a):(s=1-n,u=n),t[0]=s*l+u*d,t[1]=s*h+u*p,t[2]=s*c+u*m,t[3]=s*f+u*y,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(i,n,r,o,a,u){return s.slerp(t,n,a,u),s.slerp(e,r,o,u),s.slerp(i,t,e,2*u*(1-u)),i}}(),s.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=i*i+n*n+r*r+o*o,s=a?1/a:0;return t[0]=-i*s,t[1]=-n*s,t[2]=-r*s,t[3]=o*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=a.length,s.len=s.length,s.squaredLength=a.squaredLength,s.sqrLen=s.squaredLength,s.normalize=a.normalize,s.fromMat3=function(t,e){var i,n=e[0]+e[4]+e[8];if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,a=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*a+a]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*o+a]-e[3*a+o])*i,t[o]=(e[3*o+r]+e[3*r+o])*i,t[a]=(e[3*a+r]+e[3*r+a])*i}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=s},{"./common.js":117,"./mat3.js":120,"./vec3.js":124,"./vec4.js":125}],123:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var i=new n.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,i){return t[0]=e,t[1]=i,t},r.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},r.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},r.sub=r.subtract,r.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},r.mul=r.multiply,r.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},r.div=r.divide,r.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},r.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},r.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},r.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t},r.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},r.dist=r.distance,r.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},r.len=r.length,r.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var i=e[0],n=e[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t},r.lerp=function(t,e,i,n){var r=e[0],o=e[1];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t},r.random=function(t,e){e=e||1;var i=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},r.transformMat2=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r,t[1]=i[1]*n+i[3]*r,t},r.transformMat2d=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t},r.transformMat3=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[3]*r+i[6],t[1]=i[1]*n+i[4]*r+i[7],t},r.transformMat4=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t},r.forEach=function(){var t=r.create();return function(e,i,n,r,o,a){var s,u;for(i||(i=2),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,s=n;u>s;s+=i)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}(),r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exports=r},{"./common.js":117}],124:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.fromValues=function(t,e,i){var r=new n.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=i,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t},r.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},r.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},r.sub=r.subtract,r.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t},r.mul=r.multiply,r.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},r.div=r.divide,r.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},r.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},r.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},r.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t},r.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)},r.dist=r.distance,r.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)},r.len=r.length,r.squaredLength=function(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},r.cross=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[0],s=i[1],u=i[2];return t[0]=r*u-o*s,t[1]=o*a-n*u,t[2]=n*s-r*a,t},r.lerp=function(t,e,i,n){var r=e[0],o=e[1],a=e[2];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=a+n*(i[2]-a),t},r.hermite=function(t,e,i,n,r,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,l=a*(o-1),h=a*(3-2*o);return t[0]=e[0]*s+i[0]*u+n[0]*l+r[0]*h,t[1]=e[1]*s+i[1]*u+n[1]*l+r[1]*h,t[2]=e[2]*s+i[2]*u+n[2]*l+r[2]*h,t},r.bezier=function(t,e,i,n,r,o){var a=1-o,s=a*a,u=o*o,l=s*a,h=3*o*s,c=3*u*a,f=u*o;return t[0]=e[0]*l+i[0]*h+n[0]*c+r[0]*f,t[1]=e[1]*l+i[1]*h+n[1]*c+r[1]*f,t[2]=e[2]*l+i[2]*h+n[2]*c+r[2]*f,t},r.random=function(t,e){e=e||1;var i=2*n.RANDOM()*Math.PI,r=2*n.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(i)*o,t[1]=Math.sin(i)*o,t[2]=r*e,t},r.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[3]*n+i[7]*r+i[11]*o+i[15];return a=a||1,t[0]=(i[0]*n+i[4]*r+i[8]*o+i[12])/a,t[1]=(i[1]*n+i[5]*r+i[9]*o+i[13])/a,t[2]=(i[2]*n+i[6]*r+i[10]*o+i[14])/a,t},r.transformMat3=function(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=n*i[0]+r*i[3]+o*i[6],t[1]=n*i[1]+r*i[4]+o*i[7],t[2]=n*i[2]+r*i[5]+o*i[8],t},r.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[0],s=i[1],u=i[2],l=i[3],h=l*n+s*o-u*r,c=l*r+u*n-a*o,f=l*o+a*r-s*n,d=-a*n-s*r-u*o;return t[0]=h*l+d*-a+c*-u-f*-s,t[1]=c*l+d*-s+f*-a-h*-u,t[2]=f*l+d*-u+h*-s-c*-a,t},r.rotateX=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},r.rotateY=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},r.rotateZ=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},r.forEach=function(){var t=r.create();return function(e,i,n,r,o,a){var s,u;for(i||(i=3),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,s=n;u>s;s+=i)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),r.angle=function(t,e){var i=r.fromValues(t[0],t[1],t[2]),n=r.fromValues(e[0],e[1],e[2]);r.normalize(i,i),r.normalize(n,n);var o=r.dot(i,n);return o>1?0:Math.acos(o)},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exports=r},{"./common.js":117}],125:[function(t,e,i){var n=t("./common.js"),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,i,r){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t},r.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},r.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t},r.sub=r.subtract,r.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},r.mul=r.multiply,r.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t},r.div=r.divide,r.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},r.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},r.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},r.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t},r.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(i*i+n*n+r*r+o*o)},r.dist=r.distance,r.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return i*i+n*n+r*r+o*o},r.sqrDist=r.squaredDistance,r.length=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)},r.len=r.length,r.squaredLength=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r},r.sqrLen=r.squaredLength,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=i*i+n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=i*a,t[1]=n*a,t[2]=r*a,t[3]=o*a),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.lerp=function(t,e,i,n){var r=e[0],o=e[1],a=e[2],s=e[3];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=a+n*(i[2]-a),t[3]=s+n*(i[3]-s),t},r.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),r.normalize(t,t),r.scale(t,t,e),t},r.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*a,t[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*a,t[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*a,t[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*a,t},r.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[0],s=i[1],u=i[2],l=i[3],h=l*n+s*o-u*r,c=l*r+u*n-a*o,f=l*o+a*r-s*n,d=-a*n-s*r-u*o;return t[0]=h*l+d*-a+c*-u-f*-s,t[1]=c*l+d*-s+f*-a-h*-u,t[2]=f*l+d*-u+h*-s-c*-a,t[3]=e[3],t},r.forEach=function(){var t=r.create();return function(e,i,n,r,o,a){var s,u;for(i||(i=4),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,s=n;u>s;s+=i)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=r},{"./common.js":117}],126:[function(t,e,i){i.read=function(t,e,i,n,r){var o,a,s=8*r-n-1,u=(1<<s)-1,l=u>>1,h=-7,c=i?r-1:0,f=i?-1:1,d=t[e+c];for(c+=f,o=d&(1<<-h)-1,d>>=-h,h+=s;h>0;o=256*o+t[e+c],c+=f,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=256*a+t[e+c],c+=f,h-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=l}return(d?-1:1)*a*Math.pow(2,o-n)},i.write=function(t,e,i,n,r,o){var a,s,u,l=8*o-r-1,h=(1<<l)-1,c=h>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,m=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+c>=1?f/u:f*Math.pow(2,1-c),e*u>=2&&(a++,u/=2),a+c>=h?(s=0,a=h):a+c>=1?(s=(e*u-1)*Math.pow(2,r),a+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,r),a=0));r>=8;t[i+d]=255&s,d+=p,s/=256,r-=8);for(a=a<<r|s,l+=r;l>0;t[i+d]=255&a,d+=p,a/=256,l-=8);t[i+d-p]|=128*m}},{}],127:[function(t,e,i){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],128:[function(t,e,i){function n(t){return function(){return t}}function r(t,e,i){return t*(1-i)+e*i}function o(t,e,i){for(var n=[],o=0;o<t.length;o++)n[o]=r(t[o],e[o],i);return n}i.interpolated=function(t){if(!t.stops)return n(t);var e=t.stops,i=t.base||1,a=Array.isArray(e[0][1])?o:r;return function(t){for(var n,r,o=0;o<e.length;o++){var s=e[o];if(s[0]<=t&&(n=s),s[0]>t){r=s;break}}if(n&&r){var u=r[0]-n[0],l=t-n[0],h=1===i?l/u:(Math.pow(i,l)-1)/(Math.pow(i,u)-1);return a(n[1],r[1],h)}return n?n[1]:r?r[1]:void 0}},i["piecewise-constant"]=function(t){if(!t.stops)return n(t);var e=t.stops;return function(t){for(var i=0;i<e.length;i++)if(e[i][0]>t)return e[0===i?0:i-1][1];return e[e.length-1][1]}}},{}],129:[function(t,e,i){var n=t("../../reference/latest.min.js"),r=t("./parsed");e.exports=function(t){return r(t,n)}},{"../../reference/latest.min.js":132,"./parsed":130}],130:[function(t,e,i){function n(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function r(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}var o=t("csscolorparser").parseCSSColor,a=t("util").format;e.exports=function(t,e){function i(t,e){var i={message:(t?t+": ":"")+a.apply(a,Array.prototype.slice.call(arguments,2))};null!==e&&void 0!==e&&e.__line__&&(i.line=e.__line__),c.push(i)}function s(t,r,o){var a=n(r);if("string"===a&&"@"===r[0]){if(e.$version>7)return i(t,r,"constants have been deprecated as of v8");if(!(r in l))return i(t,r,'constant "%s" not found',r);r=l[r],a=n(r)}if(o.function&&"object"===a)return s.function(t,r,o);if(o.type){var u=s[o.type];if(u)return u(t,r,o);o=e[o.type]}s.object(t,r,o)}function u(t){return function(e,r,o){var a=n(r);a!==t&&i(e,r,"%s expected, %s found",t,a),"minimum"in o&&r<o.minimum&&i(e,r,"%s is less than the minimum value %s",r,o.minimum),"maximum"in o&&r>o.maximum&&i(e,r,"%s is greater than the maximum value %s",r,o.maximum)}}var l=t.constants||{},h={},c=[];return s.constants=function(t,r){if(e.$version>7){if(r)return i(t,r,"constants have been deprecated as of v8")}else{var o=n(r);if("object"!==o)return i(t,r,"object expected, %s found",o);for(var a in r)"@"!==a[0]&&i(t+"."+a,r[a],'constants must start with "@"')}},s.source=function(t,n){if(!n.type)return void i(t,n,'"type" is required');switch(r(n.type)){case"vector":case"raster":if(s.object(t,n,e.source_tile),"url"in n)for(var o in n)["type","url","tileSize"].indexOf(o)<0&&i(t+"."+o,n[o],'a source with a "url" property may not include a "%s" property',o);break;case"geojson":s.object(t,n,e.source_geojson);break;case"video":s.object(t,n,e.source_video);break;case"image":s.object(t,n,e.source_image);break;default:s.enum(t+".type",n.type,{values:["vector","raster","geojson","video","image"]})}},s.layer=function(n,o){o.type||o.ref||i(n,o,'either "type" or "ref" is required');var a=r(o.type),u=r(o.ref);if(o.id&&(h[o.id]?i(n,o.id,'duplicate layer id "%s", previously used at line %d',o.id,h[o.id]):h[o.id]=o.id.__line__),"ref"in o){["type","source","source-layer","filter","layout"].forEach(function(t){t in o&&i(n,o[t],'"%s" is prohibited for ref layers',t)});var l;t.layers.forEach(function(t){t.id==u&&(l=t)}),l?l.ref?i(n,o.ref,"ref cannot reference another ref layer"):a=l.type:i(n,o.ref,'ref layer "%s" not found',u)}else if("background"!==a)if(o.source){var c=t.sources[o.source];c?"vector"==c.type&&"raster"==a?i(n,o.source,'layer "%s" requires a raster source',o.id):"raster"==c.type&&"raster"!=a?i(n,o.source,'layer "%s" requires a vector source',o.id):"vector"!=c.type||o["source-layer"]||i(n,o,'layer "%s" must specify a "source-layer"',o.id):i(n,o.source,'source "%s" not found',o.source)}else i(n,o,'missing required property "source"');s.object(n,o,e.layer,{filter:s.filter,layout:function(t,i){var n=e["layout_"+a];return a&&n&&s(t,i,n)},paint:function(t,i){var n=e["paint_"+a];return a&&n&&s(t,i,n)}})},s.object=function(t,r,o,a){a=a||{};var u=n(r);if("object"!==u)return i(t,r,"object expected, %s found",u);for(var l in r){var h=l.split(".")[0],c=o[h]||o["*"],f=h.match(/^(.*)-transition$/);c?(a[h]||s)((t?t+".":t)+l,r[l],c):f&&o[f[1]]&&o[f[1]].transition?s((t?t+".":t)+l,r[l],e.transition):""!==t&&1!==t.split(".").length&&i(t,r[l],'unknown property "%s"',l)}for(var d in o)o[d].required&&void 0===o[d].default&&void 0===r[d]&&i(t,r,'missing required property "%s"',d)},s.array=function(e,r,o,a){if("array"!==n(r))return i(e,r,"array expected, %s found",n(r));if(o.length&&r.length!==o.length)return i(e,r,"array length %d expected, length %d found",o.length,r.length);if(o["min-length"]&&r.length<o["min-length"])return i(e,r,"array length at least %d expected, length %d found",o["min-length"],r.length);var u={type:o.value};t.version<7&&(u.function=o.function),"object"===n(o.value)&&(u=o.value);for(var l=0;l<r.length;l++)(a||s)(e+"["+l+"]",r[l],u)},s.filter=function(t,o){var a;if("array"!==n(o))return i(t,o,"array expected, %s found",n(o));if(o.length<1)return i(t,o,"filter array must have at least 1 element");switch(s.enum(t+"[0]",o[0],e.filter_operator),r(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"==o[1]&&i(t,o,'"$type" cannot be use with operator "%s"',o[0]);case"==":case"!=":3!=o.length&&i(t,o,'filter array for operator "%s" must have 3 elements',o[0]);case"in":case"!in":o.length>=2&&(a=n(o[1]),"string"!==a?i(t+"[1]",o[1],"string expected, %s found",a):"@"===o[1][0]&&i(t+"[1]",o[1],"filter key cannot be a constant"));for(var u=2;u<o.length;u++)a=n(o[u]),"$type"==o[1]?s.enum(t+"["+u+"]",o[u],e.geometry_type):"string"===a&&"@"===o[u][0]?i(t+"["+u+"]",o[u],"filter value cannot be a constant"):"string"!==a&&"number"!==a&&"boolean"!==a&&i(t+"["+u+"]",o[u],"string, number, or boolean expected, %s found",a);break;case"any":case"all":case"none":for(u=1;u<o.length;u++)s.filter(t+"["+u+"]",o[u])}},s.function=function(t,r,o){s.object(t,r,e.function,{stops:function(t,e,r){var a=-1/0;s.array(t,e,r,function(t,e){return"array"!==n(e)?i(t,e,"array expected, %s found",n(e)):2!==e.length?i(t,e,"array length %d expected, length %d found",2,e.length):(s(t+"[0]",e[0],{type:"number"}),s(t+"[1]",e[1],o),void("number"===n(e[0])&&("piecewise-constant"===o.function&&e[0]%1!=0&&i(t+"[0]",e[0],"zoom level for piecewise-constant functions must be an integer"),e[0]<=a&&i(t+"[0]",e[0],"array stops must appear in ascending order and have no duplicates"),a=e[0])))}),"array"===n(e)&&0===e.length&&i(t,e,"array must have at least one stop")}})},s.enum=function(t,e,n){-1===n.values.indexOf(r(e))&&i(t,e,"expected one of [%s], %s found",n.values.join(", "),e)},s.color=function(t,e){var r=n(e);return"string"!==r?i(t,e,"color expected, %s found",r):null===o(e)?i(t,e,'color expected, "%s" found',e):void 0},s.number=u("number"),s.string=u("string"),s.boolean=u("boolean"),s["*"]=function(){},s("",t,e.$root),e.$version>7&&t.constants&&s.constants("constants",t.constants),c.sort(function(t,e){return t.line-e.line}),c}},{csscolorparser:107,util:143}],131:[function(t,e,i){e.exports=t("./v8.json")},{"./v8.json":133}],132:[function(t,e,i){e.exports=t("./v8.min.json")},{"./v8.min.json":134}],133:[function(t,e,i){e.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8],doc:"Stylesheet version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number",default:0,period:360,units:"degrees",doc:"Default bearing, in degrees.  The style bearing will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:29},pitch:{type:"number",default:0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface.  The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended.",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. Valid tokens are {fontstack} and {range}.",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties.",example:{duration:300,delay:0}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},sources:{"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For GeoJSON and video sources, a URL must be provided."}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"],doc:"The data type of the tile source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<mapid>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},"*":{type:"*",doc:"Other keys to configure the data source."}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"],doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number",default:14,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},buffer:{type:"number",default:64,doc:"Tile buffer size on each side (higher means fewer rendering artifacts near tile edges but slower performance)."},tolerance:{type:"number",default:3,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean",default:!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups."},clusterRadius:{type:"number",default:400,doc:"Radius of each cluster when clustering points, relative to 4096 tile."},clusterMaxZoom:{type:"number",doc:"Max zoom to cluster points on. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered)."}},source_video:{type:{required:!0,type:"enum",values:["video"],doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},source_image:{type:{required:!0,type:"enum",values:["image"],doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image"},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},layer:{id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"],doc:"Rendering type of this layer."},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},ref:{type:"string",doc:"References another layer to copy `type`, `source`, `source-layer`, `minzoom`, `maxzoom`, `filter`, and `layout` properties from. This allows the layers to share processing and be more efficient."},source:{type:"string",doc:"Name of a source description to be used for this layer."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required if the source supports multiple layers."},minzoom:{type:"number",minimum:0,maximum:22,doc:"The minimum zoom level on which the layer gets parsed and appears on."},maxzoom:{type:"number",minimum:0,maximum:22,
doc:"The maximum zoom level on which the layer gets parsed and appears on."},interactive:{type:"boolean",doc:"Enable querying of feature data from this layer for interactivity.",default:!1},filter:{type:"filter",doc:"A expression specifying conditions on source features. Only features that match the filter are displayed."},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."},"paint.*":{type:"paint",doc:"Class-specific paint properties for this layer. The class name is the part after the first dot."}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_fill:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_circle:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant",values:["butt","round","square"],default:"butt",doc:"The display of line endings."},"line-join":{type:"enum",function:"piecewise-constant",values:["bevel","round","miter"],default:"miter",doc:"The display of lines when joining."},"line-miter-limit":{type:"number",default:2,function:"interpolated",doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated",doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant",values:["point","line"],default:"point",doc:"Label placement relative to its geometry. `line` can only be used on LineStrings and Polygons."},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated",units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer."},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",doc:"Orientation of icon when map is rotated.",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated",doc:"Scale factor for icon. 1 is original size, 3 triples the size.",requires:["icon-image"]},"icon-image":{type:"string",function:"piecewise-constant",doc:"A string with {tokens} replaced, referencing the data property to pull from.",tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated",units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated",units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",doc:"Orientation of text when map is rotated.",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant",default:"",tokens:!0,doc:"Value to use for a text label. Feature properties are specified using tokens like {field_name}."},"text-font":{type:"array",value:"string",function:"piecewise-constant",default:["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated",doc:"Font size.",requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"em",function:"interpolated",doc:"The maximum line width for text wrapping.",requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"em",function:"interpolated",doc:"Text leading value for multi-line text.",requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"em",function:"interpolated",doc:"Text tracking amount.",requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant",values:["left","center","right"],default:"center",doc:"Text justification options.",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated",doc:"Rotates the text clockwise.",requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant",default:!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant",values:["none","uppercase","lowercase"],default:"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"]},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up.",value:"number",units:"ems",function:"interpolated",length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant",default:!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},layout_raster:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible",doc:"The display of this layer. `none` hides this layer."}},filter:{type:"array",value:"*",doc:"A filter selects specific features from a layer."},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none"],doc:"The filter operator."},geometry_type:{type:"enum",values:["Point","LineString","Polygon"],doc:"The geometry type for the filter to select."},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"],doc:"A color operation to apply."},function:{stops:{type:"array",required:!0,doc:"An array of stops.",value:"function_stop"},base:{type:"number",default:1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2,doc:"Zoom level and value pair."},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant",default:!0,doc:"Whether or not the fill should be antialiased."},"fill-opacity":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,doc:"The opacity given to the fill color.",transition:!0},"fill-color":{type:"color",default:"#000000",doc:"The color of the fill.",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"fill-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)",default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512)."}},paint_line:{"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",doc:"The color with which the line will be drawn.",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"line-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)",default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Stroke thickness."},"line-gap-width":{type:"number",default:0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.",function:"interpolated",transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,doc:'The line\'s offset perpendicular to its direction. Values may be positive or negative, where positive indicates "rightwards" (if you were moving in the direction of the line) and negative indicates "leftwards."',function:"interpolated",transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels."},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512)."}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Circle radius."},"circle-color":{type:"color",default:"#000000",doc:"The color of the circle.",function:"interpolated",transition:!0},"circle-blur":{type:"number",default:0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.",function:"interpolated",transition:!0},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively."},"circle-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen)",default:"map",requires:["circle-translate"]}},paint_symbol:{"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,doc:"The color of the icon. This can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with sdf icons.",requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).",default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["text-field"]},"text-color":{type:"color",doc:"The color with which the text will be drawn.",default:"#000000",function:"interpolated",transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],doc:"Control whether the translation is relative to the map (north) or viewport (screen).",default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated",transition:!0,units:"degrees",doc:"Rotates hues around the color wheel."},"raster-brightness-min":{type:"number",function:"interpolated",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.",default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.",default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated",transition:!0,units:"milliseconds",doc:"Fade duration when a new tile is added."}},paint_background:{"background-color":{type:"color",default:"#000000",doc:"The color with which the background will be drawn.",function:"interpolated",transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant",transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512)."},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.",function:"interpolated",transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number",default:0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}}}},{}],134:[function(t,e,i){e.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_tile","source_geojson","source_video","source_image"],source_tile:{type:{required:!0,type:"enum",values:["vector","raster"]},url:{type:"string"},tiles:{type:"array",value:"string"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:["geojson"]},data:{type:"*"},maxzoom:{type:"number",default:14},buffer:{type:"number",default:64},tolerance:{type:"number",default:3},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:400},clusterMaxZoom:{type:"number"}},source_video:{type:{required:!0,type:"enum",values:["video"]},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:["image"]},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:["fill","line","symbol","circle","raster","background"]},metadata:{type:"*"},ref:{type:"string"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:22},maxzoom:{type:"number",minimum:0,maximum:22},interactive:{type:"boolean",default:!1},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"},"paint.*":{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_fill:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_circle:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",function:"piecewise-constant",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated",requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated",requires:[{"line-join":"round"}]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated",units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant",default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated",requires:["icon-image"]},"icon-image":{type:"string",function:"piecewise-constant",tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated",units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated",units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",requires:["icon-image"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"viewport",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant",default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated",requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"em",function:"interpolated",requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"em",function:"interpolated",requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"em",function:"interpolated",requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant",values:["left","center","right"],default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated",requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated",requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated",requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant",values:["none","uppercase","lowercase"],default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated",length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant",default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant",default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant",default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},layout_raster:{visibility:{type:"enum",function:"piecewise-constant",values:["visible","none"],default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:["==","!=",">",">=","<","<=","in","!in","all","any","none"]},geometry_type:{type:"enum",values:["Point","LineString","Polygon"]},color_operation:{type:"enum",values:["lighten","saturate","spin","fade","mix"]},function:{stops:{type:"array",required:!0,value:"function_stop"},base:{type:"number",default:1,minimum:0}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},paint:["paint_fill","paint_line","paint_circle","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant",default:!0},"fill-opacity":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant",transition:!0}},paint_line:{"line-opacity":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated",transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant",transition:!0}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated",transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated",transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated",transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["circle-translate"]}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated",transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated",transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant",values:["map","viewport"],default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated",transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated",transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated",default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated",default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated",transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated",transition:!0,units:"milliseconds"}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated",transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant",transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,
function:"interpolated",transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}}}},{}],135:[function(t,e,i){function n(t){var e;t&&t.length&&(e=t,t=e.length);var i=new Uint8Array(t||0);return e&&i.set(e),i.readUInt32LE=o.readUInt32LE,i.writeUInt32LE=o.writeUInt32LE,i.readInt32LE=o.readInt32LE,i.writeInt32LE=o.writeInt32LE,i.readFloatLE=o.readFloatLE,i.writeFloatLE=o.writeFloatLE,i.readDoubleLE=o.readDoubleLE,i.writeDoubleLE=o.writeDoubleLE,i.toString=o.toString,i.write=o.write,i.slice=o.slice,i.copy=o.copy,i._isBuffer=!0,i}function r(t){for(var e,i,n=t.length,r=[],o=0;n>o;o++){if((e=t.charCodeAt(o))>55295&&57344>e){if(!i){e>56319||o+1===n?r.push(239,191,189):i=e;continue}if(56320>e){r.push(239,191,189),i=e;continue}e=i-55296<<10|e-56320|65536,i=null}else i&&(r.push(239,191,189),i=null);128>e?r.push(e):2048>e?r.push(e>>6|192,63&e|128):65536>e?r.push(e>>12|224,e>>6&63|128,63&e|128):r.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}return r}e.exports=n;var o,a,s,u=t("ieee754");o={readUInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},writeUInt32LE:function(t,e){this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24},readInt32LE:function(t){return(this[t]|this[t+1]<<8|this[t+2]<<16)+(this[t+3]<<24)},readFloatLE:function(t){return u.read(this,t,!0,23,4)},readDoubleLE:function(t){return u.read(this,t,!0,52,8)},writeFloatLE:function(t,e){return u.write(this,t,e,!0,23,4)},writeDoubleLE:function(t,e){return u.write(this,t,e,!0,52,8)},toString:function(t,e,i){var n="",r="";e=e||0,i=Math.min(this.length,i||this.length);for(var o=e;i>o;o++){var a=this[o];127>=a?(n+=decodeURIComponent(r)+String.fromCharCode(a),r=""):r+="%"+a.toString(16)}return n+=decodeURIComponent(r)},write:function(t,e){for(var i=t===a?s:r(t),n=0;n<i.length;n++)this[e+n]=i[n]},slice:function(t,e){return this.subarray(t,e)},copy:function(t,e){e=e||0;for(var i=0;i<this.length;i++)t[e+i]=this[i]}},o.writeInt32LE=o.writeUInt32LE,n.byteLength=function(t){return a=t,s=r(t),s.length},n.isBuffer=function(t){return!(!t||!t._isBuffer)}},{ieee754:126}],136:[function(t,e,i){(function(i){function n(t){this.buf=d.isBuffer(t)?t:new d(t||0),this.pos=0,this.length=this.buf.length}function r(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function o(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function a(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function s(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function u(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function l(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function h(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function c(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}e.exports=n;var d=i.Buffer||t("./buffer");n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var p=Math.pow(2,63);n.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,o=this.pos;t(r,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=this.buf.readUInt32LE(this.pos);return this.pos+=4,t},readSFixed32:function(){var t=this.buf.readInt32LE(this.pos);return this.pos+=4,t},readFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readUInt32LE(this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readInt32LE(this.pos+4);return this.pos+=8,t},readFloat:function(){var t=this.buf.readFloatLE(this.pos);return this.pos+=4,t},readDouble:function(){var t=this.buf.readDoubleLE(this.pos);return this.pos+=8,t},readVarint:function(){var t,e,i,n,r,o,a=this.buf;if(128>(i=a[this.pos++]))return i;if(i&=127,128>(n=a[this.pos++]))return i|n<<7;if(n=(127&n)<<7,128>(r=a[this.pos++]))return i|n|r<<14;if(r=(127&r)<<14,128>(o=a[this.pos++]))return i|n|r|o<<21;if(t=i|n|r|(127&o)<<21,e=a[this.pos++],t+=268435456*(127&e),128>e)return t;if(e=a[this.pos++],t+=34359738368*(127&e),128>e)return t;if(e=a[this.pos++],t+=4398046511104*(127&e),128>e)return t;if(e=a[this.pos++],t+=562949953421312*(127&e),128>e)return t;if(e=a[this.pos++],t+=72057594037927940*(127&e),128>e)return t;if(e=a[this.pos++],t+=0x8000000000000000*(127&e),128>e)return t;throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){var t=this.pos,e=this.readVarint();if(p>e)return e;for(var i=this.pos-2;255===this.buf[i];)i--;t>i&&(i=t),e=0;for(var n=0;i-t+1>n;n++){var r=127&~this.buf[t+n];e+=4>n?r<<7*n:r*Math.pow(2,7*n)}return-e-1},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.buf.toString("utf8",this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.slice(this.pos,t);return this.pos=t,e},readPackedVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readVarint());return e},readPackedSVarint:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(){for(var t=this.readVarint()+this.pos,e=[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(t){var e=7&t;if(e===n.Varint)for(;this.buf[this.pos++]>127;);else if(e===n.Bytes)this.pos=this.readVarint()+this.pos;else if(e===n.Fixed32)this.pos+=4;else{if(e!==n.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new d(e);this.buf.copy(i),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.slice(0,this.length)},writeFixed32:function(t){this.realloc(4),this.buf.writeUInt32LE(t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),this.buf.writeInt32LE(t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeUInt32LE(Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),this.buf.writeInt32LE(-1&t,this.pos),this.buf.writeInt32LE(Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){if(127>=(t=+t))this.realloc(1),this.buf[this.pos++]=t;else if(16383>=t)this.realloc(2),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127;else if(2097151>=t)this.realloc(3),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127|128,this.buf[this.pos++]=t>>>14&127;else if(268435455>=t)this.realloc(4),this.buf[this.pos++]=t>>>0&127|128,this.buf[this.pos++]=t>>>7&127|128,this.buf[this.pos++]=t>>>14&127|128,this.buf[this.pos++]=t>>>21&127;else{for(var e=this.pos;t>=128;)this.realloc(1),this.buf[this.pos++]=255&t|128,t/=128;if(this.realloc(1),this.buf[this.pos++]=0|t,this.pos-e>10)throw new Error("Given varint doesn't fit into 10 bytes")}},writeSVarint:function(t){this.writeVarint(0>t?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t);var e=d.byteLength(t);this.writeVarint(e),this.realloc(e),this.buf.write(t,this.pos),this.pos+=e},writeFloat:function(t){this.realloc(4),this.buf.writeFloatLE(t,this.pos),this.pos+=4},writeDouble:function(t){this.realloc(8),this.buf.writeDoubleLE(t,this.pos),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;e>i;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i,r=127>=n?1:16383>=n?2:2097151>=n?3:268435455>=n?4:Math.ceil(Math.log(n)/(7*Math.LN2));if(r>1){this.realloc(r-1);for(var o=this.pos-1;o>=i;o--)this.buf[o+r-1]=this.buf[o]}this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,n.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){this.writeMessage(t,r,e)},writePackedSVarint:function(t,e){this.writeMessage(t,o,e)},writePackedBoolean:function(t,e){this.writeMessage(t,u,e)},writePackedFloat:function(t,e){this.writeMessage(t,a,e)},writePackedDouble:function(t,e){this.writeMessage(t,s,e)},writePackedFixed32:function(t,e){this.writeMessage(t,l,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,h,e)},writePackedFixed64:function(t,e){this.writeMessage(t,c,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,f,e)},writeBytesField:function(t,e){this.writeTag(t,n.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,n.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,n.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,n.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./buffer":135}],137:[function(t,e,i){function n(t,e){this.x=t,this.y=e}e.exports=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.x-i*this.y,r=i*this.x+e*this.y;return this.x=n,this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t}},{}],138:[function(t,e,i){function n(){h=!1,s.length?l=s.concat(l):c=-1,l.length&&r()}function r(){if(!h){var t=setTimeout(n);h=!0;for(var e=l.length;e;){for(s=l,l=[];++c<e;)s&&s[c].run();c=-1,e=l.length}s=null,h=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function a(){}var s,u=e.exports={},l=[],h=!1,c=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new o(t,e)),1!==l.length||h||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=a,u.addListener=a,u.once=a,u.off=a,u.removeListener=a,u.removeAllListeners=a,u.emit=a,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],139:[function(e,i,n){!function(){function e(t,i){return this instanceof e?(this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&this._initFormat(i),void this.clear()):new e(t,i)}function n(t,e){t.bbox=r(t,0,t.children.length,e)}function r(t,e,i,n){for(var r,s=o(),u=e;i>u;u++)r=t.children[u],a(s,t.leaf?n(r):r.bbox);return s}function o(){return[1/0,1/0,-1/0,-1/0]}function a(t,e){return t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t}function s(t,e){return t.bbox[0]-e.bbox[0]}function u(t,e){return t.bbox[1]-e.bbox[1]}function l(t){return(t[2]-t[0])*(t[3]-t[1])}function h(t){return t[2]-t[0]+(t[3]-t[1])}function c(t,e){return(Math.max(e[2],t[2])-Math.min(e[0],t[0]))*(Math.max(e[3],t[3])-Math.min(e[1],t[1]))}function f(t,e){var i=Math.max(t[0],e[0]),n=Math.max(t[1],e[1]),r=Math.min(t[2],e[2]),o=Math.min(t[3],e[3]);return Math.max(0,r-i)*Math.max(0,o-n)}function d(t,e){return t[0]<=e[0]&&t[1]<=e[1]&&e[2]<=t[2]&&e[3]<=t[3]}function p(t,e){return e[0]<=t[2]&&e[1]<=t[3]&&e[2]>=t[0]&&e[3]>=t[1]}function m(t,e,i,n,r){for(var o,a=[e,i];a.length;)i=a.pop(),e=a.pop(),n>=i-e||(o=e+Math.ceil((i-e)/n/2)*n,y(t,e,i,o,r),a.push(e,o,o,i))}function y(t,e,i,n,r){for(var o,a,s,u,l,h,c,f,d;i>e;){for(i-e>600&&(o=i-e+1,a=n-e+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(0>a-o/2?-1:1),h=Math.max(e,Math.floor(n-a*u/o+l)),c=Math.min(i,Math.floor(n+(o-a)*u/o+l)),y(t,h,c,n,r)),f=t[n],a=e,d=i,v(t,e,n),r(t[i],f)>0&&v(t,e,i);d>a;){for(v(t,a,d),a++,d--;r(t[a],f)<0;)a++;for(;r(t[d],f)>0;)d--}0===r(t[e],f)?v(t,e,d):(d++,v(t,d,i)),n>=d&&(e=d+1),d>=n&&(i=d-1)}}function v(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!p(t,e.bbox))return i;for(var r,o,a,s,u=[];e;){for(r=0,o=e.children.length;o>r;r++)a=e.children[r],s=e.leaf?n(a):a.bbox,p(t,s)&&(e.leaf?i.push(a):d(t,s)?this._all(a,i):u.push(a));e=u.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!p(t,e.bbox))return!1;for(var n,r,o,a,s=[];e;){for(n=0,r=e.children.length;r>n;n++)if(o=e.children[n],a=e.leaf?i(o):o.bbox,p(t,a)){if(e.leaf||d(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;i>e;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data={children:[],height:1,bbox:o(),leaf:!0},this},remove:function(t){if(!t)return this;for(var e,i,n,r,o=this.data,a=this.toBBox(t),s=[],u=[];o||s.length;){if(o||(o=s.pop(),i=s[s.length-1],e=u.pop(),r=!0),o.leaf&&-1!==(n=o.children.indexOf(t)))return o.children.splice(n,1),s.push(o),this._condense(s),this;r||o.leaf||!d(o.bbox,a)?i?(e++,o=i.children[e],r=!1):o=null:(s.push(o),u.push(e),e=0,i=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:function(t,e){return t[0]-e[0]},compareMinY:function(t,e){return t[1]-e[1]},toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,r){var o,a=i-e+1,s=this._maxEntries;if(s>=a)return o={children:t.slice(e,i+1),height:1,bbox:null,leaf:!0},n(o,this.toBBox),o;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),o={children:[],height:r,bbox:null,leaf:!1};var u,l,h,c,f=Math.ceil(a/s),d=f*Math.ceil(Math.sqrt(s));for(m(t,e,i,d,this.compareMinX),u=e;i>=u;u+=d)for(h=Math.min(u+d-1,i),m(t,u,h,f,this.compareMinY),l=u;h>=l;l+=f)c=Math.min(l+f-1,h),o.children.push(this._build(t,l,c,r-1));return n(o,this.toBBox),o},_chooseSubtree:function(t,e,i,n){for(var r,o,a,s,u,h,f,d;n.push(e),!e.leaf&&n.length-1!==i;){for(f=d=1/0,r=0,o=e.children.length;o>r;r++)a=e.children[r],u=l(a.bbox),h=c(t,a.bbox)-u,d>h?(d=h,f=f>u?u:f,s=a):h===d&&f>u&&(f=u,s=a);e=s}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t.bbox:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),a(s.bbox,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],r=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,r);var a=this._chooseSplitIndex(i,o,r),s={children:i.children.splice(a,i.children.length-a),height:i.height,bbox:null,leaf:!1};i.leaf&&(s.leaf=!0),n(i,this.toBBox),n(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(t,e){this.data={children:[t,e],height:t.height+1,bbox:null,leaf:!1},n(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,o,a,s,u,h,c,d;for(h=c=1/0,n=e;i-e>=n;n++)o=r(t,0,n,this.toBBox),a=r(t,n,i,this.toBBox),s=f(o,a),u=l(o)+l(a),h>s?(h=s,d=n,c=c>u?u:c):s===h&&c>u&&(c=u,d=n);return d},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:s,r=t.leaf?this.compareMinY:u,o=this._allDistMargin(t,e,i,n);this._allDistMargin(t,e,i,r)>o&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var o,s,u=this.toBBox,l=r(t,0,e,u),c=r(t,i-e,i,u),f=h(l)+h(c);for(o=e;i-e>o;o++)s=t.children[o],a(l,t.leaf?u(s):s.bbox),f+=h(l);for(o=i-e-1;o>=e;o--)s=t.children[o],a(c,t.leaf?u(s):s.bbox),f+=h(c);return f},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)a(e[n].bbox,t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children,e.splice(e.indexOf(t[i]),1)):this.clear():n(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return [a"+t.join(", a")+"];")}},"function"==typeof t&&t.amd?t("rbush",function(){return e}):void 0!==i?i.exports=e:"undefined"!=typeof self?self.rbush=e:window.rbush=e}()},{}],140:[function(e,i,n){!function(e,r){"function"==typeof t&&t.amd?t(r):"object"==typeof n?i.exports=r():e.resolveUrl=r()}(this,function(){function t(){var t=arguments.length;if(0===t)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===t)return e.href;var i=document.getElementsByTagName("head")[0];i.insertBefore(e,i.firstChild);for(var n,r=document.createElement("a"),o=1;t>o;o++)r.href=arguments[o],n=r.href,e.href=n;return i.removeChild(e),n}return t})},{}],141:[function(t,e,i){function n(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=i,this.p2y=n}e.exports=n,n.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},n.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},n.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},n.prototype.solveCurveX=function(t,e){void 0===e&&(e=1e-6);var i,n,r,o,a;for(r=t,a=0;8>a;a++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r-=o/s}if(i=0,n=1,r=t,i>r)return i;if(r>n)return n;for(;n>i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?i=r:n=r,r=.5*(n-i)+i}return r},n.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},{}],142:[function(t,e,i){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],143:[function(t,e,i){(function(e,n){function r(t,e){var n={seen:[],stylize:a};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(e)?n.showHidden=e:e&&i._extend(n,e),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),u(n,t,n.depth)}function o(t,e){var i=r.styles[e];return i?"["+r.colors[i][0]+"m"+t+"["+r.colors[i][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,i){e[t]=!0}),e}function u(t,e,n){if(t.customInspect&&e&&T(e.inspect)&&e.inspect!==i.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(n,t);return g(r)||(r=u(t,r,n)),r}var o=l(t,e);if(o)return o;var a=Object.keys(e),m=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),S(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(e);if(0===a.length){if(T(e)){var y=e.name?": "+e.name:"";return t.stylize("[Function"+y+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(E(e))return t.stylize(Date.prototype.toString.call(e),"date");if(S(e))return h(e)}var v="",_=!1,x=["{","}"];if(p(e)&&(_=!0,x=["[","]"]),T(e)){v=" [Function"+(e.name?": "+e.name:"")+"]"}if(w(e)&&(v=" "+RegExp.prototype.toString.call(e)),E(e)&&(v=" "+Date.prototype.toUTCString.call(e)),S(e)&&(v=" "+h(e)),0===a.length&&(!_||0==e.length))return x[0]+v+x[1];if(0>n)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var b;return b=_?c(t,e,n,m,a):a.map(function(i){return f(t,e,n,m,i,_)}),t.seen.pop(),d(b,v,x)}function l(t,e){if(b(e))return t.stylize("undefined","undefined");if(g(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return _(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):y(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function c(t,e,i,n,r){for(var o=[],a=0,s=e.length;s>a;++a)A(e,String(a))?o.push(f(t,e,i,n,String(a),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(f(t,e,i,n,r,!0))}),o}function f(t,e,i,n,r,o){var a,s,l;if(l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},l.get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),A(n,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?(s=y(i)?u(t,l.value,null):u(t,l.value,i-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),b(a)){if(o&&r.match(/^\d+$/))return s;a=JSON.stringify(""+r),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t,e,i){var n=0;return t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}function p(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function y(t){return null===t}function v(t){return null==t}function _(t){return"number"==typeof t}function g(t){return"string"==typeof t}function x(t){return"symbol"==typeof t}function b(t){return void 0===t}function w(t){return M(t)&&"[object RegExp]"===L(t)}function M(t){return"object"==typeof t&&null!==t}function E(t){return M(t)&&"[object Date]"===L(t)}function S(t){return M(t)&&("[object Error]"===L(t)||t instanceof Error)}function T(t){return"function"==typeof t}function z(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t}function L(t){return Object.prototype.toString.call(t)}function P(t){return 10>t?"0"+t.toString(10):t.toString(10)}function R(){var t=new Date,e=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":");return[t.getDate(),k[t.getMonth()],e].join(" ")}function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}i.format=function(t){if(!g(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(r(arguments[i]));return e.join(" ")}for(var i=1,n=arguments,o=n.length,a=String(t).replace(/%[sdj%]/g,function(t){if("%%"===t)return"%";if(i>=o)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}default:return t}}),s=n[i];o>i;s=n[++i])a+=y(s)||!M(s)?" "+s:" "+r(s);return a},i.deprecate=function(t,r){function o(){if(!a){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),a=!0}return t.apply(this,arguments)}if(b(n.process))return function(){return i.deprecate(t,r).apply(this,arguments)};if(!0===e.noDeprecation)return t;var a=!1;return o};var I,D={};i.debuglog=function(t){if(b(I)&&(I=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(I)){var n=e.pid;D[t]=function(){var e=i.format.apply(i,arguments);console.error("%s %d: %s",t,n,e)}}else D[t]=function(){};return D[t]},i.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=p,i.isBoolean=m,i.isNull=y,i.isNullOrUndefined=v,i.isNumber=_,i.isString=g,i.isSymbol=x,i.isUndefined=b,i.isRegExp=w,i.isObject=M,i.isDate=E,i.isError=S,i.isFunction=T,i.isPrimitive=z,i.isBuffer=t("./support/isBuffer");var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",R(),i.format.apply(i,arguments))},i.inherits=t("inherits"),i._extend=function(t,e){if(!e||!M(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":142,_process:138,inherits:127}],144:[function(t,e,i){e.exports.VectorTile=t("./lib/vectortile.js"),e.exports.VectorTileFeature=t("./lib/vectortilefeature.js"),e.exports.VectorTileLayer=t("./lib/vectortilelayer.js")},{"./lib/vectortile.js":145,"./lib/vectortilefeature.js":147,"./lib/vectortilelayer.js":148}],145:[function(t,e,i){function n(t,e){this.layers=t.readFields(r,{},e)}function r(t,e,i){if(3===t){var n=new o(i,i.readVarint()+i.pos);n.length&&(e[n.name]=n)}}var o=t("./vectortilelayer");e.exports=n},{"./vectortilelayer":148}],146:[function(t,e,i){function n(t){this.feature=t,this.finalRatio=4096/t.extent*Math.pow(2,t.dz);var e=64;e/=this.finalRatio;var i=t.extent>>t.dz;e>i&&(e=i),this.dz=t.dz,this.margin=e,this.xmin=i*t.xPos-e,this.ymin=i*t.yPos-e,this.xmax=this.xmin+i+2*e,this.ymax=this.ymin+i+2*e,this.lines=[],this._prevIsIn=!1,this.type=t.type}var r=t("point-geometry");e.exports=n,n.prototype.loadGeometry=function(){var t=this.feature._pbf;t.pos=this.feature._geometry;for(var e=t.readVarint()+t.pos,i=1,n=0,r=0,o=0;t.pos<e;){if(!n){var a=t.readVarint();i=7&a,n=a>>3}if(n--,1===i||2===i)r+=t.readSVarint(),o+=t.readSVarint(),1===i?this.moveTo(r,o):this.lineTo(r,o);else{if(7!==i)throw new Error("unknown command "+i);this.closePolygon()}}return this.result()},n.prototype.moveTo=function(t,e){this._push_line(),this._prevIsIn=this._isIn(t,e),this._moveTo(t,e,this._prevIsIn),this._prevPt=new r(t,e),this._firstPt=new r(t,e)},n.prototype.lineTo=function(t,e){var i,n,o,a,s,u,l,h,c,f,d,p,m=this._isIn(t,e);if(m)this._prevIsIn?this._lineTo(t,e,!0):(i=this._prevPt,n=new r(t,e),o=this._intersect(n,i),this._lineTo(o.x,o.y,!0),this._lineTo(n.x,n.y,!0));else if(this._prevIsIn)n=this._prevPt,i=new r(t,e),o=this._intersect(n,i),this._lineTo(o.x,o.y,!0),this._lineTo(i.x,i.y,!1);else if(a=this._prevPt,s=new r(t,e),a.x<=this.xmin&&s.x<=this.xmin||a.x>=this.xmax&&s.x>=this.xmax||a.y<=this.ymin&&s.y<=this.ymin||a.y>=this.ymax&&s.y>=this.ymax)this._lineTo(s.x,s.y,!1);else{if(h=[],(a.x<this.xmin&&s.x>this.xmin||a.x>this.xmin&&s.x<this.xmin)&&(u=(this.xmin-a.x)/(s.x-a.x),p=a.y+u*(s.y-a.y),p<=this.ymin?f=!1:p>=this.ymax?f=!0:(l={},l.ratio=u,l.x=this.xmin,l.y=p,h.push(l))),(a.x<this.xmax&&s.x>this.xmax||a.x>this.xmax&&s.x<this.xmax)&&(u=(this.xmax-a.x)/(s.x-a.x),p=a.y+u*(s.y-a.y),p<=this.ymin?f=!1:p>=this.ymax?f=!0:(l={},l.ratio=u,l.x=this.xmax,l.y=p,h.push(l))),(a.y<this.ymin&&s.y>this.ymin||a.y>this.ymin&&s.y<this.ymin)&&(u=(this.ymin-a.y)/(s.y-a.y),d=a.x+u*(s.x-a.x),d<=this.xmin?c=!1:d>=this.xmax?c=!0:(l={},l.ratio=u,l.x=d,l.y=this.ymin,h.push(l))),(a.y<this.ymax&&s.y>this.ymax||a.y>this.ymax&&s.y<this.ymax)&&(u=(this.ymax-a.y)/(s.y-a.y),d=a.x+u*(s.x-a.x),d<=this.xmin?c=!1:d>=this.xmax?c=!0:(l={},l.ratio=u,l.x=d,l.y=this.ymax,h.push(l))),0===h.length)c?f?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):f?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(h.length>1&&h[0].ratio>h[1].ratio)this._lineTo(h[1].x,h[1].y,!0),this._lineTo(h[0].x,h[0].y,!0);else for(var y=0;y<h.length;y++)this._lineTo(h[y].x,h[y].y,!0);this._lineTo(s.x,s.y,!1)}this._prevIsIn=m,this._prevPt=new r(t,e)},n.prototype.closePolygon=function(){var t,e;this.line.length>0&&(t=this._firstPt,e=this._prevPt,(t.x!==e.x||t.y!==e.y)&&this.lineTo(t.x,t.y))},n.prototype.result=function(){return this._push_line(),0===this.lines.length?null:this.lines},n.prototype._isIn=function(t,e){return t>=this.xmin&&t<=this.xmax&&e>=this.ymin&&e<=this.ymax},n.prototype._intersect=function(t,e){var i,n,o,a;return e.x>=this.xmin&&e.x<=this.xmax?(n=e.y<=this.ymin?this.ymin:this.ymax,i=t.x+(n-t.y)/(e.y-t.y)*(e.x-t.x)):e.y>=this.ymin&&e.y<=this.ymax?(i=e.x<=this.xmin?this.xmin:this.xmax,n=t.y+(i-t.x)/(e.x-t.x)*(e.y-t.y)):(n=e.y<=this.ymin?this.ymin:this.ymax,i=e.x<=this.xmin?this.xmin:this.xmax,o=(i-t.x)/(e.x-t.x),a=(n-t.y)/(e.y-t.y),a>o?n=t.y+o*(e.y-t.y):i=t.x+a*(e.x-t.x)),new r(i,n)},n.prototype._push_line=function(){this.line&&(1===this.type?this.line.length>0&&this.lines.push(this.line):2===this.type?this.line.length>1&&this.lines.push(this.line):3===this.type&&this.line.length>3&&this.lines.push(this.line)),this.line=[]},n.prototype._moveTo=function(t,e,i){3!==this.type?i&&(t=(t-(this.xmin+this.margin))*this.finalRatio,e=(e-(this.ymin+this.margin))*this.finalRatio,this.line.push(new r(t,e))):(i||(t<this.xmin&&(t=this.xmin),t>this.xmax&&(t=this.xmax),e<this.ymin&&(e=this.ymin),e>this.ymax&&(e=this.ymax)),t=(t-(this.xmin+this.margin))*this.finalRatio,e=(e-(this.ymin+this.margin))*this.finalRatio,this.line.push(new r(t,e)),this._is_h=!1,this._is_v=!1)},n.prototype._lineTo=function(t,e,i){var n,o;if(3!==this.type)if(i){if(t=(t-(this.xmin+this.margin))*this.finalRatio,e=(e-(this.ymin+this.margin))*this.finalRatio,this.line.length>0&&(n=this.line[this.line.length-1],n.x===t&&n.y===e))return;this.line.push(new r(t,e))
}else this.line&&this.line.length>0&&this._push_line();else if(i||(t<this.xmin&&(t=this.xmin),t>this.xmax&&(t=this.xmax),e<this.ymin&&(e=this.ymin),e>this.ymax&&(e=this.ymax)),t=(t-(this.xmin+this.margin))*this.finalRatio,e=(e-(this.ymin+this.margin))*this.finalRatio,this.line&&this.line.length>0){n=this.line[this.line.length-1];var a=n.x===t,s=n.y===e;if(a&&s)return;this._is_h&&a?(n.x=t,n.y=e,o=this.line[this.line.length-2],this._is_h=o.x===t,this._is_v=o.y===e):this._is_v&&s?(n.x=t,n.y=e,o=this.line[this.line.length-2],this._is_h=o.x===t,this._is_v=o.y===e):(this.line.push(new r(t,e)),this._is_h=a,this._is_v=s)}else this.line.push(new r(t,e))}},{"point-geometry":137}],147:[function(t,e,i){function n(t,e,i,n,o){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=o,t.readFields(r,this,e)}function r(t,e,i){1==t?e._id=i.readVarint():2==t?o(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function o(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var n=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[n]=r}}var a=t("point-geometry"),s=t("./vectortileclipper");e.exports=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var t;if(this.dz){t=new s(this).loadGeometry()}else{for(var e=0,i=this.extent;i>4096;)e+=1,i>>=1;var n=this._pbf;n.pos=this._geometry;var r,o=n.readVarint()+n.pos,u=1,l=0,h=0,c=0;for(t=[];n.pos<o;){if(!l){var f=n.readVarint();u=7&f,l=f>>3}if(l--,1===u||2===u)h+=n.readSVarint(),c+=n.readSVarint(),1===u&&(r&&t.push(r),r=[]),r.push(new a(h>>e,c>>e));else{if(7!==u)throw new Error("unknown command "+u);r&&r.push(r[0].clone())}}r&&t.push(r)}return t},n.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,n=0,r=0,o=0,a=1/0,s=-1/0,u=1/0,l=-1/0;t.pos<e;){if(!n){var h=t.readVarint();i=7&h,n=h>>3}if(n--,1===i||2===i)r+=t.readSVarint(),o+=t.readSVarint(),a>r&&(a=r),r>s&&(s=r),u>o&&(u=o),o>l&&(l=o);else if(7!==i)throw new Error("unknown command "+i)}return[a,u,s,l]},n.prototype.toGeoJSON=function(t,e,i){for(var r=this.extent*Math.pow(2,i),o=this.extent*t,a=this.extent*e,s=this.loadGeometry(),u=n.types[this.type],l=0;l<s.length;l++)for(var h=s[l],c=0;c<h.length;c++){var f=h[c],d=180-360*(f.y+a)/r;h[c]=[360*(f.x+o)/r-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}return"Point"===u&&1===s.length?s=s[0][0]:"Point"===u?(s=s[0],u="MultiPoint"):"LineString"===u&&1===s.length?s=s[0]:"LineString"===u&&(u="MultiLineString"),{type:"Feature",geometry:{type:u,coordinates:s},properties:this.properties}}},{"./vectortileclipper":146,"point-geometry":137}],148:[function(t,e,i){function n(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(r,this,e),this.length=this._features.length}function r(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(o(i))}function o(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}var a=t("./vectortilefeature.js");e.exports=n,n.prototype.feature=function(t){if(0>t||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,e,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":147}],149:[function(t,e,i){var n=arguments[3],r=arguments[4],o=arguments[5],a=JSON.stringify;e.exports=function(t){for(var e,i=Object.keys(o),s=0,u=i.length;u>s;s++){var l=i[s],h=o[l].exports;if(h===t||h.default===t){e=l;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var c={},s=0,u=i.length;u>s;s++){var l=i[s];c[l]=l}r[e]=[Function(["require","module","exports"],"("+t+")(self)"),c]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),d={};d[e]=e,r[f]=[Function(["require"],"var f = require("+a(e)+");(f.default ? f.default : f)(self);"),d];var p="("+n+")({"+Object.keys(r).map(function(t){return a(t)+":["+r[t][0]+","+a(r[t][1])+"]"}).join(",")+"},{},["+a(f)+"])",m=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(m.createObjectURL(new Blob([p],{type:"text/javascript"})))}},{}]},{},[24])(24)}),L.MapboxGL=L.Layer.extend({options:{updateInterval:32},initialize:function(t){if(L.setOptions(this,t),!t.accessToken)throw new Error("You should provide a Mapbox GL access token as a token option.");mapboxgl.accessToken=t.accessToken;this._throttledUpdate=function(t,e,i){var n,r,o,a;return a=function(){n=!1,r&&(o.apply(i,r),r=!1)},o=function(){n?r=arguments:(t.apply(i,arguments),setTimeout(a,e),n=!0)}}(L.Util.bind(this._update,this),this.options.updateInterval)},onAdd:function(t){this._glContainer||this._initContainer(),t._panes.tilePane.appendChild(this._glContainer),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),t.options.zoomAnimation&&L.DomEvent.on(t._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(t){this._map.options.zoomAnimation&&L.DomEvent.off(this._map._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this),t.getPanes().tilePane.removeChild(this._glContainer),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd}},_initContainer:function(){var t=this._glContainer=L.DomUtil.create("div","leaflet-gl-layer"),e=this._map.getSize();t.style.width=e.x+"px",t.style.height=e.y+"px"},_initGL:function(){var t=this._map.getCenter(),e=L.extend({},this.options,{container:this._glContainer,interactive:!1,center:[t.lng,t.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new mapboxgl.Map(e),this._glMap.transform.latRange=null,this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas,L.DomUtil.addClass(this._glMap._actualCanvas,"leaflet-image-layer"),L.DomUtil.addClass(this._glMap._actualCanvas,"leaflet-zoom-animated")},_update:function(t){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var e=this._map.getSize(),i=this._glContainer,n=this._glMap,r=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(i,r);var o=this._map.getCenter(),a=n.transform;a.center=mapboxgl.LngLat.convert([o.lng,o.lat]),a.zoom=this._map.getZoom()-1,n.transform.width!==e.x||n.transform.height!==e.y?(i.style.width=e.x+"px",i.style.height=e.y+"px",null!==n._resize&&void 0!==n._resize?n._resize():n.resize()):null!==n._update&&void 0!==n._update?n._update():n.update()}},_pinchZoom:function(t){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),t.zoom,t.center);L.DomUtil.setTransform(this._glMap._actualCanvas,i.subtract(this._offset),e)},_zoomStart:function(t){this._zooming=!0},_zoomEnd:function(){var t=this._map.getZoomScale(this._map.getZoom()),e=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),this._map.getZoom(),this._map.getCenter());L.DomUtil.setTransform(this._glMap._actualCanvas,e.subtract(this._offset),t),this._zooming=!1},_transitionEnd:function(t){L.Util.requestAnimFrame(function(){var t=this._map.getZoom(),e=this._map.getCenter(),i=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());L.DomUtil.setTransform(this._glMap._actualCanvas,i,1),this._glMap.once("moveend",L.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:e,zoom:t-1})},this)}}),L.mapboxGL=function(t){return new L.MapboxGL(t)};var s=e.Layer.extend({statics:{URLPREFIX:"https://www.arcgis.com/sharing/rest/content/items/",URLSUFFIX:"/resources/styles/root.json",STYLES:{DarkGray:"57436c01bc754dbb87dfb636b6484022",Gray:"1e47168d181248e491541ffd5a91c0de",Hybrid:"af6063d6906c4eb589dfe03819610660",Navigation:"e19e9330bf08490ca8353d76b5e2e658",Streets:"a60a37a27cc140ddad15f919cd5a69f2",StreetsNight:"92c551c9f07b4147846aae273e822714",StreetsRelief:"78c0a9ab4fbf4198a8b951848aab19d8",Topographic:"86d5ed4b6dc741de9dad5f0fbe09ae95",Spring:"763884983d3544c0a418a97992881fce",Newspaper:"4f4843d99c34436f82920932317893ae",MidCentury:"267f44f08a844c7abee2b62b00600540",ModernAntique:"996d9e7a3aac4514bb692ce7a990f1c1",BlackAndWhite:"3161443179244702a5e0449010013b54"}},initialize:function(t){if(t={key:t},"string"!=typeof t.key||!s.STYLES[t.key])throw new Error('L.esri.Vector.Basemap: Invalid parameter. Use one of "DarkGray", "Gray", "Hybrid", "Navigation", "Streets", "StreetsNight", "StreetsRelief", "Topographic"');n(s.URLPREFIX+s.STYLES[t.key]+s.URLSUFFIX,this)},onAdd:function(t){this._map=t,i.Util.setEsriAttribution(t),t.attributionControl&&(i.Util._getAttributionData("https://static.arcgis.com/attribution/World_Street_Map",t),t.attributionControl.addAttribution('<span class="esri-dynamic-attribution">USGS, NOAA</span>')),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(t){if(t.off("moveend",i.Util._updateMapAttribution),t.removeLayer(this._mapboxGL),t.attributionControl){var e=document.getElementsByClassName("esri-dynamic-attribution")[0].outerHTML;t.attributionControl.removeAttribution(e)}},_asyncAdd:function(){var t=this._map;t.getContainer().style.background=this._mapboxGL.options.style.layers[0].paint["background-color"],t.on("moveend",i.Util._updateMapAttribution),this._mapboxGL.addTo(t,this)}}),u=e.Layer.extend({statics:{URLPREFIX:"https://www.arcgis.com/sharing/rest/content/items/"},initialize:function(t){if(t={id:t},"string"!=typeof t.id)throw new Error("L.esri.Vector.Layer: Invalid parameter. Use the id of an ArcGIS Online vector tile item");var o,a,s=u.URLPREFIX+t.id;i.request(s,{},function(t,u){t||(o=u.url,-1===o.indexOf("basemaps.arcgis.com")?(this._customTileset=!0,u.accessInformation&&(this._copyrightText=u.accessInformation),i.request(o,{},function(t,n){t||("/"!==n.defaultStyles.charAt(0)&&(n.defaultStyles="/"+n.defaultStyles),a=o+n.defaultStyles+"/root.json",i.request(a,{},function(t,i){t||(r(i,n,a),this._mapboxGL=e.mapboxGL({accessToken:"ezree",style:i}),this._ready=!0,this.fire("ready",{},!0))},this))},this)):n(s+"/resources/styles/root.json",this))},this)},onAdd:function(t){this._map=t,i.Util.setEsriAttribution(t),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(t){if(t.off("moveend",i.Util._updateMapAttribution),t.removeLayer(this._mapboxGL),t.attributionControl){var e=document.getElementsByClassName("esri-dynamic-attribution")[0].outerHTML;t.attributionControl.removeAttribution(e)}},_asyncAdd:function(){var t=this._map;t.attributionControl&&(this._customTileset?this._copyrightText&&t.attributionControl.addAttribution('<span class="esri-dynamic-attribution">'+this._copyrightText+"</span>"):(i.Util._getAttributionData("https://static.arcgis.com/attribution/World_Street_Map",t),t.attributionControl.addAttribution('<span class="esri-dynamic-attribution">USGS, NOAA</span>'),t.on("moveend",i.Util._updateMapAttribution))),t.getContainer().style.background=this._mapboxGL.options.style.layers[0].paint["background-color"],this._mapboxGL.addTo(t,this)}});t.VERSION="1.0.7",t.Basemap=s,t.basemap=o,t.Layer=u,t.layer=a});
//# sourceMappingURL=esri-leaflet-vector.js.map